<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">LEVERAGING GRAPHICAL MODEL TECHNIQUES TO STUDY EVOLUTION ON PHYLOGENETIC NETWORKS</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName coords="1,117.70,185.37,59.14,8.96"><forename type="first">Benjamin</forename><surname>Teo</surname></persName>
						</author>
						<author>
							<persName coords="1,267.26,185.37,53.32,8.96"><forename type="first">Paul</forename><surname>Bastide</surname></persName>
						</author>
						<author>
							<persName coords="1,431.07,185.37,45.65,8.96"><forename type="first">Cécile</forename><surname>Ané</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Department of Statistics</orgName>
								<orgName type="institution">University of Wisconsin-Madison</orgName>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="laboratory">IMAG</orgName>
								<orgName type="institution">Université de Montpellier</orgName>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="institution">CNRS</orgName>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff3">
								<orgName type="department">Departments of Statistics and of Botany</orgName>
								<orgName type="institution">University of Wisconsin-Madison</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">LEVERAGING GRAPHICAL MODEL TECHNIQUES TO STUDY EVOLUTION ON PHYLOGENETIC NETWORKS</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">F3E30A8247A82EEE4D86421A4444B50E</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.2" ident="GROBID" when="2024-05-19T14:44+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>belief propagation</term>
					<term>cluster graph</term>
					<term>admixture graph</term>
					<term>trait evolution</term>
					<term>Brownian motion</term>
					<term>linear Gaussian</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The evolution of molecular and phenotypic traits is commonly modelled using Markov processes along a rooted phylogeny. This phylogeny can be a tree, or a network if it includes reticulations, representing events such as hybridization or admixture. Computing the likelihood of data observed at the leaves is costly as the size and complexity of the phylogeny grows. Efficient algorithms exist for trees, but cannot be applied to networks. We show that a vast array of models for trait evolution along phylogenetic networks can be reformulated as graphical models, for which efficient belief propagation algorithms exist. We provide a brief review of belief propagation on general graphical models, then focus on linear Gaussian models for continuous traits. We show how belief propagation techniques can be applied for exact or approximate (but more scalable) likelihood and gradient calculations, and prove novel results for efficient parameter inference of some models. We highlight the possible fruitful interactions between graphical models and phylogenetic methods. For example, approximate likelihood approaches have the potential to greatly reduce computational costs for phylogenies with reticulations.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<facsimile>
		<surface n="1" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="2" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="3" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="4" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="5" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="6" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="7" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="8" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="9" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="10" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="11" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="12" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="13" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="14" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="15" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="16" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="17" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="18" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="19" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="20" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="21" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="22" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="23" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="24" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="25" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="26" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="27" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="28" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="29" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="30" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="31" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="32" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="33" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="34" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="35" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="36" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="37" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="38" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="39" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="40" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="41" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="42" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="43" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="44" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="45" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
	</facsimile>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>In phylogenetics, data are observed at the leaves of a phylogeny: a directed acyclic graph representing the historical relationships between species, populations or individuals of interest, with branch lengths representing evolutionary time and internal nodes representing divergence (e.g. speciation) or merging (e.g. introgression) events. Stochastic processes are used to model the evolution of traits over time along this phylogeny. In this work, we consider traits that may be multivariate, discrete and/or continuous, with a focus on continuous traits. Inference from these models are used to infer evolutionary dynamics and historical correlation between traits, predict unobserved traits at ancestral nodes or extant leaves, or estimate phylogenies from rich data sets.</p><p>Calculating the likelihood is no easy task because the traits at ancestral nodes are unobserved and need to be integrated out. This problem is very well studied for phylogenetic trees, with efficient solutions for both discrete and continuous traits. Admixture graphs and phylogenetic networks with reticulations are now gaining traction due to growing empirical evidence for gene flow, hybridization and admixture. Yet many methods and tools for these networks could be improved towards more efficient likelihood calculations.</p><p>The vast majority of evolutionary models used in phylogenetics make a Markov assumption, in that the trait distribution at all nodes (observed at the tips and unobserved at internal nodes) can be expressed by a set of local models. At the root, this model describes the prior distribution of the ancestral trait. For each node in the phylogeny, a local transition model describes the trait distribution at this node conditional on the trait(s) at its parent node(s). As each local model can be specified individually with its own set of parameters, the overall evolutionary model can be very flexible, including possible shifts in rates, constraints, and mode of evolution across different clades. Other models do not make a Markov assumption, such as models that combine a backwards-in-time coalescent process for gene trees and forward-in-time mutation process along gene trees. We show here that some of these models can still be expressed as a product of local conditional distributions, over a graph that is more complex than the initial phylogeny.</p><p>These evolutionary models are special cases of graphical models, also known as Bayesian networks, which have been heavily studied. The task of calculating the likelihood of the observed data has received a lot of attention, including algorithms for efficient approximations when the network is too complex to calculate the likelihood exactly. Another well-studied task is that of predicting the state of unobserved variables (ancestral states in phylogenetics) conditional on the observed data. We argue here that the field of phylogenetics could greatly benefit from applying and expanding knowledge from graphical models for the study and use of phylogenetic networks.</p><p>In section 2 we review the challenge brought by phylogenetic models in which only tip data are observed, and the techniques currently used for efficient likelihood calculations for phylogenetic models on trees and networks. In section 3 we focus on the general Gaussian models for the evolution of a continuous trait, possibly multivariate to capture evolutionary correlations between traits. On reticulate phylogenies, these models need to describe the trait of admixed populations conditional on their parental populations. Turning to graphical models in section 4, we describe their general formulation and show that many phylogenetic models can be expressed as special cases, from known examples (on gene trees) to less obvious examples (using the coalescent process on species trees, or species networks). We then provide a short review of belief propagation, a core technique to perform inference on graphical models, first in its general form and then specialized for continuous traits in linear Gaussian models. In section 5 we describe loopy belief propagation, a technique to perform approximation inference in graphical models, when exact inference does not scale. As far as we know, loopy belief propagation has never been used in phylogenetics. Section 6 describes leveraging BP for parameter inference: fast calculations of the likelihood and its gradient can be used in any likelihood-based framework, frequentist or Bayesian. Finally, section 7 discusses future challenges for the application and extension of graphical model techniques in phylogenetics. These techniques offer a range of avenues to expand the phylogeneticists' toolbox for fitting evolutionary models on phylogenetic networks, from approximate inference methods that are more scalable, to algorithms for fast gradient computation for better parameter inference.</p><p>The pruning algorithm, which is a form of BP, computes the the full likelihood of all the observed taxa by traversing the phylogenetic tree once, taking advantage of the Markov property: where the evolution of the trait of interest along a daughter lineage is independent of its past evolution, given knowledge of the parent's state. The idea is to traverse the tree and calculate the likelihood of the descendant leaves of an ancestral species conditional on its state, from similar likelihoods calculated for each of its children. If the trait is discrete with 4 states for example (as for DNA), then this entails keeping track of 4 likelihood values at each ancestral species. If the trait is continuous with a Gaussian distribution, e.g. from a Brownian motion (BM) or an Ornstein-Uhlenbeck (OU) process <ref type="bibr" coords="4,440.97,140.93,58.83,8.64" target="#b57">Hansen [1997]</ref>, then the likelihood at an ancestral species is a nice function of its state that can be concisely parametrized by quantities akin to the posterior mean and variance conditional on descendant leaves. Felsenstein's independent contrasts (IC) <ref type="bibr" coords="4,495.70,162.75,44.29,8.64;4,72.00,173.66,26.03,8.64" target="#b42">Felsenstein [1985]</ref> also captures these partial posterior quantities and can be viewed as a special implementation of BP for likelihood calculation.</p><p>BP is used ubiquitously for the analysis of discrete traits, such as for DNA substitution models (e.g. in RAxML <ref type="bibr" coords="4,497.15,200.96,42.85,8.64;4,72.00,211.87,25.40,8.64" target="#b125">Stamatakis [2014]</ref>, IQ-TREE <ref type="bibr" coords="4,144.11,211.87,83.44,8.64" target="#b100">Nguyen et al. [2015]</ref>, MrBayes <ref type="bibr" coords="4,274.27,211.87,138.64,8.64" target="#b114">Ronquist and Huelsenbeck [2003]</ref>) or for discrete morphological traits in comparative methods (e.g. in phytools <ref type="bibr" coords="4,266.58,222.77,52.60,8.64" target="#b112">Revell [2012]</ref>, BayesTraits <ref type="bibr" coords="4,385.83,222.77,70.75,8.64" target="#b103">Pagel et al. [2004]</ref>, corHMM <ref type="bibr" coords="4,497.07,222.77,42.93,8.64;4,72.00,233.68,63.84,8.64" target="#b25">Boyko and Beaulieu [2021]</ref>, <ref type="bibr" coords="4,142.55,233.68,76.80,8.64" target="#b26">Boyko et al. [2023]</ref>, RevBayes <ref type="bibr" coords="4,270.40,233.68,76.34,8.64" target="#b67">Höhna et al. [2016]</ref>). For discrete traits, there is simply no feasible alternative. On a tree with 20 taxa and 19 ancestral species, the naive calculation of the likelihood at a given DNA site would require the calculation and summation of 4 19 or 274 billion likelihoods, one for each nucleotide assignment at the 19 ancestral species. This calculation would need to be repeated for each site in the alignment, then repeated all over during the search for a well-fitting phylogenetic tree.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Continuous traits on trees: the lazy way</head><p>For continuous traits under a Gaussian model (including the Brownian motion), BP is not used as ubiquitously because a multivariate Gaussian distribution can be nicely captured by its mean and covariance matrix: the multivariate Gaussian formula can serve as an alternative. For example, for one trait Y with ancestral state µ at the root of the phylogeny, the phylogenetic covariance Σ between the taxa at the leaves can be obtained from the branch lengths in the tree. Under a BM, the covariance cov(Y i , Y j ) between taxa i and j is Σ ij = σ 2 t ij where t ij is the length between the root and their most recent common ancestor. The likelihood of the observed traits at the n leaves can then be calculated using matrix and vector multiplication techniques as</p><formula xml:id="formula_0" coords="4,188.76,431.67,351.91,22.31">(2π) −n/2 det |Σ| −1/2 exp − 1 2 (Y − µ) ⊤ Σ −1 (Y − µ) .<label>(1)</label></formula><p>This alternative to BP has the disadvantage of requiring the inversion of the covariance matrix Σ, a task whose computing time typically grows as m 3 for a matrix of size m × m. It also has the disadvantage that Σ needs to be calculated and stored in memory in the first place. For multivariate observations of p traits on each of n taxa, the covariance matrix has size m = pn so the typical calculation cost of (1) is then O(p 3 n 3 ), which can quickly become very large. For example, with only 30 taxa and 10 traits, Σ is a 300 × 300-matrix. Studies with large p and/or large n are now frequent, especially from geometric morphometric data with p over 100 typically (e.g. <ref type="bibr" coords="4,446.07,528.01,59.20,8.64" target="#b63">Hedrick [2023]</ref>) or with expression data on p &gt; 1000 genes easily, that also require more complex models to account for variation (e.g. within species, between organs, between batches) <ref type="bibr" coords="4,241.30,549.83,70.26,8.64" target="#b38">Dunn et al. [2013]</ref>, <ref type="bibr" coords="4,318.14,549.83,52.48,8.64">Shafer [2019]</ref>. Studies with a large number n of taxa are now frequent (e.g. n &gt; 5, 000 in birds and mammals <ref type="bibr" coords="4,282.46,560.74,63.86,8.64" target="#b71">Jetz et al. [2012]</ref>, <ref type="bibr" coords="4,352.89,560.74,78.19,8.64" target="#b136">Upham et al. [2019]</ref>) and virus phylogenies can be massive (e.g. n &gt; 1000 and p = 3 virulence traits in <ref type="bibr" coords="4,302.56,571.65,106.54,8.64">HIV Hassler et al. [2022a]</ref>, or n &gt; 500, 000 SARS-CoV-2 strains De <ref type="bibr" coords="4,114.61,582.56,69.66,8.64" target="#b35">Maio et al. [2023]</ref>).</p><p>In these cases with large data size np, the matrix-based alternative to BP is prone to numerical inaccuracy and numerical instability in addition to the increased computational time, because it is hard to accurately invert a large matrix. Even when the matrix is of moderate size, numerical inaccuracy can arise when the matrix is "ill-conditioned". These problems were identified under OU models on phylogenetic trees that have closely-related sister taxa, or under earlyburst (EB) models with strong morphological diversification early on during the group radiation, and much slowed-down evolution later on <ref type="bibr" coords="4,144.33,653.49,104.87,8.64" target="#b0">Adams and Collyer [2017]</ref>, <ref type="bibr" coords="4,255.84,653.49,118.13,8.64" target="#b72">Jhwueng and O'Meara [2020]</ref>, <ref type="bibr" coords="4,380.61,653.49,89.09,8.64" target="#b12">Bartoszek et al. [2023]</ref>.</p><p>For some simple models, the large np × np covariance matrix can be decomposed as a Kronecker product of a p × p trait covariance and a n × n phylogenetic covariance. This decomposition can simplify the complexity of calculating the likelihood. However, this decomposition is not available under many models, such as the multivariate Brownian motion with shifts in the evolutionary rates (e.g. <ref type="bibr" coords="4,265.60,702.61,112.26,8.64" target="#b28">Caetano and Harmon [2019]</ref>) or the multivariate Ornstein-Uhlenbeck model with non-scalar rate or selection matrices <ref type="bibr" coords="4,265.95,713.51,89.09,8.64" target="#b10">Bartoszek et al. [2012]</ref>, <ref type="bibr" coords="4,361.68,713.51,74.91,8.64" target="#b32">Clavel et al. [2015]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">BP for continuous traits on trees</head><p>To bypass the complexity of matrix inversion, Felsenstein pioneered IC to test for phylogenetic correlation between traits, assuming a BM model on a tree <ref type="bibr" coords="5,225.76,107.73,72.03,8.64" target="#b42">Felsenstein [1985]</ref>. Many authors then used BP approaches to handle Gaussian models beyond the BM FitzJohn <ref type="bibr" coords="5,207.09,118.64,25.40,8.64">[2012]</ref>, <ref type="bibr" coords="5,239.27,118.64,71.40,8.64" target="#b48">Freckleton [2012]</ref>, <ref type="bibr" coords="5,317.46,118.64,73.97,8.64" target="#b34">Cybis et al. [2015]</ref>, <ref type="bibr" coords="5,398.21,118.64,84.69,8.64" target="#b51">Goolsby et al. [2017]</ref>. Notably, <ref type="bibr" coords="5,527.58,118.64,12.42,8.64;5,72.00,129.55,64.49,8.64" target="#b65">Ho and Ané [2014]</ref> describe a fast algorithm that can be used for non-Gaussian models as well. Most recently, <ref type="bibr" coords="5,515.55,129.55,24.70,8.64;5,72.00,140.46,49.71,8.64" target="#b96">Mitov et al. [2020]</ref> highlighted that BP can be applied to a large class of Gaussian models: including the BM and the OU process with shifts and variation of rates and selection regimes across branches. Software packages that use these fast BP algorithms include phylolm <ref type="bibr" coords="5,203.05,162.27,75.80,8.64" target="#b65">Ho and Ané [2014]</ref>, Rphylopars <ref type="bibr" coords="5,340.30,162.27,83.31,8.64" target="#b51">Goolsby et al. [2017]</ref>, <ref type="bibr" coords="5,430.28,162.27,109.72,8.70">BEAST Hassler et al. [2023]</ref> or the most recent versions of hOUwie <ref type="bibr" coords="5,226.36,173.18,77.28,8.64" target="#b26">Boyko et al. [2023]</ref> and mvSLOUCH <ref type="bibr" coords="5,367.34,173.18,89.09,8.64" target="#b12">Bartoszek et al. [2023]</ref>.</p><p>All the methods cited above only use the first post-order tree traversal of BP to compute the likelihood. A second preorder traversal allows, in the Gaussian case, for the computation of the distribution of all internal nodes conditionally on the model and on the traits values at the tips. These distributions can then be used for, e.g., ancestral state reconstruction <ref type="bibr" coords="5,72.00,222.30,60.23,8.64" target="#b83">Lartillot [2014]</ref>, expectation-maximization algorithms for shift detection in the optimal values of an OU <ref type="bibr" coords="5,489.85,222.30,51.90,8.64;5,72.00,233.21,29.88,8.64" target="#b14">Bastide et al. [2018a]</ref>, or the computation of the gradient of the likelihood in the BM <ref type="bibr" coords="5,366.72,233.21,77.00,8.64" target="#b144">Zhang et al. [2021]</ref>, <ref type="bibr" coords="5,450.76,233.21,78.13,8.64" target="#b44">Fisher et al. [2021]</ref> or general Gaussian model <ref type="bibr" coords="5,173.24,244.12,81.78,8.64" target="#b16">Bastide et al. [2021]</ref>. Such BP techniques have also been used for taking gradients of the likelihood with respect to branch lengths in sequence evolution models <ref type="bibr" coords="5,349.11,255.03,55.75,8.64" target="#b73">Ji et al. [2020]</ref> or for phylogenetic factor analysis <ref type="bibr" coords="5,71.69,265.94,78.54,8.64" target="#b135">Tolkoff et al. [2018]</ref>, <ref type="bibr" coords="5,156.87,265.94,84.00,8.64" target="#b61">Hassler et al. [2022b]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">From trees to networks</head><p>So far, Felsenstein's pruning algorithm and related BP approaches have been restricted to phylogenetic trees, mostly.</p><p>There is now ample evidence that reticulation is ubiquitous in all domains of life from biological processes such as lateral gene transfer, hybridization, introgression and gene flow between populations. Networks are recognized to be better than trees for representing the phylogenetic history of species and populations in many groups. Although current studies using networks have few taxa, typically between 10-20 (e.g. <ref type="bibr" coords="5,380.03,358.79,80.33,8.64" target="#b101">Nielsen et al. [2023]</ref>), they tend to have increasingly more tips as network inference methods become more scalable (e.g. n = 39 languages in <ref type="bibr" coords="5,482.06,369.70,59.68,8.64;5,72.00,380.61,23.84,8.64">Neureiter et al. [2022]</ref>). As viruses are known to be affected by recombination, we also expect future virus studies to use large network phylogenies <ref type="bibr" coords="5,122.05,391.52,84.95,8.64" target="#b70">Ignatieva et al. [2022]</ref>, so that BP will become essential for network studies too. In this work, we describe approaches currently used for trait evolution on phylogenetic networks. We argue that the field of evolutionary biology would benefit from applying BP approaches on networks more systematically. Transferring knowledge from the mature and rich literature on BP would advance evolutionary biology research when phylogenetic networks are used.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Current network approaches for discrete traits</head><p>For discrete traits on general networks, very few approaches use BP techniques as far as we know. For DNA data for example, PhyLiNC Allen-Savietta [2020] and NetRAX <ref type="bibr" coords="5,291.69,484.37,91.63,8.64" target="#b89">Lutteropp et al. [2022]</ref> extend the typical tree-based model to general networks, assuming no incomplete lineage sorting. That is, each site is assumed to evolve along one of the trees displayed in the network, chosen according to inheritance probabilities at reticulate edges. PhyLiNC assumes independent (unlinked) sites. NetRAX assumes independent loci, which may have a single site each. Each locus may have its own set of branch lengths and substitution model parameters. Both methods calculate the likelihood of a network N via extracting its displayed trees and then applying BP on each tree. Similarly, comparative methods for binary and multi-state traits implemented in PhyloNetworks also extract displayed trees and then apply BP on each displayed tree <ref type="bibr" coords="5,89.74,560.74,78.94,8.64" target="#b78">Karimi et al. [2020]</ref>. While these approaches use BP on each displayed tree, a network with h reticulations can have up to 2 h displayed trees. This leads to a computational bottleneck when the number of reticulations increases.</p><p>BP approaches have also been used for models with incomplete lineage sorting, modelled by the coalescent <ref type="bibr" coords="5,502.88,588.04,37.12,8.64;5,72.00,598.94,25.40,8.64" target="#b79">Kingman [1982]</ref>. Notably, SNAPP models the evolution of unlinked biallelic markers along a species tree, accounting for incomplete lineage sorting <ref type="bibr" coords="5,177.67,609.85,74.48,8.64" target="#b27">Bryant et al. [2012]</ref>. This method was recently made faster with <ref type="bibr" coords="5,428.75,609.85,111.25,8.70">SNAPPER Stoltz et al. [2020]</ref> and extended to phylogenetic networks with SnappNet Rabier et al. <ref type="bibr" coords="5,352.27,620.76,25.40,8.64">[2021]</ref>. The coalescent process introduces the challenge that each site may evolve along any tree, depending on past coalescent events. SNAPP introduced a way to bypass the difficulties of handling coalescent histories and hence decrease computation time. After we describe BP for general graphical models, we recast this innovation as BP on a graphical model formulation of the problem.</p><p>BP was also used to calculate the likelihood of the joint sample frequency spectrum (SFS). To account for incomplete lineage sorting on a tree, <ref type="bibr" coords="5,170.19,680.79,76.14,8.64" target="#b76">Kamm et al. [2017]</ref> use the continuous-time Moran model to reduce computational complexity, and assume that each site undergoes at most one mutation. In momi2, <ref type="bibr" coords="5,362.19,691.70,81.11,8.64" target="#b77">Kamm et al. [2020]</ref> extend the approach to phylogenetic networks by assuming a pulse of admixture at reticulations. The associated graphical model is much simpler than that required by SNAPP or SnappNet thanks to the assumption of no recurrent mutation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.6">Current network approaches for continuous traits</head><p>Compared to the rich toolkit available for the analysis of continuous traits on trees, the toolkit for phylogenetic networks is still limited. PhyloNetworks includes comparative methods on networks Solís-Lemus et al. <ref type="bibr" coords="6,447.63,107.04,24.50,8.64">[2017]</ref>, implemented in Julia <ref type="bibr" coords="6,100.28,117.95,86.06,8.64" target="#b19">Bezanson et al. [2017]</ref>. These methods extend phylogenetic ANOVA to networks, for a continuous response trait predicted by any number of continuous or categorical traits, with residual variation being phylogenetically correlated. So far, the models available in PhyloNetworks include the BM, Pagel's λ, possible within-species variation, and shifts at reticulations to model transgressive evolution <ref type="bibr" coords="6,263.99,150.67,83.65,8.64" target="#b15">Bastide et al. [2018b]</ref>, <ref type="bibr" coords="6,354.37,150.67,63.77,8.64" target="#b132">Teo et al. [2023]</ref>. However, all calculations are based on working with the full covariance matrix, without BP. <ref type="bibr" coords="6,325.70,161.58,155.29,8.70">TreeMix Pickrell and Pritchard [2012]</ref>, ADMIXTOOLS <ref type="bibr" coords="6,72.00,172.49,90.15,8.64" target="#b104">Patterson et al. [2012]</ref>, <ref type="bibr" coords="6,169.68,172.49,76.74,8.64">Maier et al. [2023]</ref>, poolfstat <ref type="bibr" coords="6,304.50,172.49,84.65,8.64" target="#b50">Gautier et al. [2022]</ref> and AdmixtureBayes Nielsen et al.</p><p>[2023] use allele frequency as a continuous trait. They model its evolution along a network, or admixture graph, using a Gaussian model in which the evolutionary rate variance is affected by the ancestral allele frequency <ref type="bibr" coords="6,490.85,194.31,49.14,8.64;6,71.53,205.22,48.93,8.64" target="#b124">Soraggi and Wiuf [2019]</ref>, <ref type="bibr" coords="6,127.76,205.22,56.68,8.64" target="#b87">Lipson [2020]</ref>. Again, these methods work with the phylogenetic covariance matrix, rather than BP approaches. They also consider subsets of up to 4 taxa at a time via f 2 , f 3 and f 4 statistics, which simplifies the likelihood calculation. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Continuous trait evolution on a phylogenetic network</head><p>We now present phylogenetic models for the evolution of continuous traits, to which we apply BP later. We generalize the framework in <ref type="bibr" coords="6,141.29,313.97,73.58,8.64" target="#b96">Mitov et al. [2020]</ref> and <ref type="bibr" coords="6,233.83,313.97,79.14,8.64" target="#b16">Bastide et al. [2021]</ref> from trees to networks, and we extend the network model in <ref type="bibr" coords="6,82.09,324.88,84.23,8.64" target="#b15">Bastide et al. [2018b]</ref> from the BM to more general evolutionary models. We consider a multivariate X consisting of p continuous traits, and model their correlation over time. Our model ignores the potential effects of incomplete lineage sorting on X, a reasonable assumption for highly polygenic traits.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Linear Gaussian models</head><p>Most random processes used to model continuous trait evolution on a phylogenetic tree are extensions of the BM to capture processes such as evolutionary trends, adaptation, and variation in rates across lineages for example. In its most general form, the linear Gaussian evolutionary model on a tree (referred to as the GLInv family in <ref type="bibr" coords="6,462.52,415.32,73.90,8.64" target="#b96">Mitov et al. [2020]</ref>) assumes that the trait X v at node v has the following distribution conditional on its parent pa(v)</p><formula xml:id="formula_1" coords="6,227.85,445.26,312.81,9.99">X v | X pa(v) ∼ N (q v X pa(v) + ω v , V v )<label>(2)</label></formula><p>where the actualization matrix q v , the trend vector ω v and the covariance matrix V v are appropriately sized and do not depend on trait values X pa(v) . When the tree is replaced by a network, a node v can have multiple parents pa(v).</p><p>In this case, we can write X pa(v) as the vector formed by stacking the elements of {X u | u ∈ pa(v)} vertically, with length equal to the number of traits times the number of parents of v. In the following, we show that (2), already used on trees, can easily be extended to networks, to describe both evolutionary models along one lineage and a merging rule at reticulation events.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Evolutionary models along one lineage</head><p>For a tree node v with parent node u, we need to describe the evolutionary process along one lineage, graphically modelled by the tree edge e = (u, v). It is well known that a wide range of evolutionary models can fit in the general form (2) <ref type="bibr" coords="6,108.21,589.26,74.28,8.64" target="#b96">Mitov et al. [2020]</ref>, <ref type="bibr" coords="6,189.18,589.26,80.03,8.64" target="#b16">Bastide et al. [2021]</ref>. For instance, the BM with variance rate Σ (a variance-covariance matrix for a multivariate trait) is described by (2) where q v is the p × p identity matrix I p , there is no trend ω v = 0, and the variance is proportional to the edge length ℓ(e):</p><formula xml:id="formula_2" coords="6,296.41,610.72,52.07,9.68">V v = ℓ(e)Σ.</formula><p>Allowing for rate variation amounts to letting the variance rate vary across edges Σ = Σ(e). For example, the Early Burst (EB) model assumes that the variance rate at any given point in the phylogeny depends on the time t from the root to that point, as:</p><formula xml:id="formula_3" coords="6,275.14,661.25,61.73,11.72">Σ(t) = Σ 0 e bt .</formula><p>For this t to be well-defined on a reticulate network, the network needs to be time-consistent (distinct paths from the root to a node all share the same length). The rate b is a rate of variance decay if it is negative, to expected during adaptive radiations, with a burst of variation near the root (hence Early Burst) before a slow-down of trait evolution <ref type="bibr" coords="6,72.00,713.51,83.25,8.64" target="#b58">Harmon et al. [2010]</ref>. When b &gt; 0, this model is called "accelerating rate" (AC) <ref type="bibr" coords="6,398.99,713.51,90.41,8.64" target="#b22">Blomberg et al. [2003]</ref>. <ref type="bibr" coords="6,496.73,713.51,43.27,8.64;7,72.00,75.48,58.26,8.64" target="#b31">Clavel and Morlon [2017]</ref> used a flexible extension of this model (on a tree), replacing t by one or more covariates that are known functions of time, such as the average global temperature and other environmental variables:</p><formula xml:id="formula_4" coords="7,242.67,102.70,126.66,9.68">Σ(t) = σ(t, T 1 (t), • • • , T k (t)) .</formula><p>Then, the variance accumulated along edge e = (u, v) is given by</p><formula xml:id="formula_5" coords="7,263.85,135.90,84.30,26.29">V v = t(v) t(u) Σ(t)dt .</formula><p>In the particular case of the EB model, we get u) (e bℓ(e) − 1)/b .</p><formula xml:id="formula_6" coords="7,244.28,185.49,54.28,11.72">V v = Σ 0 e bt(</formula><p>Allowing for shifts in the trait value, perhaps due to jumps or cladogenesis, amounts to including ω v ̸ = 0 for some v.</p><p>Adaptive evolution is typically modelled by the OU process, which includes a parameter A e for the strength of selection along edge e. This selection strength is often assumed constant across edges, and is typically denoted as α for a univariate trait. The OU process also includes a primary optimum value θ e , which may vary across edges when we are interested in detecting shifts in the adaptive regime across the phylogeny. Under the OU model, the trait evolves along edge e with random drift and a tendency towards θ e :</p><formula xml:id="formula_7" coords="7,215.71,285.90,180.58,11.72">dX (e) (t) = A e (θ e − X (e) (t))dt + R e dB(t)</formula><p>where B is a standard BM and the drift variance is Σ e = R e R ⊤ e . Then, conditional on the starting value at the start of e, the end value X v is linear Gaussian as in (2) with actualization q v = e −ℓ(e)Ae , trend ω v = (I − e −ℓ(e)Ae )θ e and variance where S e is the stationary variance matrix. These equations simplify greatly if A e and Σ e commute, such as if A e is scalar of the form α e I p , including when the process is univariate. In this case, e) )Σ e /(2α) .</p><formula xml:id="formula_8" coords="7,181.74,337.29,48.07,18.71">V v = ℓ(e)</formula><formula xml:id="formula_9" coords="7,243.68,394.28,70.95,11.72">V v = (1 − e −2αℓ(</formula><p>Shifts in adaptive regimes can be modelled by shifts in any of the parameters θ e , A e or Σ e across edges.</p><p>Finally, variation within species, including measurement error, can be easily modelled by grafting one or more edges at each species node, to model the fact that the measurement taken from an individual may differ from the true species mean. The model for within-species variation, then, should also follow (2) by which an individual value is assumed to be normally distributed with a mean that depends linearly on the species mean, and a variance independent of the species mean -although this variance can vary across species. Most typically, observations from species v are modelled using q = I p , ω = 0 and some phenotypic variance to be estimated, that may or may not be tied to the evolutionary variance parameter from the phylogenetic model across species. This additional observation layer can also be used for factor analysis, where the unobserved latent trait evolving on the network has smaller dimension than the observed trait.</p><p>In that case, q is a rectangular, representing the loading matrix <ref type="bibr" coords="7,323.34,516.99,78.54,8.64" target="#b135">Tolkoff et al. [2018]</ref>, <ref type="bibr" coords="7,408.52,516.99,84.01,8.64" target="#b61">Hassler et al. [2022b]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Evolutionary models at reticulations</head><p>For a continuous trait and a hybrid node h, <ref type="bibr" coords="7,242.87,561.21,84.79,8.64" target="#b15">Bastide et al. [2018b]</ref> and <ref type="bibr" coords="7,346.86,561.21,114.56,8.64" target="#b105">Pickrell and Pritchard [2012]</ref> assumed that X h is a weighted average of its immediate parents, using their state immediately before the reticulation event. Specifically, if h has parent edges e 1 , . . . , e m , and if we denote by X e k the state at the end of edge e k right before the reticulation event (1 ≤ k ≤ m), then the weighted-average model assumes that</p><formula xml:id="formula_10" coords="7,248.48,614.23,288.32,20.81">X h = e k parent of h γ(e k )X e k . (<label>3</label></formula><formula xml:id="formula_11" coords="7,536.80,614.55,3.87,8.64">)</formula><p>This model is a reasonable null model for polygenic traits, reflecting the typical observation that hybrid species show intermediate phenotypes. In this model, the biological process underlying the reticulation event (such as gene flow versus hybrid speciation) does not need to be known. Only the proportion of the genome inherited by each parent, γ(e k ), needs to be known. Compared to the evolutionary time scale of the phylogeny, the reticulation event is assumed to be instantaneous.</p><p>To describe this process as a graphical model, we may add a degree-2 node at the end of each hybrid edge e to store the value X e , so as to separate the description of the evolutionary process along each edge from the description of the process at a reticulation event. With these extra degree-2 nodes, the weighted-average model (3) corresponds to the linear Gaussian model (2) with no trend ω h = 0, no variance V h = 0, and with actualization q h = [γ(e 1 )I p . . . γ(e m )I p ] made of scalar diagonal blocks.</p><p>Several extensions of this hybrid model can be considered. <ref type="bibr" coords="8,304.85,113.68,84.30,8.64" target="#b15">Bastide et al. [2018b]</ref> modelled transgressive evolution with a shift ω h ̸ = 0, for the hybrid population to differ from the weighted average of its immediate parents, even possibly taking a value outside their range. <ref type="bibr" coords="8,208.45,135.50,118.47,8.64" target="#b72">Jhwueng and O'Meara [2015]</ref> considered transgressive shifts at each hybrid node as random variables with a common variance, corresponding to a model with ω h = 0 but non-zero variance V h .</p><p>More generally, we may consider models in which the hybrid value is any linear combination of its immediate parents q v X pa(v) as in (2). A biologically relevant model could consider q v to be diagonal, with, on the diagonal, parental weights γ(e, j) that may depend on the trait j instead of being shared across all p traits.</p><p>We may also consider both a fixed transgressive shift ω h ̸ = 0 and an additional hybrid variance V h . For both of these components to be identifiable in the typical case when we observe a unique realization of the trait evolution, the model would need extra assumptions to induce sparsity. For example, we may assume that V h is shared across all reticulations and is given an informative prior, to capture small variations around the parental weighted average. We may also need a sparse model on the set of ω h parameters, e.g. letting ω h ̸ = 0 only at a few candidate reticulations h, chosen based on external domain knowledge.</p><p>For a continuous trait known to be controlled by a single gene, we may prefer a model similar to the discrete trait model presented later in Example 2, by which X h takes the value of one of its immediate parent X e with probability γ(e). This model would no longer be linear Gaussian, unless we condition on which parent is being inherited at each reticulation. Such conditioning would reduce the phylogeny to one of its displayed tree. But it would require other techniques to integrate over all parental assignments to each hybrid population, such as Markov Chain Monte Carlo or Expectation Maximization.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Evolutionary models with interacting populations</head><p>Models have been proposed in which the evolution of X (e) (t) along one edge e depends on the state on other edges existing at the same time t <ref type="bibr" coords="8,181.84,382.24,74.63,8.64" target="#b36">Drury et al. [2016]</ref>, <ref type="bibr" coords="8,263.29,382.24,87.61,8.64" target="#b93">Manceau et al. [2017]</ref>, <ref type="bibr" coords="8,357.72,382.24,91.00,8.64" target="#b11">Bartoszek et al. [2017]</ref>, <ref type="bibr" coords="8,455.54,382.24,81.97,8.64" target="#b37">Duchen et al. [2020]</ref>. These models can describe "phenotype matching" that may arise from ecological interactions (mutualism, competition) or demographic interactions (migration), in which traits across species converge to or diverge from one another. To express this coevolution, we consider the set E(t) of edges contemporary to one another at time t and divide the phylogeny into epochs: time intervals [τ i , τ i+1 ] during which the set E(t) of interacting lineages is constant, denoted as E i . Within each epoch i (i.e t ∈ [τ i , τ i+1 ]), the vector of all traits (X (e) (t)) e∈Ei is modelled by a linear stochastic differential equation. Since its mean is linear in and its variance independent of the starting value (X (e) (τ i )) e∈Ei , these models are linear Gaussian <ref type="bibr" coords="8,183.58,461.45,86.91,8.64" target="#b93">Manceau et al. [2017]</ref>, <ref type="bibr" coords="8,277.18,461.45,90.28,8.64" target="#b11">Bartoszek et al. [2017]</ref>. In fact, they can be expressed by (2) on a supergraph of the original phylogeny, in which an edge (u, v) is added if u is at the start τ i of some epoch i, v is at the end τ i+1 , and if the mean of X v conditional on all traits at time τ i has a non-zero coefficient for X u . The specific form of q v , ω v and V v in (2) depend on the specific interaction model, and may be more complex than the merging rule (3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">A short review of graphical models and belief propagation</head><p>Implementing BP techniques on general networks is more complex than on trees. To explain why, we review here the main ideas of graphical models and belief propagation for likelihood calculation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Graphical models</head><p>A probabilistic graphical model is a graph representation of a probability distribution. Each node in the graph represents a random variable, typically univariate but possibly multivariate. We focus here on graphical models with directed edges. Edges represent dependencies between variables, where the direction is typically used to represent causation. The graph expresses conditional independencies satisfied by the joint distribution of all the variables at all nodes in the graph. Given the directional nature of evolution and inheritance, models for trait evolution on a phylogeny are often readily formulated as directed graphical models. <ref type="bibr" coords="8,299.38,653.49,80.45,8.64" target="#b66">Höhna et al. [2014]</ref> demonstrate the utility of representing phylogenetic models as graphical models for exposing assumptions, and for interpretation and implementation. They present a range of examples common in evolutionary biology, with a focus on how graphical models facilitate greater modularity and transparency. Here we focus on the computational gains that BP allows on graphical models.</p><p>A directed graphical model consists of a directed acyclic graph (DAG) G and a set of conditional distributions, one for each node in G. At a node v with parent nodes pa(v), the distribution of variable X v conditional on its set of parent variables X pa(v) = {X u ; u ∈ pa(v)} is given by a factor ϕ v , which is a function whose scope is the set of variables from v and pa(v). For each node v, the set formed by this node and its parents {v} ∪ pa(v) is called a node family. If V denotes the vertex set of G, then the set of factors {ϕ v , v ∈ V } defines the joint density of the graphical model as</p><formula xml:id="formula_12" coords="9,209.09,119.56,331.58,20.06">p θ (X v ; v ∈ V ) = v∈V ϕ v (X v |X u , θ; u ∈ pa(v))<label>(4)</label></formula><p>where we add the possible dependence of factors on model parameters θ. This factor formulation implies that, conditional on its parents, X v is independent of any non-descendant node (e.g. "grandparents") <ref type="bibr" coords="9,456.81,159.67,83.19,8.64;9,72.00,170.58,24.90,8.64" target="#b81">Koller and Friedman [2009]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Phylogenetic examples of graphical models</head><p>Example 1 (BM on a tree). First consider the phylogenetic tree T in Fig. <ref type="figure" coords="9,367.27,215.89,7.93,8.64" target="#fig_2">1a</ref>. The graphical model for the node states of T under a BM, whose parameters θ are the trait evolutionary variance rate σ 2 , the ancestral state at the root x ρ and edge lengths ℓ i , has the same topology as T . On a tree, each node family consists of a node v and its single parent, or the root ρ by itself. The distribution ϕ ρ may be deterministic as when x ρ is a fixed parameter of the model, or may be given a prior distribution ϕ ρ .  Example 2 (Discrete trait on a network). For a second example, we will consider a reticulate phylogeny. A rooted phylogenetic network is a DAG with a single root, and taxon-labelled leaves (or tips). A node with at most one parent is called a tree node and its incoming edge is a tree edge. A node with multiple parents is called a hybrid node, and represents a population (or species more generally) with mixed ancestry. An edge e = (u, h) going into a hybrid node h is called a hybrid edge. It is assigned an inheritance probability γ(e) &gt; 0 that represents the proportion of the genome in h that was inherited from the parent population u (via edge e). Obviously, at each hybrid node h we must have u∈pa(h) γ((u, h)) = 1. The phylogenetic network N in Fig. <ref type="figure" coords="9,318.76,518.46,9.22,8.64" target="#fig_3">2a</ref> has one hybrid node x 5 whose genetic makeup comes from x 4 with proportion 0.4 and from x 6 with proportion 0.6. N displays two trees, depending on which hybrid edge is retained. One tree, with sister taxa 1 and 2, has probability 0.4. The other tree, with sister taxa 2 and 3, is displayed with probability 0.6. The distribution of the hybrid node x 5 depends on both its parents, and induces a factor cluster {x 4 , x 5 , x 6 } of size 3 in U and U * . (b) Clique tree U for the graphical model. (c) Cluster graph U * (leaf clusters not shown) for the same graphical model in which {x 4 , x 6 , x ρ } in U is replaced by smaller clusters {x 4 , x ρ }, {x 6 , x ρ } and {x ρ } that induce a cycle.</p><formula xml:id="formula_13" coords="9,88.26,290.46,212.43,77.59">T = G (a) xρ x5 x6 x1 x2 x3 x4 U (b)</formula><formula xml:id="formula_14" coords="9,82.80,559.09,442.25,74.38">N = G (a) xρ x4 x5 x6 x1 x2 x3 U (b) x4, x6, xρ x5, x4, x6 x1, x4 x2, x5 x3, x6 U * (c) xρ x4, xρ x6, xρ x5, x4, x6 γ = 0.4 γ = 0.6 x4 x5 x6 x4, x6<label>x4</label></formula><p>For a discrete trait X, the traditional model of evolution on a tree can be extended to a network N as follows. Along each edge e, X evolves according to a Markov process with some transition rate matrix Q for an amount of time ℓ(e) that depends on the edge. At a tree node, the state of X at the end of its parent edge is passed as the starting value to each daughter lineage, as in the traditional tree model. At reticulations, we follow previous authors to model the value x h at a hybrid node h <ref type="bibr" coords="10,159.56,119.11,76.35,8.64" target="#b78">Karimi et al. [2020]</ref>, Allen-Savietta [2020], <ref type="bibr" coords="10,332.48,119.11,87.23,8.64" target="#b89">Lutteropp et al. [2022]</ref>. Let x e denote the state at the end of edge e. If h has m parent edges e 1 , • • • , e m , then x h is assumed to take value x e k with probability γ(e k ). This model reflects the idea that the trait is controlled by unknown genes, but the proportion of genes inherited from each parent is known. Incomplete lineage sorting, which can lead to hemiplasy for a trait <ref type="bibr" coords="10,416.33,152.97,109.97,8.64" target="#b7">Avise and Robinson [2008]</ref>, is unaccounted for. Similar to Example 1, the graphical model uses the topology of the network N .</p><p>To describe the factors of this graphical model and simplify notations, consider the case when X is binary with states 0 and 1. For a tree node v, the factor ϕ v can be represented by the 2 × 2 matrix exp(ℓ(e)Q), where e is the parent edge of v. For a hybrid node h with m parents p 1 , • • • , p m and edges</p><formula xml:id="formula_15" coords="10,72.00,201.76,468.17,20.56">e k = (p k , h) with γ(e k ) = γ k , the factor ϕ h has scope (X h , X p1 , • • • , X pm ),</formula><p>and can be described by a 2 × 2 m matrix to store the conditional probabilities</p><formula xml:id="formula_16" coords="10,72.00,223.58,161.98,9.65">P(X h = j | X p1 = i 1 , • • • , X pm = i m )</formula><p>. This is a 2 × 4 matrix in the typical case when h is admixed from m = 2 parental populations. With m = 2 and with parental values (X p1 , X p2 ) arranged ordered ((0, 0), (0, 1), (1, 0), (1, 1)), then</p><formula xml:id="formula_17" coords="10,72.00,256.21,438.77,200.02">ϕ h = 1 γ 1 γ 2 0 0 γ 2 γ 1 1 . T (a) nρ, rρ n3, r3 n1, r1 n2, r2 G (b) nρ rρ n 3 r 3 n3 r3 n 1 r 1 r 2 n 2 n1 r1 r2 n2 U (c) nρ, rρ, n 3 , r 3 n3, r3, n 3 , r 3 n 1 , r 1 , n 2 , r 2 , n3, r3 n1, r1, n 1 , r 1 n2, r2, n 2 , r 2 n 3 , r 3 n 1 , r 1 n 2 , r 2 n 1 , r 1 n 2 , r 2 n3, r3 n 3 , r 3 Figure 3: (a)</formula><p>Phylogenetic species tree T , used to generate gene genealogies for n 1 and n 2 individuals sampled from species 1 and 2 respectively. (b) Graph G for the graphical model associated with the evolution of a binary trait on a gene tree drawn from the multispecies coalescent model. G is a DAG with 2 sources (roots) n 1 and n 2 , and 2 sinks (leaves) r 1 and r 2 . The model restricted to variables n e and n e (in black) can be described by the subgraph G n whose nodes and edges are in black. It is a tree similar to T but with reversed edge directions. (c) Clique tree U for G. Note that the 6-variable clique is overparametrized because n 1 + n 2 = n 3 and r 1 + r 2 = r 3 , but reflects the symmetry of the model.</p><p>Example 3 (Binary trait with ILS on a tree). Our final example is a case that accounts for incomplete lineage sorting (ILS), when the graph G for the graphical model is constructed from but not identical to the phylogeny. Consider the species tree in Fig. <ref type="figure" coords="10,150.25,555.31,8.06,8.64">3a</ref>, a sample of one or more individuals sampled from each species (1 and 2), and a gene tree (or genealogy) generated according to the multispecies coalescent model along T <ref type="bibr" coords="10,392.64,566.22,65.94,8.64" target="#b79">Kingman [1982]</ref>, <ref type="bibr" coords="10,465.56,566.22,74.45,8.64;10,72.00,577.13,24.63,8.64" target="#b110">Rannala and Yang [2003]</ref>. Finally, consider a binary trait evolving along this gene tree, with states (or alleles) "black" and "red" to re-use terminology by <ref type="bibr" coords="10,136.60,588.04,77.48,8.64" target="#b27">Bryant et al. [2012]</ref>. The observations from this model are the number of individuals r i with the red allele among the n i individuals sampled from each species i. <ref type="bibr" coords="10,311.08,598.94,75.97,8.64" target="#b27">Bryant et al. [2012]</ref> discovered conditional independencies in this model by considering and conditioning on the total number (n) and number of red alleles (r) ancestral to the sampled individuals at the beginning of each edge e: n e and r e ; and at the end of each edge e: n e and r e . Here, we formulate this evolutionary model as a graphical model. Its graph G is different from the original phylogenetic tree, as illustrated in Fig. <ref type="figure" coords="10,142.85,642.58,8.04,8.64">3b</ref>.</p><p>If we only consider the ancestral number of individuals n, then the graph G n for the associated graphical model is as follows, thanks to the description of the coalescent model going back in time. For each edge e in T , an edge is created in G n but with the reversed direction (black subgraph in Fig. <ref type="figure" coords="10,359.42,680.79,3.67,8.64">3</ref>). On this edge, the coalescent edge factor ϕ ne = P(n e | n e ) was derived by <ref type="bibr" coords="10,206.93,691.70,54.43,8.64" target="#b131">Tavaré [1984]</ref> and is given in <ref type="bibr" coords="10,323.38,691.70,105.84,8.64">[Bryant et al., 2012, eq. (6)</ref>]. Each internal node v in T is triplicated in G n to hold the variables n e , n c1 and n c2 , where e denotes the parent edge of v and c 1 , c 2 denote its child edges (assuming that v has only 2 children, without loss of generality). These nodes are then connected in G n by edges from each n ci to n e . The speciation factor ϕ ne = 1 {nc 1 +nc 2 } (n e ) expresses the relationship n e = n c1 + n c2 .</p><p>Overall, G n is a tree with a single sink (leaf), multiple sources (roots), and data at the roots.</p><p>To calculate the likelihood of the data, we add the number of red alleles r ancestral to the sampled individuals.</p><p>The full graph G (Fig. <ref type="figure" coords="11,166.44,114.87,9.03,8.64">3b</ref>) contains G n , with extra nodes for the r variables, and extra edges to model the process along edges and at speciations. The node family for r e includes r e and both n e and n e . The mutation edge factor ϕ re = P(r e | r e , n e , n e ) was derived by <ref type="bibr" coords="11,232.95,136.69,108.01,8.64" target="#b52">Griffiths and Tavaré [1994]</ref> using both the coalescent and mutation processes, and is given in <ref type="bibr" coords="11,131.41,147.60,110.06,8.64">[Bryant et al., 2012, eq. (16)</ref>]. For edge e in T with child edges c 1 and c 2 in T , the speciation factors for red alleles ϕ rc 1 = P(r c1 | n c1 , n e , r e ) and ϕ rc 2 = 1 {re−rc 1 } (r c2 ) describe a hypergeometric distribution where n c1 individuals, r c1 of which are red, are sampled from a pool of n e individuals, r e of which are red, and r c2 = r e − r c1 .</p><p>Given this graphical model description, the likelihood calculation described in <ref type="bibr" coords="11,386.34,186.97,78.07,8.64" target="#b27">Bryant et al. [2012]</ref> corresponds to BP along graph G, as we will illustrate later.</p><p>This framework can be extended to the case when the phylogeny is reticulate, with additional edges in G, and hybridization factors to model the process at hybrid nodes for the n and r variables, illustrated on an example in SM section A. The likelihood calculations used in SnappNet and described in <ref type="bibr" coords="11,367.30,237.96,76.99,8.64" target="#b107">Rabier et al. [2021]</ref> correspond to BP along this graph G.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Belief Propagation</head><p>BP is a framework for efficiently computing various integrals of the factored density p θ by grouping nodes and their associated variables into clusters and integrating them out according to rules along a clique tree (also known by junction tree, join tree, or tree decomposition) or along a cluster graph, more generally.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.1">Cluster graphs and Clique trees</head><p>Definition 1 (cluster graph and clique tree). Let Φ = {ϕ v , v ∈ V } be the factors of a graphical model on graph G and let U = (V, E) be an undirected graph whose nodes V, called clusters, consists of sets of variables in the scope of Φ. U is a cluster graph for Φ if it satisfies the following properties:</p><p>1. (family-preserving) There exists a map α : Φ → V such that for each factor ϕ v , its scope (node family for node v in the graphical model) is a subset of the cluster α(ϕ v ).</p><p>2. (edge-labeled) Each edge {C i , C j } in E is labelled with a non-empty sepset S i,j ("separating set") such that S i,j ⊆ C i ∩ C j .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">(running intersection)</head><p>For each variable x in the scope of Φ, E x ⊆ E, the set of edges with x in their sepsets forms a tree that spans V x ⊆ V, the set of clusters that contain x.</p><p>If U is acyclic, then U is called a clique tree and we refer to its nodes as cliques. In this case, properties 2 and 3 imply that S i,j = C i ∩ C j .</p><p>A clique tree U is shown in Fig. <ref type="figure" coords="11,201.36,519.11,9.97,8.64" target="#fig_2">1b</ref> for the BM model from Example 1, on the tree T in Fig. <ref type="figure" coords="11,440.75,519.11,7.94,8.64" target="#fig_2">1a</ref>. To check the running intersection property for x 5 , for example, we extract the graph defined by edges with x 5 in their sepsets (squares).</p><p>There are 2 such edges. They induce a subtree of U that connects all 3 clusters (ellipses) containing x 5 , as desired. More generally, when the graphical model is defined on a tree T , a corresponding clique tree U is easily constructed, where cliques in U correspond to edges in T , and edges in U correspond to nodes in T . Multiple clique trees can be constructed for a given graphical model. In this example, the clique {x ρ } (shown at the top) could be suppressed, because it is a subset of adjacent cliques.</p><p>For the network N in Fig. <ref type="figure" coords="11,180.26,600.95,9.59,8.64" target="#fig_3">2a</ref> and the evolution of a discrete trait in Example 2, one possible clique tree U is shown in Fig. <ref type="figure" coords="11,102.31,611.86,8.20,8.64" target="#fig_3">2b</ref>. Note that x 5 , x 4 and x 6 have to appear together in at least one of the clusters for the clique tree to be family-preserving (property 1), because x 4 and x 6 are partners with a common child x 5 whose distribution depends on both of their states.</p><p>We first focus on clique trees, which provide a structure for the exact likelihood calculation. In section 5 we discuss the advantages of cluster graphs, to approximate the likelihood at a lower computational cost.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.2">Evidence</head><p>To calculate the likelihood of the data, or the marginal distribution of the traits at some node conditional on the data, we inject evidence into the model, in one of two equivalent ways. For each observed value x v,t of the t th trait x v,t at node v, we add to the model the indicator function 1 {xv,t} (x v,t ) as an additional factor. Equivalently, we can plug in the observed value x v,t in place of the variable x v,t in all factors where x v,t appears, and then drop x v,t from the scope of all these factors. This second approach is more tractable than the first to avoid the degenerate zero-variance Dirac distribution. But it requires careful bookkeeping of the scope and of re-parametrization of each factor with missing data, when some traits but not all are observed at some nodes. Below, we assume that the factors and their scopes have been modified to absorb evidence from the data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.3">Belief update message passing</head><p>There are multiple equivalent algorithms to perform BP. We focus here on the belief update algorithm. It assigns a belief to each cluster and to each sepset in the cluster graph. After running the algorithm, each belief should provide the marginal probability of the variables in its scope and of the observed data, with all other variables integrated out as desired to calculate the likelihood. The belief β i of cluster C i is initialized as the product of all factors assigned to that cluster:</p><formula xml:id="formula_18" coords="12,239.47,225.52,301.20,20.53">ψ i = ϕ; α(ϕ)=Ci ϕ for cluster C i (5)</formula><p>The belief µ i,j of an edge between cluster i and j is initialized to the constant function 1. These beliefs are then updated iteratively by passing messages. Passing a message from C i to C j along an edge with sepset S i,j corresponds to passing information about the marginal distribution of the variables in S i,j as shown in Algorithm 1. If U is a clique tree, then</p><p>Algorithm 1 Belief propagation: message passing along an edge from C i to C j with sepset S i,j .</p><p>1: compute the message μi→j = Ci\Si,j β i d(C i \S i,j ), that is, the marginal probability of S i,j based on belief β i , by integrating all other variables in C i , 2: update the cluster belief about C j : β j ← β j μi→j /µ i,j , 3: update the edge belief about S i,j : µ i,j ← μi→j . all beliefs converge to the true marginal probability of their variables and of the observed data, after traversing U only twice: once to pass messages from leaf cliques towards some root clique, and then back from the root clique to the leaf cliques. If our goal is to calculate the likelihood, then one traversal is sufficient. Once the root clique has received messages from all its neighboring cliques, we can marginalize over all its variables (similar to step 1) to obtain the probability of the observed data only, which is the likelihood. The second traversal is necessary to obtain the marginal probability of all variables, such as if one is interested in the posterior distribution of ancestral states conditional on the observed data. Some equivalent formulations of BP only store sepset messages, and avoid storing cluster beliefs. This strategy requires less memory but more computing time if U is traversed multiple times. Example 4 (link to IC). Continuing on Example 1 on the tree in Fig. <ref type="figure" coords="12,347.20,480.10,3.69,8.64" target="#fig_0">1</ref>, the conditional distribution of x v at a non-root node v corresponds to a factor ϕ v for the BM model along edge (pa(v), v) in T . This factor is assigned to clique</p><formula xml:id="formula_19" coords="12,72.00,501.60,318.63,9.65">C v = {pa(v), v} in U to initialize the belief β v of C v . If v if a leaf in T , then β v</formula><p>is further multiplied by the indicator function at the value x v observed at v, such that the belief of clique C v can be expressed as a function of the leaf's parent state only:</p><formula xml:id="formula_20" coords="12,117.96,523.42,111.64,9.96">ϕ v (x pa(v) ) = P(x v | x pa(v)</formula><p>). The prior distribution ϕ(x ρ ) at the root ρ of T (which can be an indicator function if the root value is fixed as a model parameter) can be assigned to any clique containing ρ. In Fig. <ref type="figure" coords="12,488.20,534.65,3.66,8.64" target="#fig_0">1</ref>, U includes a clique C ρ = {x ρ } drawn at the top, to which we assign the root prior ϕ ρ (x ρ ) and which we will use as the root of U. Since U is a clique tree, BP converges after traversing U twice: from the tips to C ρ and then back to the tips. <ref type="bibr" coords="12,529.84,556.47,10.16,8.64;12,72.00,567.38,69.37,8.64">IC Felsenstein [1973</ref><ref type="bibr" coords="12,141.37,567.38,30.27,8.64" target="#b42">, 1985]</ref> implements the first "rootwards" traversal of BP. For example, the belief of clique {x 5 , x ρ } after receiving messages (steps 1-3) from both of its daughter cliques is the function</p><formula xml:id="formula_21" coords="12,71.64,592.01,409.00,62.42">β 5 (x 5 , x ρ ) = exp − (x ρ − x 5 ) 2 2ℓ 5 − (x 5 − x * 5 ) 2 2v * 5 + g * 5 where x * 5 = ℓ 2 x 1 + ℓ 1 x 2 ℓ 1 + ℓ 2 , v * 5 = ℓ 1 ℓ 2 ℓ 1 + ℓ 2 , and g * 5 = − (x 2 − x 1 ) 2 2(ℓ 1 + ℓ 2 ) − log((2π) 3/2 ℓ 1 ℓ 2 ℓ 5 )</formula><p>are quantities calculated for IC: x * 5 corresponds to the estimated ancestral state at node 5, v * 5 corresponds to the extra length added to ℓ 5 when pruning the daughters of node 5, and g * 5 captures the contrast (x 2 − x 1 )/ √ ℓ 1 + ℓ 2 below node 5. At this stage of BP, β 5 (x 5 , x ρ ) can be interpreted as P(x 1 , x 2 , x 5 | x ρ ) such that the message μ5→ρ (x ρ ) sent from {x 5 , x ρ } to the root clique C ρ is the partial likelihood P(x 1 , x 2 | x ρ ) after x 5 is integrated out. The first pass is complete when C ρ has received messages from all its neighbors. Its final belief is then</p><formula xml:id="formula_22" coords="12,369.45,702.29,170.05,9.65">β ρ (x ρ ) = P(x 1 , • • • , x 4 | x ρ )ϕ ρ (x ρ ). If x ρ</formula><p>is a fixed model parameter, then this is the likelihood. Otherwise, we get the likelihood by integrating out x ρ in β ρ (x ρ ).</p><p>In Example 2 on a network (Fig. <ref type="figure" coords="13,208.74,75.48,3.67,8.64" target="#fig_3">2</ref>), we label the cliques in U as follows: C v = {x v , x pa(v) } for leaves v = 1, 2, 3, C 5 = {x 5 , x 4 , x 6 } for hybrid node v = 5 and its parents, and C ρ = {x 4 , x 6 , x ρ }. To initialize beliefs, we assign ϕ v to C v for v = 1, 2, 3, 5, and ϕ 4 , ϕ 6 are both assigned to C ρ . Unlike in Example 1 on a tree, a clique may correspond to more than a single edge in T . This is expected at a hybrid node h, because the factor describing its conditional distribution needs to contain h and both of its parents. But for U to be a clique tree, the root clique C ρ also has to contain the factors from 2 edges in T . Also, unlike for trees, sepsets may contain more than a single node. Here, the two large cliques are separated by {x 4 , x 6 } so they will send messages μ(x 4 , x 6 ) about the joint distribution of these two variables. In this binary trait setting, these messages and sepset belief can be stored as 2 × 2 arrays, and the 3-node cliques beliefs can be stored as arrays of 2 3 values. As they involve more variables than when G is a tree (in which case BP would store only 2 values at each sepset), storing and updating them requires more computating time and memory.</p><p>More generally, we see that the computational complexity of BP scales with the size of the cliques and sepsets. This complexity may become prohibitive on a more complex phylogenetic network, even for a simple binary trait without ILS, if the size of the largest cluster in U is too large -a topic that we explore later.</p><p>Example 3 illustrates the fact that beliefs cannot always be interpreted as partial (or full) likelihoods at every step of BP, unlike in Examples 1 and 2. For example, consider the first iteration of BP, with the tip clique C 1 containing (n 1 , r 1 ) (Fig. <ref type="figure" coords="13,126.50,257.66,4.15,8.64">3</ref>) sending a message to its large neighbor clique. The belief of C 1 is initialized with the factors ϕ n 1 and ϕ r1 , which are the probabilities of n 1 and of r 1 conditional on their parents in graph G. From fixing (n 1 , r 1 ) to their observed values (n 1 , r 1 ), the message sent by C 1 in step 1 is</p><formula xml:id="formula_23" coords="13,222.06,299.88,168.66,10.91">μ(n 1 , r 1 ) = P(n 1 | n 1 ) P(r 1 | r 1 , n 1 , n 1 ) .</formula><p>This message is the quantity denoted by F T (n, r) in <ref type="bibr" coords="13,281.66,320.24,75.63,8.64" target="#b27">Bryant et al. [2012]</ref>. It is not a partial likelihood, because it is not the likelihood of some partial subset of the data conditional on some ancestral values in the phylogeny. Intuitively, this is because nodes with data below n 1 include both r 1 and r 2 , yet C 1 does not include r 2 . Information about r 2 will be passed to the root of U separately. More generally, during the first traversal of U, each sepset belief corresponds to an F value in <ref type="bibr" coords="13,116.88,363.88,77.91,8.64" target="#b27">Bryant et al. [2012]</ref>: F T for sepsets at the top of a branch (n e , r e ), and F B for sepsets at the bottom of a branch (n e , r e ). The beauty of BP on a clique tree is that beliefs are guaranteed to converge to the likelihood of the full data, conditional on the state of the clique variables. After messages are passed down from the root to C 1 , the updated belief of C 1 will indeed be the likelihood of the full data conditional on n 1 and r 1 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.4">Clique tree construction</head><p>For a given graphical model on G, there are many possible clique trees and cluster graphs. For running BP, it is advantageous to have small clusters and small sepsets. Indeed, clusters and sepsets with fewer variables require less memory to store beliefs, and less computing time to run steps 1 (integration) and 2 (belief update). Ideally, we would like to find the best clique tree: whose largest clique is of the smallest size possible. For a general graph G, finding this best clique tree is hard but good heuristics exist <ref type="bibr" coords="13,263.41,482.78,110.05,8.64" target="#b81">Koller and Friedman [2009]</ref>.</p><p>The first step is to create the moralized graph G m from G. This is done by connecting all nodes that share a common child, and then undirecting all edges. We can then triangulate G m , that is, build a new graph H by adding edges to G m such that H is chordal (any cycle includes a chord). This is the hard step, if one wants to find a triangulation with the smallest maximum clique size. An efficient heuristic is the greedy minimum-fill heuristic <ref type="bibr" coords="13,447.23,531.90,47.64,8.64" target="#b115">Rose [1972]</ref>, <ref type="bibr" coords="13,501.53,531.90,38.46,8.64;13,72.00,542.80,71.52,8.64" target="#b43">Fishelson and Geiger [2003]</ref>. The cliques in U are then taken as the maximal cliques in H Blair and Peyton <ref type="bibr" coords="13,462.95,542.80,24.95,8.64">[1993]</ref>. Finally, the edges in U are formed such that U becomes a tree and such that the sum of the sepset sizes is maximum, by finding a maximum spanning tree using Kruskal's algorithm or Prim's algorithm <ref type="bibr" coords="13,369.42,564.62,82.78,8.64" target="#b33">Cormen et al. [2009]</ref>. All these steps have polynomial complexity.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">BP for Gaussian models</head><p>Before discussing BP on cluster graphs that are not clique trees, we focus on BP updates for the evolutionary models presented in section 3. On a phylogenetic network N , the joint distribution of all present and ancestral species (X v ) v∈N is multivariate Gaussian precisely when it comes from a graphical model on N whose factors ϕ v are linear Gaussian <ref type="bibr" coords="13,72.00,653.49,109.22,8.64" target="#b81">Koller and Friedman [2009]</ref>. The factor at node v is linear Gaussian if, conditional on its parents, X v is Gaussian with a mean that is linear in the parental values and a variance independent of parental values, hence the term G LInv used by <ref type="bibr" coords="13,72.00,675.31,74.18,8.64" target="#b96">Mitov et al. [2020]</ref>. In other words, for the joint process to be Gaussian, each factor ϕ v (x v | x pa(v) ) should be of the form (2). Such models have been called Gaussian Bayesian networks or graphical Gaussian networks, and are special cases of Gaussian processes (on a graph). These Gaussian models are convenient for BP because linear Gaussian factors have a convenient parametrization that allows for a compact representation of beliefs and belief update operations. Namely, the factor giving the conditional distribution ϕ v (x v | x pa(v) ) from ( <ref type="formula" coords="14,349.58,86.39,3.87,8.64" target="#formula_1">2</ref>) can be expressed in a canonical form as the exponential of a quadratic form:</p><formula xml:id="formula_24" coords="14,207.08,113.15,333.59,22.31">C(x; K, h, g) = exp − 1 2 x ⊤ Kx + h ⊤ x + g .<label>(6)</label></formula><p>For example, if we think of ϕ v (x v | x pa(v) ) as a function of x v primarily, we may use the parametrization C(x v ; K, h, g) with</p><formula xml:id="formula_25" coords="14,106.68,166.91,391.69,22.31">K = V −1 v , h = V −1 v q v x pa(v) + ω v , and g = − 1 2 log |2πV v | + ∥q v x pa(v) + ω v ∥ 2 V −1 v</formula><p>where ∥y∥ 2 M denotes y ⊤ M y. We can also express ϕ v as a canonical form over its full scope</p><formula xml:id="formula_26" coords="14,71.64,212.87,484.61,65.77">ϕ v (x v | x pa(v) ) = C x v x pa(v) ; K v , h v , g v with K v = V −1 v −V −1 v q v −q ⊤ v V −1 v q ⊤ v V −1 v q v = I −q ⊤ v V −1 v [I −q v ] , h v = V −1 v ω v −q ⊤ v V −1 v ω v , g v = − 1 2 (log |2πV v |+∥ω v ∥ V −1 v</formula><p>) .</p><p>(7) If v is a leaf with fully observed data, then we need to plug-in the data x v into ϕ v and consider this factor as a function of x pa(v) only. We can express ϕ v (x v | x pa(v) ) as the canonical form C(x pa(v) ; K, h, g) with</p><formula xml:id="formula_27" coords="14,113.04,317.57,385.91,22.31">K = q ⊤ v V −1 v q v , h = q ⊤ v V −1 v (x v − ω v ), and g = − 1 2 log |2πV v | + ∥x v − ω v ∥ 2 V −1 v .</formula><p>If data are partially observed at leaf v, the same principle applies. We can plug-in the observed traits into ϕ v and express ϕ v as a canonical form over its reduced scope: x pa(v) and any unobserved x v,t . Some quadratic terms captured by K v on the full scope become linear or constant terms after plugging-in the data, and some linear terms captured by h v on the full scope become constant terms in the canonical form on the reduced scope.</p><p>An important property of this canonical form is its closure under the belief update operations: marginalization (step 1) and factor product (step 2). Indeed, the product of two canonical forms with the same scope satisfies:</p><formula xml:id="formula_28" coords="14,159.74,425.90,292.53,9.68">C(x; K 1 , h 1 , g 1 ) C(x; K 2 , h 2 , g 2 ) = C(x; K 1 + K 2 , h 1 + h 2 , g 1 + g 2 ) .</formula><p>Now consider marginalizing a factor C(x; K, h, g) to a subvector x * of x, by integrating out the elements x\x * of x . let K S and K I be the submatrices of K that correspond to x * (Scope of marginal or Sepset) and x\x * (variables to be Integrated out), and let K S,I = K ⊤ I,S be the cross-terms. If K I is invertible, then:</p><formula xml:id="formula_29" coords="14,213.65,486.90,196.32,12.03">C x\x * (x; K, h, g) d(x\x * ) = C(x * ; K * , h * , g * )</formula><p>where K * = K S −K S,I K −1 I K I,S , h * = h S −K S,I K −1 I h I with h S and h I defined as the subvector of h corresponding to x * and x\x * respectively, and</p><formula xml:id="formula_30" coords="14,205.38,523.08,161.65,15.45">g * = g + (log |2πK −1 I | + ∥h I ∥ K −1 I )/2.</formula><p>If the factors of a Gaussian network are non-deterministic, then each belief can be parametrized by its canonical form, and the above equations can be applied to update the cluster and sepset beliefs for BP (Algorithm 1). For cluster C i , let (K i , h i , g i ) parametrize its belief β i . For sepset S i,j , let (K i,j , h i,j , g i,j ) parametrize its belief µ i,j . Also, for step 1 of BP, let (K i→j , h i→j , g i→j ) parametrize the message μi→j sent from C i to C j . Then BP updates can be expressed as shown below.</p><p>In step 1, K S and K I are the submatrices of K i that correspond to S i,j and C i \ S i,j . Similarly, h S and h I are subvectors of h i . In step 2, ext(K μ − K i,j ) extends K μ − K i,j to the same scope as K j by padding it with zero-rows and zero-columns for C j \ S i,j . Similarly, ext(h i→j − h i,j ) extends h i→j − h i,j to scope C j with 0 entries on rows for C j \ S i,j .</p><p>If the phylogeny is a tree, performing these updates from the tips to the root corresponds to the recursive equations ( <ref type="formula" coords="14,530.76,653.49,3.50,8.64" target="#formula_44">9</ref>), ( <ref type="formula" coords="14,75.90,664.40,8.46,8.64">10</ref>) and ( <ref type="formula" coords="14,112.70,664.40,8.46,8.64">11</ref>) of <ref type="bibr" coords="14,139.05,664.40,75.10,8.64" target="#b96">Mitov et al. [2020]</ref>, and to the propagation formulas (A.3)-(A.8) of <ref type="bibr" coords="14,414.09,664.40,80.88,8.64" target="#b16">Bastide et al. [2021]</ref>, who both considered the general linear Gaussian model (2).</p><p>At any point, a belief C(x; K, h, g) gives a local estimate of the conditional mean (K −1 h) and conditional variance (K −1 ) of trait X given data Y, for K ≻ 0. An exact belief, such that C(x; K, h, g) ∝ p θ (x | Y), gives exact conditional estimates, that is:</p><formula xml:id="formula_31" coords="14,191.32,711.62,181.78,10.53">E(X | Y) = K −1 h and var(X | Y) = K −1 .</formula><p>Algorithm 2 Gaussian belief propagation: from C i to C j with sepset S i,j .</p><p>1: compute message μi→j :</p><formula xml:id="formula_32" coords="15,188.80,90.48,180.99,42.69">     K i→j = K S − K S,I K −1 I K I,S h i→j = h S − K S,I K −1 I h I g i→j = g i + (log |2πK −1 I | + ∥h I ∥ K −1 I )/2</formula><p>2: update the cluster belief β j about C j :</p><formula xml:id="formula_33" coords="15,239.13,135.02,139.92,36.89">   K j ← K j + ext(K i→j − K i,j ) h j ← h j + ext(h i→j − h i,j ) g j ← g j + g i→j − g i,j</formula><p>3: update the edge belief µ i,j about S i,j :</p><formula xml:id="formula_34" coords="15,242.91,175.29,67.14,36.89">   K i,j ← K i→j h i,j ← h i→j g i,j ← g i→j</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Scalable approximate inference with loopy BP</head><p>The previous examples focused on clique trees and the exact calculation of the likelihood. We now turn to the use of cluster graphs with cycles, or loopy cluster graphs, such as in Fig. <ref type="figure" coords="15,344.10,275.38,4.09,8.64" target="#fig_3">2</ref>(c) or Fig. <ref type="figure" coords="15,393.29,275.38,19.55,8.64" target="#fig_4">4(c-d</ref>). BP on a loopy cluster graph, abbreviated as loopy BP, can approximate the likelihood and posterior distributions of ancestral values, and can be more computationally efficient than BP on a clique tree. Purple boxes and edges: clusters and sepsets that contain node 8. Red text: hybrid families.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Calibration</head><p>Updating beliefs on a loopy cluster graph uses Algorithm 1 in the same way as on a clique tree. A cluster graph is said to be calibrated when its normalized beliefs have converged (i.e. are unchanged by Algorithm 1 along any edge). For calibration, neighboring clusters C i and C j must have beliefs that are marginally consistent over the variables in their sepset S i,j :</p><formula xml:id="formula_35" coords="15,195.18,681.65,233.27,9.65">β i d(C i \S i,j ) = μi→j ∝ µ i,j ∝ μj→i = β j d(C j \S i,j ) .</formula><p>On a clique tree, calibration can be guaranteed at the end of a finite sequence of messages passed. Clique and sepset beliefs are then proportional to the posterior distribution over their variables, and can be integrated to compute the common normalization constant κ = κ i = β i dC i = κ j,k = µ j,k dS j,k , which equals the likelihood. For loopy BP, calibration is not guaranteed. If it is attained, then we can similarly view cluster and sepset beliefs as unnormalized approximations of the posterior distribution over their variables, though the κ i s and κ j,k s may differ, grow unboundedly, and generally do not equal or estimate the likelihood. Gaussian models enjoy the remarkable property that, if calibration can be attained on a cluster graph, then the approximate posterior means (ancestral values) are guaranteed to be exact. In contrast, the posterior variances are generally inexact, and are typically underestimated <ref type="bibr" coords="16,431.91,130.02,105.19,8.64" target="#b140">Weiss and Freeman [1999]</ref>, <ref type="bibr" coords="16,71.53,140.93,94.70,8.64" target="#b138">Wainwright et al. [2003]</ref>, <ref type="bibr" coords="16,172.80,140.93,89.36,8.64" target="#b92">Malioutov et al. [2006]</ref>, although we found them overestimated in our phylogenetic examples below (Fig. <ref type="figure" coords="16,120.18,151.84,3.60,8.64" target="#fig_7">7</ref>).</p><p>Successful calibration depends on various aspects such as the features of the loops in the cluster graph, the factors in the model, and the scheduling of messages. For beliefs to converge, a proper message schedule requires that a message is passed along every sepset, in each direction, infinitely often (until stopping criteria are met) <ref type="bibr" coords="16,445.33,190.05,92.18,8.64" target="#b92">Malioutov et al. [2006]</ref>.</p><p>Multiple scheduling schemes have been devised to help reach calibration more often and more accurately. These can be data-independent (e.g. choosing a list of trees nested in the cluster graph that together cover all clusters and edges, then iteratively traversing each tree in both directions <ref type="bibr" coords="16,285.70,222.77,96.38,8.64" target="#b138">Wainwright et al. [2003]</ref>) or adaptive (e.g. prioritizing messages between clusters that are further from calibration <ref type="bibr" coords="16,265.90,233.68,74.01,8.64" target="#b39">Elidan et al. [2006]</ref>, <ref type="bibr" coords="16,346.47,233.68,113.38,8.64" target="#b129">Sutton and McCallum [2007]</ref>, <ref type="bibr" coords="16,466.43,233.68,70.74,8.64" target="#b80">Knoll et al. [2015]</ref>, <ref type="bibr" coords="16,71.64,244.59,83.89,8.64" target="#b1">Aksenov et al. [2020]</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Likelihood approximation</head><p>To approximate the log-likelihood LL(θ) = log p θ (x)dx from calibrated beliefs on cluster graph U * = (V * , E * ), denoted together as q = {β i , µ i,j ; C i ∈ V * , {C i , C j } ∈ E * }, we can use the factored energy functional <ref type="bibr" coords="16,496.61,300.85,43.39,8.64;16,72.00,311.76,65.82,8.64" target="#b81">Koller and Friedman [2009]</ref>:</p><formula xml:id="formula_36" coords="16,185.70,322.81,351.09,23.05">F (p θ , q) = Ci∈V * E βi (log ψ i ) + Ci∈V * H(β i ) − {Ci,Cj }∈E * H(µ i,j ) . (<label>8</label></formula><formula xml:id="formula_37" coords="16,536.80,325.64,3.87,8.64">)</formula><p>Recall that ψ i is the product of factors ϕ v assigned to cluster C i . Here E βi denotes the expectation with respect to β i normalized to a probability distribution. H(β i ) and H(µ i,j ) denote the entropy of the distributions defined by normalizing β i and µ i,j respectively. F (p θ , q) has the advantage of involving local integrals that can be calculated easily: each over the scope of a single cluster or sepset. The justification for F (p θ , q) comes from two approximations. First, following the expectation-maximization (EM) decomposition, LL(θ) can be approximated by the evidence lower bound (ELBO) used for variational inference <ref type="bibr" coords="16,249.05,412.51,89.28,8.64" target="#b109">Ranganath et al. [2014]</ref>. For any distribution q over the full set of variables, which are here the unobserved (latent) variables after absorbing evidence from the data, we have</p><formula xml:id="formula_38" coords="16,211.82,441.57,188.37,9.65">LL(θ) ≥ ELBO(p θ , q) = E q (log p θ ) + H(q) .</formula><p>The gap LL(θ) − ELBO(p θ , q) is the Kullback-Leibler divergence between q, and p θ normalized to the distribution of the unobserved variables conditional on the observed data. The first approximation comes from minimizing this gap over a class of distributions q that does not necessarily include the true conditional distribution. The second approximation comes from pretending that for a given distribution q with a belief factorization</p><formula xml:id="formula_39" coords="16,259.28,510.94,85.81,25.85">q ∝ Ci∈V * β i {Ci,Cj }∈E * µ i,j</formula><p>, its marginal over a given cluster (or a given sepset) is equal to the normalized belief of that cluster (or sepset), simplifying E q (log ψ i ) to E βi (log ψ i ) and simplifying E q (− log β i ) to H(β i ). This simplification leads to the more tractable F (p θ , q), in which each integral is of lower dimension, within the scope of a single cluster or sepset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Scalability versus accuracy: choice of cluster graph complexity</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.1">Scalability, treewidth and phylogenetic network complexity</head><p>At the cost of exactness, loopy cluster graphs can offer greater computational scalability than clique trees because they allow for smaller cluster sizes, which reduces the complexity associated with belief updates. For example, consider a Gaussian model for p traits: dim(x v ) = p at all nodes v in the network. For a clique tree U with m cliques and maximum clique size k, passing a message between neighbor cliques has complexity O(p 3 k 3 ) and calibrating U has complexity O(mp 3 k 3 ). Now consider a cluster graph U * with m * clusters, O(m * ) edges, and maximum cluster size k * &lt; k. Then passing a message between neighbor cliques of U * has complexity O(p 3 k * 3 ) so it is faster than on U. But calibrating U * now requires more belief updates because each edge needs to be traversed more than twice. If each edge is traversed in both directions b times to reach convergence, then calibrating U * has complexity O(bm * p 3 k * 3 ). So</p><formula xml:id="formula_40" coords="17,155.64,77.31,202.16,94.88">N 2 u 1 v 1 u 2 v 2 u 3 a b N 1 w w u 3 u 1 u 2 b c v 1 d v 2</formula><p>a u 1 and u 2 are adjacent u 3 is a descendant of u 2 if U * has smaller clusters than U and if (k/k * ) 3 ≫ bm * /m, then loopy BP on U * runs faster than BP on U. Loopy BP could be particularly advantageous for complex networks whose clique trees have large clusters.</p><p>Cluster graph construction determines the balance between scalability and approximation quality. At one end of the spectrum, the most scalable and least accurate are the factor graphs, also known as Bethe cluster graphs <ref type="bibr" coords="17,489.06,301.90,52.68,8.64;17,72.00,312.81,25.40,8.64" target="#b142">Yedidia et al. [2005]</ref>. A factor graph has one cluster per factor ϕ v and one cluster per variable, and so has the smallest possible maximum clique size k * and each sepset reduced to a single variable. Various algorithms have been proposed for constructing cluster graphs along the spectrum (e.g. <ref type="bibr" coords="17,277.29,334.63,144.66,8.64">LTRIP Streicher and du Preez [2017]</ref>) (Fig. <ref type="figure" coords="17,449.84,334.63,3.53,8.64" target="#fig_4">4</ref>). Notably, join-graph structuring <ref type="bibr" coords="17,116.79,345.54,87.46,8.64" target="#b94">Mateescu et al. [2010]</ref> spans the whole spectrum because it is controlled by a user-defined maximum cluster size k * , which can be varied from its smallest possible value to a value large enough to obtain a clique tree.</p><p>At the other end of the spectrum, the best maximum clique size k is 1 + tw(G m ), where tw(G m ) is the treewidth of the moralized graph. Loopy BP becomes interesting when tw(G m ) is large, making exact BP costly. Unfortunately, determining the treewidth of a general graph is NP-hard <ref type="bibr" coords="17,290.73,394.65,80.49,8.64" target="#b6">Arnborg et al. [1987]</ref>, <ref type="bibr" coords="17,377.50,394.65,115.84,8.64" target="#b24">Bodlaender and Koster [2010]</ref>. Heuristics such as greedy minimum-fill or nested dissection <ref type="bibr" coords="17,271.67,405.56,59.50,8.64" target="#b127">Strasser [2017]</ref>, <ref type="bibr" coords="17,337.86,405.56,114.78,8.64" target="#b56">Hamann and Strasser [2018]</ref> can be used to obtain clique trees whose maximum clique size k is near the optimum 1 + tw(G m ).</p><p>Different cluster graph algorithms could potentially be applied to the different biconnected components, or blobs <ref type="bibr" coords="17,72.00,443.77,84.54,8.64" target="#b54">Gusfield et al. [2007]</ref> (e.g. LTRIP for one blob, clique tree for another), perhaps based a blob's attributes that are easy to compute. To choose between loopy versus exact BP, or between different cluster graph constructions more generally, one could use traditional complexity measures of phylogenetic networks as potential predictors of cost-effectiveness. For example, the reticulation number h is straightforward to compute. In a binary network, where all internal non-root nodes have degree 3, h is simply the number of hybrid nodes. More generally h = |{hybrid edges}| − |{hybrid nodes}| Van Iersel et al. <ref type="bibr" coords="17,139.11,498.31,25.40,8.64">[2010]</ref>. The level of a network is the maximum reticulation number within a blob <ref type="bibr" coords="17,479.09,498.31,62.65,8.64;17,72.00,509.22,24.93,8.64" target="#b49">Gambette et al. [2009]</ref>. The network's level ought to predict treewidth better than h because a graph's treewidth equals the maximum treewidth of its blobs <ref type="bibr" coords="17,156.41,520.13,71.74,8.64" target="#b23">Bodlaender [1998]</ref>, and moralizing the network does not affect its nodes' blob membership. These phylogenetic complexity measures do not predict treewidth perfectly <ref type="bibr" coords="17,347.95,531.04,124.49,8.64">Scornavacca and Weller [2022]</ref> except in simple cases as shown below, proved in SM section B.</p><p>Proposition 1. Let N be a binary phylogenetic network with h hybrid nodes, level ℓ, and let t be the treewidth of the moralized network N m obtained from N . For simplicity, assume that N has no parallel edges and no degree-2 nodes other than the root.</p><p>(A0) If ℓ = 0 then h = 0 and t = 1.</p><p>(A1) If ℓ = 1 then h ≥ 1 and t = 2.</p><p>(A2) Let v 1 be a hybrid node with non-adjacent parents u 1 , u 2 . If v 1 has a descendant hybrid node v 2 such that one of its parents is not a descendant of either u 1 or u 2 , then ℓ ≥ 2 and t ≥ 3.</p><p>Level   <ref type="bibr" coords="18,269.51,245.74,75.90,8.64" target="#b121">Sikora et al. [2019]</ref>), <ref type="bibr" coords="18,356.16,245.74,116.08,8.64">[Lazaridis et al., 2014, Fig. 3</ref>], <ref type="bibr" coords="18,482.06,245.74,59.18,8.64;18,72.00,256.65,72.11,8.64">[Nielsen et al., 2023, Fig. 3 (left)</ref>], <ref type="bibr" coords="18,153.52,256.65,99.61,8.64">[Sun et al., 2023, Fig. 4c</ref>], <ref type="bibr" coords="18,263.73,256.65,111.46,8.64">[Müller et al., 2022, Fig. 1a</ref>], <ref type="bibr" coords="18,385.80,256.65,122.31,8.64">[Neureiter et al., 2022, Fig. 5a</ref>  <ref type="bibr" coords="18,204.01,300.29,102.90,8.64" target="#b74">Justison and Heath [2024]</ref>, then filtering out networks of treewidth 1 (trees, possibly with parallel hybrid edges).</p><p>Beyond level-1, a network has a hybrid ladder (also called stack <ref type="bibr" coords="18,325.84,345.47,110.75,8.64" target="#b119">Semple and Simpson [2018]</ref>) if a hybrid node v 1 has a hybrid child node v 2 . By Proposition 1, a hybrid ladder has the potential to increase treewidth of the moralized network and decrease BP scalability, if the remaining conditions in (A2) are met. Related results in <ref type="bibr" coords="18,437.52,367.29,87.69,8.64" target="#b30">Chaplick et al. [2023]</ref> are for undirected graphs that do not require prior moralization, and contain ladders defined as regular 2 × L grids. Their Observation 1, that a graph containing a non-disconnecting grid ladder of length L ≥ 2 has treewidth at least 3, relies on a similar argument as for (A2). However, structures leading to the conditions in (A2) are more general, even before moralization. It may be interesting to extend some of the results from <ref type="bibr" coords="18,345.09,410.92,85.03,8.64" target="#b30">Chaplick et al. [2023]</ref> to moralized hybrid ladders in rooted networks.</p><p>In Fig. <ref type="figure" coords="18,100.73,438.22,4.92,8.64" target="#fig_5">5</ref> (right) N 2 has a hybrid ladder that does not meet all conditions of (A2), and has t = 2. Generally, outerplanar networks have treewidth at most 2 Bodlaender <ref type="bibr" coords="18,254.96,449.13,24.40,8.64">[1998]</ref>, and if bicombining (hybrid nodes have exactly 2 parents), remain outerplanar after moralization. Networks in which no hybrid node is the descendant of another hybrid node in the same blob are called galled networks <ref type="bibr" coords="18,201.11,470.95,76.50,8.64" target="#b69">Huson et al. [2010]</ref>. They provide more tractability to solve the cluster containment problem <ref type="bibr" coords="18,108.23,481.86,76.34,8.64" target="#b68">Huson et al. [2009]</ref>. Here, galled networks would then never meet the assumptions of (A2) and it would be interesting to study their treewidth after moralization.</p><p>We performed an empirical investigation of how h and ℓ can predict the treewidth t of the moralized network. Fig. <ref type="figure" coords="18,534.95,516.24,5.05,8.64" target="#fig_6">6</ref> shows that t correlates with h and ℓ, on networks estimated from real data using various inference methods and on networks simulated under the biologically realistic birth-death-hybridization model <ref type="bibr" coords="18,400.81,538.06,101.05,8.64" target="#b74">Justison and Heath [2024]</ref>, <ref type="bibr" coords="18,508.44,538.06,31.56,8.64;18,72.00,548.97,46.88,8.64" target="#b75">Justison et al. [2023]</ref>, especially for complex networks. For networks with hundreds of tips <ref type="bibr" coords="18,403.35,548.97,87.66,8.64">(Thorson et al. [2023]</ref> lists several studies of this size), large maximum clique sizes k ≥ 30 are not uncommon. In contrast, a Bethe cluster graph would have maximum cluster size k * = 3, so that (k/k * ) 3 ≥ 10 3 would provide a large computational gain for loopy BP to be considered.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.2">Approximation quality with loopy BP</head><p>We simulated data on a complex graph (40 tips, 361 hybrids) <ref type="bibr" coords="18,314.09,625.19,107.73,8.64">[Müller et al., 2022, Fig. 1a</ref>] and a simpler graph (12 tips, 12 hybrids) <ref type="bibr" coords="18,120.06,636.10,168.46,8.64">[Lipson et al., 2020, Extended Data Fig. 4</ref>], then compared estimates from exact and loopy BP. For both networks, edges of length 0 were assigned the minimum non-zero edge length after suppressing any non-root degree-2 nodes. Trait values x = (x 1 , . . . , x n ) at the tips were simulated from a BM with rate σ 2 = 1 and x ρ = 0 at the root. Figure <ref type="figure" coords="18,101.23,668.83,5.08,8.64" target="#fig_7">7</ref> shows the exact and approximate log-likelihood and conditional mean and variance of x ρ assuming a BM with rate σ 2 = 1 but improper prior x ρ ∼ N (0, ∞), using a greedy minimum-fill clique tree U and a cluster graph U * . Using a factor graph, calibration failed for the complex network (SM section C, Fig. <ref type="figure" coords="18,432.00,691.70,8.29,8.64" target="#fig_3">S2</ref>), so we used join-graph structuring to build U * . U can be calibrated in one iteration and the calculated quantities are exact (horizontal lines). In contrast, U * requires multiple passes and gives approximations. Calibration required more iterations on the complex network (h = 361) than on the simpler network (h = 11), as expected. But for both networks, the factored energy (8) approximated the log-likelihood very well. The distribution of the root state x ρ conditional on the data seems more difficult to approximate. The conditional mean was correctly estimated but required more iterations than the log-likelihood approximation on the complex network. The conditional variance was severely overestimated on the complex network and very slightly overestimated on the simpler network. As desired, the average computing time per belief update was lower on U * , although modestly so due to the clique tree U having many small clusters of size similar to those in U * (Fig. <ref type="figure" coords="19,151.89,140.93,8.16,8.64" target="#fig_11">S3</ref>). iterations. Each iteration consists of two passes through each spanning tree in a minimal set that jointly covers U * . In each plot, the two curves correspond to two different regularizations of initial beliefs (SM section E, dotted: algorithm R1, solid: algorithm R2).</p><p>6 Leveraging BP for efficient parameter inference</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">BP for fast likelihood computation</head><p>In some particularly simple models, such as the BM on a tree, fast algorithms such as <ref type="bibr" coords="19,406.14,588.04,84.42,8.64">IC Felsenstein [1985]</ref> or phylolm <ref type="bibr" coords="19,72.00,598.94,75.82,8.64" target="#b65">Ho and Ané [2014]</ref> can directly calculate the best-fitting parameters that maximize the restricted likelihood (REML), in a single tree traversal avoiding numerical optimization. For more general models, such closed-form estimates are not available. One product of BP is the likelihood of any fixed set of model parameters. BP can hence be simply used as a fast algorithm for likelihood computation, which can then be exploited by any statistical estimation technique, in a Bayesian or frequentist framework. Most of the tools cited in section 2.3 use either direct numerical optimization of the likelihood <ref type="bibr" coords="19,115.82,653.49,75.43,8.64" target="#b95">Mitov et al. [2019]</ref>, <ref type="bibr" coords="19,198.18,653.49,77.64,8.64" target="#b26">Boyko et al. [2023]</ref>, <ref type="bibr" coords="19,282.76,653.49,93.05,8.64" target="#b12">Bartoszek et al. [2023]</ref> or sampling techniques such as Markov Chain Monte Carlo (MCMC) <ref type="bibr" coords="19,191.55,664.40,73.41,8.64" target="#b106">Pybus et al. [2012]</ref>, FitzJohn <ref type="bibr" coords="19,308.41,664.40,26.56,8.64">[2012]</ref> for parameter inference.</p><p>BP also outputs the trait distribution at internal, unobserved nodes conditioned on the observed data at the tips. In addition to providing a tool for efficient ancestral state reconstruction, these conditional means and variances can be used for parameter inference, with approaches based on latent variable models such as Expectation Maximization (EM) <ref type="bibr" coords="19,72.00,713.51,86.42,8.64" target="#b14">Bastide et al. [2018a]</ref>, or Gibbs sampling schemes <ref type="bibr" coords="19,281.96,713.51,75.17,8.64" target="#b34">Cybis et al. [2015]</ref>. Although not currently used in the field of evolutionary biology to our knowledge, approaches based on approximate EM algorithms <ref type="bibr" coords="20,440.87,75.48,81.73,8.64" target="#b64">Heskes et al. [2003]</ref> and relying on loopy BP could also be used.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">BP for fast gradient computation</head><p>As we show below, the conditional means and variances at ancestral nodes can be used to efficiently compute the gradient of the likelihood <ref type="bibr" coords="20,172.01,141.74,103.53,8.64" target="#b116">Salakhutdinov et al. [2003]</ref>. The gradient of the likelihood can help speed up inference in many different statistical frameworks <ref type="bibr" coords="20,194.93,152.65,53.11,8.64" target="#b9">Barber [2012]</ref>. In a phylogenetic context, gradients have been used to improve maximum likelihood estimation <ref type="bibr" coords="20,157.34,163.56,55.04,8.64" target="#b73">Ji et al. [2020]</ref>, Bayesian estimation through Hamiltonian Monte Carlo (HMC) approaches <ref type="bibr" coords="20,515.01,163.56,25.00,8.64;20,72.00,174.47,48.10,8.64" target="#b144">Zhang et al. [2021]</ref>, <ref type="bibr" coords="20,127.09,174.47,76.25,8.64" target="#b44">Fisher et al. [2021]</ref>, <ref type="bibr" coords="20,210.31,174.47,81.34,8.64" target="#b16">Bastide et al. [2021]</ref>, or variational Bayes approximations <ref type="bibr" coords="20,449.42,174.47,90.57,8.64;20,72.00,185.38,25.40,8.64" target="#b46">Fourment and Darling [2019]</ref>. Although automatic differentiation can be used on trees for some models <ref type="bibr" coords="20,412.58,185.38,96.67,8.64" target="#b130">Swanepoel et al. [2022]</ref>, direct computations of the gradient using BP-like algorithms have been shown to be more efficient in some contexts <ref type="bibr" coords="20,502.18,196.29,37.81,8.64;20,72.00,207.19,47.99,8.64" target="#b47">Fourment et al. [2023]</ref>. After recalling Fisher's identity to calculate gradients after BP calibration, we illustrate its use on the BM model (univariate or multivariate) where it allows for the derivation of a new analytical formula for the REML parameter estimates.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.1">Gradient Computation with Fisher's Identity</head><p>In a phylogenetic context, latent variables are usually internal nodes, while observed variables are leaves. We write Y = {X v,j : trait j observed at v ∈ V } the set of observed variables. Fisher's identity provides a way to link the gradient of the log-likelihood of the data LL(θ) = log p θ (Y ) at parameter θ, with the distribution of all the variables conditional on the observations Y . We refer to <ref type="bibr" coords="20,297.72,303.50,117.63,8.64">[Cappé et al., 2005, chap. 10]</ref> or <ref type="bibr" coords="20,428.65,303.50,97.41,8.64">[Barber, 2012, chap. 11]</ref> for general introductions on Markov models with latent variables. Under broad assumptions, Fisher's identity states (see Proposition 10.1.6 in <ref type="bibr" coords="20,158.08,325.31,74.70,8.64" target="#b29">Cappé et al. [2005]</ref>, or Section 11.6 in <ref type="bibr" coords="20,312.76,325.31,54.08,8.64" target="#b9">Barber [2012]</ref>):</p><formula xml:id="formula_41" coords="20,175.87,342.89,261.46,11.15">∇ θ ′ [log p θ ′ (Y )]| θ ′ =θ = E θ [ ∇ θ ′ [log p θ ′ (X v ; v ∈ V )]| θ ′ =θ | Y ] ,</formula><p>where</p><formula xml:id="formula_42" coords="20,99.45,359.20,61.87,12.72">∇ θ ′ [f (θ ′ )]| θ ′ =θ</formula><p>denotes the gradient of f with respect to the generic parameters θ ′ and evaluated at θ ′ = θ, and</p><formula xml:id="formula_43" coords="20,72.00,371.68,40.49,9.65">E θ [ • | Y ]</formula><p>the expectation conditional on the observed data under the model parametrized by θ, which is precisely where the output from BP can be used. Plugging in the factor decomposition from the graphical model ( <ref type="formula" coords="20,487.20,382.91,3.87,8.64" target="#formula_12">4</ref>) we get:</p><formula xml:id="formula_44" coords="20,145.63,401.12,395.04,22.13">∇ θ ′ [log p θ ′ (Y )]| θ ′ =θ = v∈V E θ [ ∇ θ ′ [log ϕ v (X v |X u , θ ′ ; u ∈ pa(v))]| θ ′ =θ | Y ] .<label>(9)</label></formula><p>While ( <ref type="formula" coords="20,102.11,431.71,3.87,8.64" target="#formula_44">9</ref>) applies to the full vector of all model parameters, it can also be applied to take the gradient with respect to a single parameter θ of interest, keeping the other parameters fixed. For instance, we can focus on one rate matrix Σ of a BM model, or one primary optimum of an OU model. Special care needs to be taken for gradients with respect to structured matrices, such as variance matrices that need to be symmetric (see e.g. <ref type="bibr" coords="20,392.78,464.44,78.65,8.64" target="#b16">Bastide et al. [2021]</ref>) or with a sparse inverse under structural equation modeling for high dimentional traits <ref type="bibr" coords="20,351.76,475.35,126.76,8.64" target="#b133">Thorson and van der Bijl [2023]</ref>.</p><p>For models where the conditional expectation of the factor in (9) has a simple form, this formula is the key to an efficient gradient computation. In particular, for discrete traits as in Example 2, the expectation becomes a sum of a manageable number of terms, local to a cluster, weighted by the normalized cluster belief after calibration <ref type="bibr" coords="20,494.88,513.55,45.12,8.64;20,72.00,524.46,90.35,8.64">[Koller and Friedman, 2009, ch. 19</ref>].</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.2">Gradient computation for linear Gaussian models</head><p>For linear Gaussian models (2), log-factors can be written as quadratic forms (6), so their derivatives have analytical formulas (see SM section D). The conditional expectation in ( <ref type="formula" coords="20,320.18,577.13,3.87,8.64" target="#formula_44">9</ref>) then only depends on the joint first and second order moments of the variables (X v , X pa(v) ) in a cluster, which are known as soon as the beliefs are calibrated. When the graph is a tree, <ref type="bibr" coords="20,136.40,598.94,83.84,8.64" target="#b16">Bastide et al. [2021]</ref> exploited this formula to derive gradients in the general linear Gaussian case. However, they did not use the complete factor decomposition (4), but instead an ad-hoc decomposition that only works when the graph is a (binary) tree, and exploits the split partitions defined by the tree. In contrast, the present approach gives a recipe for the efficient gradient computation of any linear Gaussian model on any network, as soon as beliefs are calibrated.</p><p>In the special case where the process is a homogeneous BM (univariate or multivariate) on a network with a weightedaverage merging rule (3), a constant rate Σ, no missing data at the tips, and, if present, within-species variation that is proportional to Σ, then the gradient with respect to Σ takes a particularly simple form. Setting this gradient to zero, we find an analytical formula for the REML estimate of Σ and for the ML estimate of the ancestral mean µ ρ (SM section D.3). In a phylogenetic regression setting, a similar formula can be found for the ML estimate of coefficients (SM section D.4). Efficient algorithms such as IC and phylolm already exist to compute these quantities on a tree, in a single traversal. Here, our formulas need two traversals but remain linear in the number of tips, and because they rely on a general BP formulation, they apply to networks with reticulations. Fisher's identity and BP hence offer a general method for gradient computation, and could lead to analytical formulas for other simple models. Such efficient formulas could alleviate numerical instabilities observed in software such as mvSLOUCH, which experienced a significant failure rate for the BM on trees with a large number of traits <ref type="bibr" coords="21,285.42,119.11,89.09,8.64" target="#b13">Bartoszek et al. [2024]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.3">Hessian computation with Louis's identity</head><p>Using similar techniques, the Hessian of the log-likelihood with respect to the parameters can also be obtained as a conditional expectation of the Hessian of the complete log-likelihood:</p><formula xml:id="formula_45" coords="21,91.46,194.07,438.58,36.00">∇ 2 θ ′ [log p θ ′ (Y )] + ∇ θ ′ [log p θ ′ (Y )] [∇ θ ′ [log p θ ′ (Y )]] ⊤ θ ′ =θ = E θ ∇ 2 θ ′ [log p θ ′ (X v ; v ∈ V )] + ∇ θ ′ [log p θ ′ (X v ; v ∈ V )] [∇ θ ′ [log p θ ′ (X v ; v ∈ V )]] ⊤ | θ ′ =θ Y .</formula><p>This so-called Louis identity <ref type="bibr" coords="21,193.91,241.46,80.22,8.64" target="#b29">Cappé et al. [2005]</ref> also simplifies under the factor decomposition (4), and leads to tractable formulas in simple Gaussian or discrete cases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.3">BP for direct Bayesian parameter inference</head><p>Likelihood or gradient-based approaches require careful analytical computations to get exact formulas in any new model within the class of linear Gaussian graphical models, depending on the parameters of interest <ref type="bibr" coords="21,487.93,308.34,53.81,8.64;21,72.00,319.25,24.93,8.64" target="#b16">Bastide et al. [2021]</ref>. One way to alleviate this problem is to use a Bayesian framework, and expand the graphical model to include both the phylogenetic network and the evolutionary parameters, which are seen as random variables themselves, as e.g., in <ref type="bibr" coords="21,101.52,341.07,75.56,8.64" target="#b66">Höhna et al. [2014]</ref>. Then, inferring parameters amounts to learning their conditional distribution in this larger graphical model. In this setting, the output of interest from BP is not the likelihood but the distribution of random variables (evolutionary parameters primarily) conditional on the observed data.</p><p>Exact computation may not be possible in this extended graphical model, because it is typically not linear Gaussian and the graph's treewidth can be much larger than that of the phylogenetic network, when one parameter (e.g. the evolutionary rate) affects multiple node families. Therefore, approximations may need to be used. For example, "black box" optimization techniques rely on variational approaches to reach a tractable approximation of the posterior distribution of model parameters <ref type="bibr" coords="21,201.15,422.91,89.37,8.64" target="#b109">Ranganath et al. [2014]</ref>. The conditional distribution of unobserved variables, provided by BP, facilitates the noisy approximation of the variational gradient that can be used to speed up the optimization of the variational Bayes approximation.</p><p>7 Challenges and Extensions</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.1">Degeneracy</head><p>While our implementation provides a proof-of-concept, various technical challenges still need to be solved. Much of the literature on BP focuses on factor graphs, which failed to converge for one of our example phylogenetic networks. More work is needed to better understand the convergence and accuracy of alternative cluster graphs, and on other choices that can substantially affect loopy BP's efficiency, such as scheduling. Below, we focus on implementation challenges due to degeneracies.</p><p>For the message μi→j to be well-defined in step 1 of Gaussian BP, the belief of the sending cluster must have a precision matrix K in ( <ref type="formula" coords="21,127.12,588.04,3.87,8.64" target="#formula_24">6</ref>) with a full-rank submatrix with respect to the variables to be integrated out (K I in Algorithm 2). This condition can fail under realistic phylogenetic models, due to two different types of degeneracy.</p><p>The first type arises from deterministic factors: when V v = 0 in (2) and X v is determined by the states at parent nodes X pa(v) without noise, e.g. when all of v's parent branches have length 0 in standard phylogenetic models. This is expected at hybridization events when both parents have sampled descendants in the phylogeny, because the parents and hybrid need to be contemporary of one another. This situation is also common in admixture graphs <ref type="bibr" coords="21,465.81,648.06,74.18,8.64">Maier et al. [2023]</ref> due to a lack of identifiability of hybrid edge lengths from f statistics, leading to a "zipped-up" estimated network in which the estimable composite length parameter is assigned to the hybrid's child edge <ref type="bibr" coords="21,435.20,669.88,77.22,8.64">Xu and Ané [2023]</ref>. With this degeneracy, X v has infinite precision given its parents, that is, K has some infinite values. The complications are technical, but not numerical. For example, one can use a generalized canonical form that includes a Dirac distribution to capture the deterministic equation of X v given X pa(v) from (2). Then BP operations need to be extended to these generalized canonical forms, as done in <ref type="bibr" coords="21,228.82,713.51,90.47,8.64" target="#b117">Schoeman et al. [2022]</ref> (illustrated in SM section F). One could also modify the network by contracting internal tree edges of length 0. At hybrid nodes, adding a small variance to V v would be an approximate yet biologically realistic approach.</p><p>The second type of degeneracy arises when the precision submatrix K I is finite but not of full rank. In phylogenetic models, this is frequent at initialization (5). For example, consider a cluster of 3 nodes: a hybrid v and its 2 parents. By (7) we see that rank(K v ) ≤ p. So at initialization with belief ϕ v , K I is degenerate if we seek to integrate out |I| = 2 nodes, which would occur if the cluster is adjacent to a sepset containining only one parent of v. This situation is typical of factor graphs. Initial beliefs would also be degenerate with K = 0 for any cluster that is not assigned any factor by ( <ref type="formula" coords="22,75.21,157.32,3.54,8.64">5</ref>). This may occur if there are more clusters than node families, or if the graph has nested redundant clusters (e.g. from join-graph structuring). In some cases, a schedule may avoid these degeneracies, guaranteeing a well-defined message at each BP update. On a clique tree, a schedule based on a postorder traversal has this guarantee, provided that all p traits are observed at all leaves or that trait j at node v is removed from scope if it is unobserved at all its descendants. But generally, it is unclear how to find such a schedule. Another approach is to simply skip a BP update if its message is ill-defined, though there is no guarantee that the sending cluster will eventually have a well-behaved belief to pass the message later. A robust option is to regularize cluster beliefs, right after initialization (5) or during BP, by increasing some diagonal elements of K to make K I of full rank. To maintain the probability model, this cluster belief regularization is balanced by a similar modification to a corresponding sepset. SM section E describes two such approaches that appear to work well in practice, although theoretical guarantees have not been established.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.2">Loopy BP is promising for discrete traits</head><p>We focused on Gaussian models in this paper, for which the 'lazy' matrix approach is polynomial. For discrete trait models, the computational gains from loopy BP can be much greater, because alternative approaches are not polynomial on general networks. For a trait with c states (c = 2 for a binary trait as in Example 2), passing a message has complexity</p><formula xml:id="formula_46" coords="22,72.00,342.03,25.17,10.31">O(c k )</formula><p>where k is the sending cluster size. Thus, cluster graphs with small clusters can bring exponential computational gains. Even exact BP can bring significant computational gains to existing approaches that rely on other means to reduce complexity. For example, the model without ILS used in <ref type="bibr" coords="22,336.84,365.74,90.98,8.64" target="#b89">Lutteropp et al. [2022]</ref>, Allen-Savietta [2020] is a mixture model, so the network likelihood can be calculated as a weighted average of tree likelihoods for which exact BP takes linear time. This approach scales exponentially with h because there are typically O(2 h ) trees displayed in a network. In contrast, the complexity of BP on a clique tree of maximum clique size k is O(nc k ), thus parametrized by the treewidth t of the moralized network instead of h (t = k − 1 for an optimal clique tree). Given our empirical evidence that t grows more slowly than h or the network's level ℓ in biologically-realistic networks (Fig. <ref type="figure" coords="22,491.08,421.32,3.60,8.64" target="#fig_6">6</ref>), exact BP could achieve significant computational gains and loopy BP substantially more.</p><p>A BP approach is already used in momi2 <ref type="bibr" coords="22,241.67,448.62,79.14,8.64" target="#b77">Kamm et al. [2020]</ref>, who use a clique tree built from a node ordering by age from youngest to oldest, to get conditional likelihoods of the derived allele count under a Moran model (without mutation). The mutation-with-ILS model in SnappNet can be also reframed as a graphical model on a graph expanded from the phylogenetic network (as shown in Example 3 and SM section A). Accordingly, the BP-like algorithm in <ref type="bibr" coords="22,72.00,492.25,80.65,8.64" target="#b107">Rabier et al. [2021]</ref> has complexity controlled by the network's scanwidth, a parameter introduced by <ref type="bibr" coords="22,495.22,492.25,46.52,8.64;22,72.00,503.16,24.40,8.64" target="#b18">Berry et al. [2020]</ref>. Using regular BP on more optimal clique trees and loopy BP on cluster graphs may help speed up computations even more.</p><p>Also related is the algorithm in <ref type="bibr" coords="22,196.25,530.46,121.31,8.64">Scornavacca and Weller [2022]</ref>, who use a clique tree to solve a parsimony problem. In this non-probabilistic setting, it is unclear how cluster graphs could be leveraged to speed up algorithms as they do in loopy BP.</p><p>To deal with computational intractability, the most widely-used probabilistic methods to infer networks from DNA sequences are based on composite likelihoods Solís-Lemus and <ref type="bibr" coords="22,337.50,592.70,45.54,8.64" target="#b122">Ané [2016]</ref>, <ref type="bibr" coords="22,390.49,592.70,97.15,8.64" target="#b143">Yu and Nakhleh [2015]</ref> or summary statistics like f statistics <ref type="bibr" coords="22,173.18,603.61,74.43,8.64">Maier et al. [2023]</ref>, <ref type="bibr" coords="22,254.37,603.61,81.22,8.64" target="#b101">Nielsen et al. [2023]</ref>, leading to a lack of identifiability for parts of the network topology and some of its parameters Solís-Lemus and <ref type="bibr" coords="22,328.20,614.52,44.74,8.64" target="#b122">Ané [2016]</ref>, <ref type="bibr" coords="22,379.67,614.52,53.20,8.64" target="#b8">Baños [2019]</ref>, <ref type="bibr" coords="22,439.60,614.52,76.78,8.64">Xu and Ané [2023]</ref>, <ref type="bibr" coords="22,523.10,614.52,16.90,8.64;22,72.00,625.43,45.83,8.64" target="#b5">Ané et al. [2024]</ref>, <ref type="bibr" coords="22,124.35,625.43,77.56,8.64" target="#b5">Allman et al. [2024]</ref>, <ref type="bibr" coords="22,208.43,625.43,77.56,8.64" target="#b5">Rhodes et al. [2024]</ref>. These identifiability issues should be alleviated if using the full data becomes tractable thanks to exact or loopy BP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SUPPLEMENTARY MATERIAL</head><p>A Recasting SnappNet as BP</p><p>SnappNet <ref type="bibr" coords="31,116.77,212.75,82.71,8.64" target="#b107">[Rabier et al., 2021]</ref> extends the model described in SNAPP <ref type="bibr" coords="31,361.64,212.75,83.28,8.64" target="#b27">[Bryant et al., 2012]</ref> to binary phylogenetic networks with reticulations. In the main text, their model is considered along a 2-taxon phylogenetic tree and Fig. <ref type="figure" coords="31,529.97,223.66,10.02,8.64">3b</ref> shows that the graphical model has a more complicated graph. The same applies in the presence of reticulations (see Fig. <ref type="figure" coords="31,90.90,245.48,10.73,8.64" target="#fig_2">S1</ref> for a 2-taxon phylogeny with 1 reticulation). In addition to the coalescent and speciation factors described in Example 3, we also need to describe hybridization factors. Consider an edge e that is the child of a hybrid node, whose parent hybrid edges p 1 and p 2 have inheritance probabilities γ 1 and γ 2 . The hybridization factors for the total allele count ϕ np 1 = P(n p1 | n e ) and ϕ np 2 = 1 {ne−np 1 } (n p2 ) describe a binomial distribution for each n pi (i = 1, 2)</p><p>with n p1 + n p1 = n e , because each of the n e individuals has a γ i chance of being assigned to edge p i (i = 1, 2). The hybridization factor for the red allele count is simply ϕ re = 1 {rp 1 +rp 2 } (r e ) because r e = r p1 + r p2 .</p><p>(</p><p>5 ρ ρ 4 4 5 5 3 3 4 4 G is a DAG with two roots (1 and 2) and two leaves (1 and 2). (c) Clique tree U for G, with clusters C j in grey and sepsets S i,j in orange. To reduce clutter and simplify notations in this figure, n e and r e are both abbreviated as e and are distinguished by colours (n's in black, r's in red). Similarly, n e and r e are both denoted as e and distinguished by colours.</p><formula xml:id="formula_48" coords="31,132.58,410.06,346.76,144.15">1 1 3 3 2 2 1 1 2 2 (c) 5, 3, 5, 3 5, 3, 5, 3 C3 1, 5, 3 1, 5, 3 C2 1, 1 1, 1 C1 5, 4, ρ 5, 4, ρ C7 5, 4, 4 5, 4, 4 C6 5, 3, 2, 4 5, 3, 2, 4 C5 2, 2 2, 2<label>C4</label></formula><p>We show that applying the SnappNet algorithm to the network in Fig. <ref type="figure" coords="31,363.10,656.04,17.61,8.64" target="#fig_2">S1(a</ref>) is equivalent to BP on the clique tree in Fig. <ref type="figure" coords="31,102.97,666.94,16.37,8.64" target="#fig_2">S1(c</ref>). To start, we assign the initial beliefs ϕ n 1 ϕ r1 to cluster C 1 , ϕ n 2 ϕ r2 to C 4 , ϕ nρ ϕ rρ ϕ r 5 ϕ r 4 to C 7 ; ϕ n 5 ϕ n 3 ϕ r5 ϕ r3 to C 3 , ϕ n4 ϕ r 3 ϕ r 2 to C 5 , and ϕ n 4 ϕ r4 to C 6 . Finally, all hybridization factors ϕ n5 ϕ n3 ϕ r 1 are assigned to C 2 . Each sepset is assigned an initial belief of 1. The total allele counts n 1 , n 2 (fixed by design) and the observed red allele counts r 1 , r 2 at the tips are absorbed as evidence into the mutation factors ϕ r1 , ϕ r2 and coalescent factors ϕ n 1 , ϕ n 2 for the terminal edges. This is denoted as ϕ[•], with [•] containing the evidence absorbed. BP messages are then passed on the clique tree from C 1 and C 4 (considered as leaves) towards C 7 (considered as root) as follows:</p><formula xml:id="formula_49" coords="32,162.73,92.92,289.64,190.63">μ1→2 = ϕ n 1 [n 1 ]ϕ r1 [n 1 , r 1 ] = F 1 (S 1,2 ) μ2→3 = C2\S2,3 ϕ n5 ϕ n3 ϕ r 1 • μ1→2 = F 5,3 (S 2,3 ) μ3→5 = C3\S3,5 ϕ n 5 ϕ n 3 ϕ r5 ϕ r3 • μ2→3 = F 5,3 (S 3,5 ) μ4→5 = ϕ n 2 [n 2 ]ϕ r2 [n 2 , r 2 ] = F 2 (S 4,5 ) μ5→6 = C5\S5,6 ϕ n4 ϕ r 3 ϕ r 2 • μ3→5 μ4→5 = F 5,4 (S 5,6 ) μ6→7 = C6\S6,7 ϕ n 4 ϕ r4 • μ5→6 = F 5,4 (S 6,7 ) β final 7 = ϕ nρ ϕ rρ ϕ r 5 ϕ r 4 • μ6→7 C7 β final 7 = C7\S6,7 ϕ rρ S6,7 ϕ nρ ϕ r 5 ϕ r 4 • μ6→7 = C7\S6,7 ϕ rρ F ρ (C 7 \ S 6,7 )</formula><p>where the the F z functions are defined in <ref type="bibr" coords="32,236.87,293.45,77.08,8.64" target="#b107">Rabier et al. [2021]</ref> for different population interface sets z (each population interface is the top or bottom of some branch, e.g. ρ, ρ). That this correspondence does not always hold (e.g. suppose the messages were sent towards C 1 instead), highlights that BP is more general. The F z s recursively compose the likelihood according to rules described in <ref type="bibr" coords="32,239.84,326.18,75.92,8.64" target="#b107">Rabier et al. [2021]</ref>, and can be expressed at the top-level as nρ,rρ ϕ rρ F ρ . This is precisely the quantity from marginalizing β final 7 above, the final belief of C 7 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B Bounding the moralized network's treewidth</head><p>Proof of Proposition 1. Using the notations in the main text, let N be as a binary phylogenetic network with h hybrid nodes, level ℓ, no parallel edges and no degree-2 nodes other than the root. Let t be the treewidth of the moralized graph N m obtained from N .</p><p>(A0) is well-known: t = 1 exactly when N is a tree. If ℓ = 1 then N has at least one non-trivial blob and every such blob is a cycle. So N m has outerplanar blobs and t = 2 <ref type="bibr" coords="32,295.81,442.33,48.98,8.64" target="#b20">Biedl [2015]</ref>, proving (A1). Now consider hybrid nodes v 1 and v 2 as in (A2). Let u 3 , u 4 be the parents of v 2 such that u 3 is not a descendant of u 1 or u 2 (see Fig. <ref type="figure" coords="32,131.46,469.63,3.66,8.64" target="#fig_5">5</ref>, in which u 4 = v 1 ). Then there must be a path p 4 from v 1 to v 2 through u 4 since v 2 is a descendant of v 1 . For a directed path p, let p u denote the corresponding undirected path. Let w be a strict common ancestor of u 1 and of u 2 such that there exist disjoint paths p 1 , p 2 , with p i from w to u i . Such w exists because u 1 has a parent other than u 2 and vice versa. Let C be the cycle in N m formed by concatenating p u 1 , p u 2 and the moral edge {u 1 , u 2 }. Next, pick any path p from the root of N to u 3 . If p does not share any node with C, then we can find a common ancestor w of w and u 3 , and paths p w and p 3 from w to w and u 3 respectively, that do not intersect p 1 nor p 2 . Then we can see that N m contains the complete graph on {w, u 1 , u 2 , v 1 } as a graph minor, by contracting p u w + p u 3 + {u 3 , v 2 } + p u 4 into a single edge between w and v 1 . If instead p intersects C, then let w ′ be the lowest node at which p and C intersect. Then w ′ ̸ = u 1 because otherwise u 3 would be its descendant. Similarly w ′ ̸ = u 2 . Let p 3 denote the subpath of p from w ′ to u 3 . Then N m contains the complete graph on {w ′ , u 1 , u 2 , v 1 } as a graph minor, as C can be contracted into the cycle {w ′ , u 1 , u 2 } and p u 3 + {u 3 , v 2 } + p u 4 can be contracted into an edge {w ′ , v 1 }. In both cases, N m contains the complete graph on 4 nodes as a graph minor, therefore its treewidth is t ≥ 3 <ref type="bibr" coords="32,374.50,589.63,72.68,8.64" target="#b23">Bodlaender [1998]</ref>. Also, in both cases v 1 and v 2 are in a common undirected cycle in N , so in the same blob and ℓ ≥ 2. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C Approximation quality with loopy BP</head><formula xml:id="formula_50" coords="33,120.99,304.38,82.99,291.93">E(X ρ |data) E(X ρ |data) Δ = E(X ρ |data) − 15.7</formula><p>Var(X ρ |data)</p><p>Var(X ρ |data) as in Fig. <ref type="figure" coords="33,112.21,644.79,5.08,8.64" target="#fig_7">7</ref> (black), or a factor graph (purple). For both, initial beliefs are regularized using algorithm R4. The true values, obtained using a clique tree, are shown in red. The plots in the first row are for the simpler phylogenetic network, and the plots in the other rows are for the complex phylogeny. The last row shows the difference ∆ between the loopy BP estimate and the true value, displayed on the log-modulus scale using the transformation sign(∆) log(1 + |∆|). For the simpler phylogenetic network, convergence speed and accuracy are similar between U * and the factor graph, which is unsurprising given their similarly small cluster sizes (≤ 3). For the complex network, the factor graph did not reach calibration as its iterates diverged for the conditional mean and factored energy. The time for 100 iterations (defined in Fig. <ref type="figure" coords="34,484.22,172.21,4.23,8.64" target="#fig_7">7</ref>) was benchmarked over 20 replicates on a MacBook Pro M2 2022, and divided by the number of messages per 100 iterations to obtain an estimate of the mean time per belief update (vertical axis).</p><formula xml:id="formula_51" coords="33,260.91,584.84,99.24,11.47">Δ = Var(X ρ |data) − 1425.7</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D Gradient and parameter estimates under the BM D.1 The homogeneous BM model</head><p>We consider here the simple case of a multivariate BM of dimension p on a network: with V v = ℓ(e)Σ at a tree node v with parent edge e. At a hybrid node, we assume a weighted average merging rule as in (3.2) with a possible extra hybrid variance proportional to Σ: V h = ℓ(h)Σ for some scalar ℓ(h) ≥ 0. To simplify equations, we define ℓ(v) = 0 if v is a tree node. Then for each node v ∈ V the Gaussian linear model (3.1) simplifies to:</p><formula xml:id="formula_52" coords="34,213.46,403.22,327.21,34.15">X v X pa(v) ∼ N   u∈pa(v) γ uv X u ; ℓ(v)Σ   , (SM-1)</formula><p>with γ uv the inheritance probability associated with the branch going from u to v, and</p><formula xml:id="formula_53" coords="34,233.87,462.34,88.55,20.53">ℓ(v) = ℓ(v) + u∈pa(v)</formula><p>γ 2 uv ℓ(e u→v ) .</p><p>At the root, we assume a prior variance proportional to Σ: X ρ ∼ N (µ ρ ; ℓ(ρ)Σ) which may be improper (and degenerate) with infinite variance ℓ(ρ) = ∞ or ℓ(ρ) = 0.</p><p>This model can also accommodate within-species variation, by considering each individual as one leaf in the phylogeny, whose parent node corresponds to the species to which the individual belongs. The edge e from the species to the individual is assigned length ℓ(e) = w and variance proportional to Σ conditional on the parent node (species average): ℓ(e)Σ. This model, then, assumes equal phenotypic (within species) correlation and evolutionary (between species) correlation between the p traits. The derivations below assume a fixed variance ratio w, to be estimated separately.</p><p>All results in this section use this homogeneous BM model, and make the following assumption. Assumption 1. At each leaf, the trait vector (of length p) is either fully observed or fully missing, i.e. there are no partially observed nodes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.2 Belief Propagation</head><p>Gaussian BP Algorithm 2 can be applied in the simple BM case to get the calibrated beliefs, with two traversals of a clique tree (or convergence with infinitely many traversals of a cluster graph). The following result states that the conditional moments of all the nodes obtained from this calibration have a very special form. We will use it to derive analytical formulas for the maximum likelihood estimators of the parameters of the BM. Proposition 2. Assume the homogeneous BM (SM-1) and Assumption 1. The expectation of the trait at each node conditional on the observed data does not depend on the assumed Σ parameter. In addition, the conditional variance matrix and the conditional covariance matrix of a node trait and any of its parent's is proportional to Σ.</p><p>To prove this proposition, we need the following technical lemma, which we prove later. Lemma 3. Consider a homogeneous p-dimensional BM on a network and Assumption 1. At each iteration of the calibration, each cluster and sepset of s nodes has a belief whose canonical parameters are of the form:</p><formula xml:id="formula_54" coords="35,130.09,115.35,410.58,40.52">K = J ⊗ Σ −1 and h = (I s ⊗ Σ −1 )    m 1 . . . m s    = (I s ⊗ Σ −1 )vec(M) = vec(Σ −1 M) (SM-2)</formula><p>for some s × s symmetric matrix J and vectors m i (i = 1 . . . s) of size p, where M is the p × s matrix with m i on column i, and where vec denotes the vectorization operation formed by stacking columns. Further, M depends linearly on the data Y (from stacking the trait vectors at the tips) and µ ρ , separately across traits, in the sense that</p><formula xml:id="formula_55" coords="35,260.05,203.02,280.62,19.65">m i = (w i ⊗ I p ) µ ρ Y . (SM-3)</formula><p>for some 1 × (n + 1) vector of weights w i . J and vectors w i (i = 1, . . . , s) are independent of the variance rate Σ, the data Y and µ ρ . They only depend on the network, the chosen cluster graph, the chosen cluster or sepset in this graph, and the iteration number.</p><p>Proof of Proposition 2. First note that, for any belief with form (SM-2), the mean of the associated normalized Gaussian distribution can be expressed as follows. Let the vector µ j of size p be the mean for the node indexed j. Then</p><formula xml:id="formula_56" coords="35,152.29,303.74,307.42,40.52">   µ 1 . . . µ s    = K −1 h = (J −1 ⊗ I p )    m 1 . . . m s    = (J −1 ⊗ I p )vec(M) = vec(MJ −1 ) .</formula><p>Let E be the p × s matrix of means with µ j on column j. Then the expression above simplifies to</p><formula xml:id="formula_57" coords="35,278.25,367.44,55.50,10.81">E = M J −1 .</formula><p>Assume Lemma 3, from which we re-use notations here. Let C be a cluster, and K, J and M be its matrices from (SM-2). For any node v in C, let k C (v) be the index of v in C's matrices. Then, writing [J −1 ] •k for the k th column vector of J −1 , we get: <ref type="figure" coords="35,526.00,424.18,9.78,8.64" target="#fig_4">-4</ref>) where E v denotes the column of E for node v (i.e. the conditional expectation of its trait), and does not depend on Σ. Assuming that calibration is reached, E v does not depend on the cluster C (or sepset) containing v. Further, note that (SM-4) is exact on any cluster graph at calibration, not simply approximate, because we are using a Gaussian graphical model <ref type="bibr" coords="35,138.96,470.75,107.52,8.64" target="#b140">[Weiss and Freeman, 1999]</ref>.</p><formula xml:id="formula_58" coords="35,214.48,421.83,311.52,12.64">E [ X v | Y ] = µ k C (v) = M[J −1 ] •k C (v) = E v , (SM</formula><p>Similarly, for nodes u, v in C:</p><formula xml:id="formula_59" coords="35,183.34,501.73,245.31,28.78">var [ X v | Y ] = [K −1 ] k C (v)k C (v) = [J −1 ] k C (v)k C (v) Σ, cov [ X v , X u | Y ] = [K −1 ] k C (v)k C (u) = [J −1 ] k C (v)k C (u) Σ.</formula><p>(SM-5) Therefore, their conditional variances and covariances are proportional to Σ.</p><p>In the following, with a slight abuse of notation, for any two nodes u, v in C, we will write</p><formula xml:id="formula_60" coords="35,72.00,558.16,468.44,24.79">[J −1 ] uv = [J −1 ] k C (u)k C (v) and [K −1 ] uv = [K −1 ] k C (u)k C (v)</formula><p>for the submatrices corresponding to the indices for u and v in C.</p><p>Since SM-4 requires inverting J, whose size s depends on the cluster, calculating the conditional means E v has complexity O(s 3 ) typically. As the J and M matrices appearing in (SM-4) and (SM-5) do not depend on Σ by Lemma 3, they can be computed by running BP with any Σ value, and we have the following. Corollary 4. The J and M matrices in Lemma 3, used in (SM-4) and (SM-5), are obtained as a direct output of BP using Σ = I p to calibrate the cluster graph.</p><p>Using (SM-3) in Lemma 3 and the derivation of vectors w i at each BP update, given in the proof below, we obtain the following result. Corollary 5. For each cluster, the weights w i appearing in (SM-3) can be obtained alongside BP for any trait using updates (SM-7) and (SM-8) below, until convergence of all w i weight vectors and J matrices. These quantities can then be used to obtain conditional expectations and conditional (co)variances for any trait using (SM-3), (SM-4) and (SM-5).</p><p>For example, this result implies that obtaining calibrated conditional expectations for a large-dimensional trait can be done without handling large p × p matrices: by first calculating the w i 's and J for each cluster until convergence, and then re-using them repeatedly for each of the p traits separately (without re-calibration).</p><p>Proof of Lemma 3. We now show that the properties stated in Lemma 3 hold for each factor at initialization, and continue to hold after each step of Algorithm 2: belief initialization, evidence absorption, and propagation.</p><p>Factor Initialization. Using the notations from the main text, each factor ϕ v (x v | x pa(v) ) has canonical form over its full scope:</p><formula xml:id="formula_61" coords="36,211.66,169.85,188.68,20.87">ϕ v (x v | x pa(v) ) = C x v x pa(v) ; K v , h v , g v .</formula><p>For any internal node or any leaf v before evidence absorption, we get from (4.4) and (SM-1):</p><formula xml:id="formula_62" coords="36,185.43,207.94,355.23,22.91">K v = J ⊗ Σ −1 and h v = 0, where J = 1 ℓ(v) 1 −γ ⊤ −γ γγ ⊤ (SM-6)</formula><p>and γ ⊤ = (γ uv ; u ∈ pa(v)). Hence all the node family factors have form (SM-2) at initialization and neither J nor any m i = 0 depend on the data. We can initialize w i = 0 for each i in the factor's scope.</p><p>At the root ρ, the formulas above still hold using that pa(ρ) is empty and γ has length 0, for any 0 &lt; ℓ(ρ) &lt; +∞, and also for ℓ(ρ) = +∞ in which case J = [0], independent of the data. For h ρ , we have h ρ = 1 ℓ(ρ) Σ −1 µ ρ , which satisfies (SM-2) with m ρ = µ ρ /ℓ(ρ). m ρ is linear in µ ρ and satisfies (SM-3) with w ρ = ( 1 ℓ(ρ) , 0, . . . , 0) (or simply 0 if ℓ(ρ) = +∞). If ℓ(ρ) = 0, the root factor is not assigned to any cluster at initialization because it is instead handled during evidence absorption below. This is because ℓ(ρ) = 0 implies that X ρ is fixed to the µ ρ value, and this is handled similarly to leaves fixed at their observed values.</p><p>Belief Initialization. Now consider a cluster C that is assigned factors ϕ v for k ≥ 0 nodes {v 1 , . . . , v k }, by (4.2). Before this assignment, the belief for C (and for all sepsets) is set to the constant function equal to 1, which trivially satisfies (SM-2) with J = 0 and every m i = 0, and satisfies (SM-3) with every w i = 0. To assign factor ϕ vj to C, we first extend scope of ϕ vj to the scope of C (re-ordering the rows and columns of K vj and h vj to match that of C). We then multiply C's belief by the extended factor. So we now prove that (SM-2) is preserved by these two operations: extension and multiplication.</p><p>Belief Extension. Consider extending the scope of a belief with parameters (K, h, g) satisfying (SM-2) to include all p traits of an extra (s + 1) th node. Without loss of generality, we assign these extra variables the last p indices. Then the canonical parameters of the extended belief can be written as</p><formula xml:id="formula_63" coords="36,195.69,449.51,222.62,48.78">K = J 0 0 0 ⊗ Σ −1 and h = (I s+1 ⊗ Σ −1 )     m 1 . . . m s 0    </formula><p>and continue to be of form (SM-2). K continues to be independent of Σ and of the data. All m i vectors involved in h continue to be independent of Σ and linear in the data according to (SM-3): with w i unchanged for i ≤ s and w i = 0 for i = s + 1.</p><p>Beliefs Product and Quotient. Next, if (K, h, g) and (K ′ , h ′ , g ′ ) are the parameters of two beliefs on the same scope satisfying Lemma 3, then their product also satisfies Lemma 3 because the canonical form of the product has parameters (K + K ′ , h + h ′ , g + g ′ ), and can be expressed with (SM-2) using J + J ′ and m j + m ′ j . (SM-3) continues to hold using weight vectors w j + w ′ j . Similarly, the ratio of the two beliefs has parameters (K − K ′ , h − h ′ , g − g ′ ) and continues to satisfy Lemma 3.</p><p>Evidence Absorption. Assume that a belief satisfies Lemma 3, and that we want to absorb the evidence from one node u, 1 ≤ u ≤ s. This node u can be a leaf, or the root if ℓ(ρ) = 0. If u = ρ then the data to be absorbed is x u = µ ρ . We need to express the canonical form of the belief as a function of x −u = [x ⊤ 1 , . . . , x ⊤ u−1 , x ⊤ u+1 , . . . , x ⊤ s ] ⊤ only, letting the data x u appear in the canonical parameters. By Assumption 1, x u is of full length p, which maintains the block structure. We have:</p><formula xml:id="formula_64" coords="36,85.95,661.92,444.26,58.60">x ⊤ 1 • • • x ⊤ s (J ⊗ Σ −1 )    x 1 . . . x s    = x ⊤ −u (J −u ⊗ Σ −1 )x −u + 2 t̸ =u x ⊤ u J ut Σ −1 x t + x ⊤ u J uu Σ −1 x u = x ⊤ −u (J −u ⊗ Σ −1 )x −u + 2(J −u,u ⊗ x u ) ⊤ (I s−1 ⊗ Σ −1 )x −u + x ⊤ u J uu Σ −1 x u ,</formula><p>where J −u is the (s − 1) × (s − 1) matrix J without the row and column for u; and J −u,u is the (s − 1) × 1 column vector of J for u without the row entry for u. Likewise:</p><formula xml:id="formula_65" coords="37,161.85,103.80,292.45,40.52">m ⊤ 1 • • • m ⊤ s (I s ⊗ Σ −1 )    x 1 . . . x s    = m ⊤ −u (I s−1 ⊗ Σ −1 )x −u + m ⊤ u Σ −1 x u ,</formula><p>where m −u is similarly defined as x −u , so that the canonical form of the factor satisfies:</p><formula xml:id="formula_66" coords="37,82.50,171.92,446.99,22.31">log C (x −u ; K −u , h −u , g −u ) = − 1 2 x ⊤ −u (J −u ⊗ Σ −1 )x −u + (m −u − J −u,u ⊗ x u ) ⊤ (I s−1 ⊗ Σ −1 )x −u + g −u ,</formula><p>where g −u does not depend on x −u ,</p><formula xml:id="formula_67" coords="37,145.05,218.69,321.90,11.72">K −u = (J −u ⊗ Σ −1 ) and h −u = (I s−1 ⊗ Σ −1 )(m −u − J −u,u ⊗ x u ),</formula><p>have form (SM-2). J −u continues to be independent of Σ and of the data and µ ρ . All m i vectors involved in h −u continue to be independent of Σ and linear in the data -with linear dependence on x u introduced in this step. Namely, (SM-3) holds with weight vector w j updated to:</p><p>w j − J i,u e u where e u = (0, . . . , 0, 1, 0, . . .) (SM-7)</p><p>is the basis (row) vector of R n+1 with coordinate 1 at the position indexing tip u.</p><p>Note that, for a tip v with data on all p traits, we recover (4.4) for the factor associated with the external edge to v, whose scope is reduced to x pa(v) after absorbing the evidence from x v (with s = 2):</p><formula xml:id="formula_68" coords="37,115.25,347.00,381.49,22.31">K v = 1 ℓ(v) Σ −1 , h v = 1 ℓ(v) Σ −1 x v , and g v = − 1 2 log |2πℓ(v)Σ| + 1 ℓ(v) ∥x v ∥ 2 Σ −1 .</formula><p>Propagation. Next, we show that beliefs continue to satisfy Lemma 3 after any propagation step of Algorithm 2. The first propagation step consists of marginalizing a belief, to calculate the message μi→j from cluster i to cluster j. Suppose that a belief with parameters (K, h, g) satisfies (SM-2), and that we marginalize out all traits of one or more nodes in its scope. Let I be the indices corresponding to nodes (or their traits, depending on the context, with some abuse of notation) to be marginalized and S the indices corresponding to the remaining nodes (or their traits). Then, the marginal belief has canonical parameters ( K, h) with:</p><formula xml:id="formula_69" coords="37,72.00,458.24,448.85,109.39">K = K S − K S,I K −1 I K I,S = J S ⊗ Σ −1 − J S,I ⊗ Σ −1 J I −1 ⊗ Σ J I,S ⊗ Σ −1 = J S − J S,I J I −1 J I,S ⊗ Σ −1 = J ⊗ Σ −1 and h = h S − K S,I K −1 I h I = h S − J S,I ⊗ Σ −1 J I −1 ⊗ Σ h I = h S − J S,I J I −1 ⊗ I p h I =    Σ −1 m1 . . . Σ −1 ms   </formula><p>where, for j ∈ S:</p><formula xml:id="formula_70" coords="37,240.23,590.46,133.42,22.37">mj = m j − i∈I J S,I J I −1 ji m i .</formula><p>So (SM-3) holds with updated weights:</p><formula xml:id="formula_71" coords="37,241.98,638.26,298.69,22.37">wj = w j − i∈I J S,I J I −1 ji w i , (SM-8)</formula><p>and the marginalized belief (message) is still of the form (SM-2) and continues to satisfy Lemma 3. The remaining propagation steps consist of dividing the message by the current sepset belief; extending the resulting quotient to the scope of the receiving cluster; and multiplying the receiving cluster's current belief with the extended quotient. Each of these steps was already proved to preserve the properties of Lemma 3, therefore the receiving cluster's new belief still satisfies Lemma 3. The sepset belief does too because it is updated with the message that was passed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.3 Gradient computation and analytical formula for parameter estimates D.3.1 Gradients of factors</head><p>When the factors are linear Gaussian as in (3.1), their derivarive with respect to any vector of parameters θ can be written as:</p><formula xml:id="formula_72" coords="38,81.96,140.62,458.70,48.33">∇ θ log ϕ v (X v |X pa(v) , θ) = ∂ ∂θ [q v X pa(v) + ω v ] ⊤ V −1 v X v − q v X pa(v) − ω v + 1 2 ∂ vech(V −1 v ) ⊤ ∂θ vech V v − (X v − q v X pa(v) − ω v )(X v − q v X pa(v) − ω v ) ⊤ , (SM-9)</formula><p>where vech is the symmetric vectorization operation <ref type="bibr" coords="38,282.71,193.35,119.85,8.64" target="#b90">[Magnus and Neudecker, 1986</ref>]. In the BM case, (3.1) simplifies to (SM-1), so that, for non-root nodes:</p><formula xml:id="formula_73" coords="38,81.96,221.48,448.07,79.29">∇ θ log ϕ v (X v |X pa(v) , θ) = ∂ ∂θ   u∈pa(v) γ uv X p   ⊤ ℓ(v) −1 Σ −1   X v − u∈pa(v) γ uv X p   + 1 2 ∂ vech(ℓ(v) −1 Σ −1 ) ⊤ ∂θ vech   ℓ(v)Σ −   X v − u∈pa(v) γ uv X p     X v − u∈pa(v) γ uv X p   ⊤    ,</formula><p>and, for the root ρ, assuming 0 &lt; ℓ(ρ) &lt; +∞,</p><formula xml:id="formula_74" coords="38,81.96,330.31,448.07,51.30">∇ θ [log ϕ ρ (X ρ |θ)] = ∂ [µ ρ ] ⊤ ∂θ ℓ(ρ) −1 Σ −1 (X ρ − µ ρ ) + 1 2 ∂ vech(ℓ(ρ) −1 Σ −1 ) ⊤ ∂θ vech ℓ(ρ)Σ − (X ρ − µ ρ ) (X ρ − µ ρ ) ⊤ .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.3.2 Estimation of µ ρ</head><p>Note that µ ρ has no impact on the model and needs not be estimated if ℓ(ρ) = ∞ (improper flat prior). We assume here that 0 &lt; ℓ(ρ) &lt; +∞, and will consider the case ℓ(ρ) = 0 later. Only the root factor depends on µ ρ . Taking its gradient with respect to µ ρ , we get:</p><formula xml:id="formula_75" coords="38,212.03,441.95,187.94,11.72">∇ µρ [log ϕ ρ (X ρ |θ)] = ℓ(ρ) −1 Σ −1 (X ρ − µ ρ ) .</formula><p>To apply Fisher's formula (6.1), we take the expectation E θ [ • | Y ] of this gradient conditional on all the data Y :</p><formula xml:id="formula_76" coords="38,102.47,479.46,408.25,18.81">∇ µ ′ ρ [log p θ ′ (Y )] µ ′ ρ =µρ = E θ ∇ µ ′ ρ [log ϕ ρ (X ρ |θ ′ )] µ ′ ρ =µρ Y = ℓ(ρ) −1 Σ −1 (E θ [ X ρ | Y ] − µ ρ ) .</formula><p>Setting this gradient to 0, we get: μρ</p><formula xml:id="formula_77" coords="38,269.78,515.07,270.89,9.65">= E θ [ X ρ | Y ] = E ρ (SM-10)</formula><p>where C is any cluster containing ρ in its scope, and J and M are the matrices in Lemma 3 for its belief. Note that by Lemma 3, this estimate is independent of the assumed Σ used during calibration. This procedure corresponds to maximum likelihood estimation under the assumption that ℓ(ρ) is known. Under this model, µ ρ represents the ancestral state at time ℓ(ρ) prior to the root node ρ, which is typically taken as the most recent common ancestor of the sampled leaves. This is equivalent to considering an extra root edge of length ℓ(ρ) above ρ, whose parent node has ancestral state µ ρ . Then μρ is a maximum likelihood estimate of the ancestral state at ρ, or an approximation thereof if a cluster graph is used instead of a clique tree. Note that, in a Bayesian setting, when fixing ℓ(ρ) to a given value, and fixing µ ρ = 0, this model can be seen as setting a Gaussian prior on the value at the root of the tree. This is the model used e.g. in BEAST <ref type="bibr" coords="38,133.16,616.31,76.51,8.64" target="#b44">[Fisher et al., 2021]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.3.3 Estimation of Σ</head><p>We now take the gradient with respect to the vectorized precision parameter P = vech(Σ −1 ), of length p(p + 1)/2. For v ̸ = ρ, we get:</p><formula xml:id="formula_78" coords="38,82.13,683.14,447.73,37.14">∇ P log ϕ v (X pa(v) |X u , θ) = 1 2 ℓ(v) −1 vech   ℓ(v)Σ −   X v − u∈pa(v) γ uv X u     X v − u∈pa(v) γ uv X u   ⊤   </formula><p>and, for the root ρ:</p><formula xml:id="formula_79" coords="39,158.24,90.81,295.52,22.31">∇ P [log ϕ ρ (X ρ |θ)] = 1 2 ℓ(ρ) −1 vech ℓ(ρ)Σ − (X ρ − µ ρ ) (X ρ − µ ρ ) ⊤ .</formula><p>Applying again Fisher's formula (6.1), we get:</p><formula xml:id="formula_80" coords="39,71.64,134.36,348.05,46.97">∇ P ′ [log p θ ′ (Y )]| P ′ =P = 1 2 v∈V vech Σ − ℓ(v) −1 F v , where F v is derived next, using that E ZZ ⊤ = var [Z] + E [Z] E [Z]</formula><p>⊤ and using (SM-4) and (SM-5) on a cluster C containing v and its parents in its scope, with J v and M v from Lemma 3 for C. For v ̸ = ρ, we get:</p><formula xml:id="formula_81" coords="39,85.79,198.85,439.93,164.44">F v = E θ      X v − u∈pa(v) γ uv X u     X v − u∈pa(v) γ uv X u   ⊤ Y    = var θ   X v − u∈pa(v) γ uv X u Y   + E θ   X v − u∈pa(v) γ uv X u Y   E θ   X v − u∈pa(v) γ uv X u Y   ⊤ =   [J −1 v ] vv + u1,u2∈pa(v) γ u1v γ u2v [J −1 v ] u1u2 − 2 u∈pa(v) γ uv [J −1 v ] vu   Σ +   E v − u∈pa(v) γ uv E u     E v − u∈pa(v) γ uv E u   ⊤ .</formula><p>For the root ρ:</p><formula xml:id="formula_82" coords="39,170.45,390.02,270.61,51.01">F ρ = E θ (X ρ − µ ρ ) (X ρ − µ ρ ) ⊤ Y = var θ [ X ρ − µ ρ | Y ] + E θ [ X ρ − µ ρ | Y ] E θ [ X ρ − µ ρ | Y ] ⊤ = [J −1 ρ ] ρρ Σ + (E ρ − µ ρ ) (E ρ − µ ρ ) ⊤ .</formula><p>Setting this gradient to 0 with respect to Σ, we get the following maximum likelihood estimate for the rate matrix:</p><formula xml:id="formula_83" coords="39,83.61,466.95,457.06,78.33">Σ =   ℓ(ρ) −1 (E ρ − μρ ) (E ρ − μρ ) ⊤ + v∈V,v̸ =ρ ℓ(v) −1   E v − u∈pa(v) γ uv E u     E v − u∈pa(v) γ uv E u   ⊤   ×   v∈V 1 − ℓ(v) −1   [J −1 v ] vv + u1,u2∈pa(v) γ u1v γ u2v [J −1 v ] u1u2 − 2 u∈pa(v) γ uv [J −1 v ] vu     −1 (SM-11)</formula><p>where we use the convention that a sum over an empty set (here pa(ρ)) is 0.</p><p>Note that this formula only uses the calibrated moments computed at each cluster. After calibration, then, calculating</p><formula xml:id="formula_84" coords="39,71.64,570.85,468.36,22.41">Σ with SM-11 has complexity O(|V |(k 3 + p 2 ))</formula><p>where k is the maximum cluster size, since SM-11 requires inverting at most |V | matrices of size k × k at most and the crossproduct of at most |V | vectors of size p. The final product is a scalar scaling of a p × p matrix. Calibrating the clique tree or cluster graph is more complex, because each BP update has complexity up to O(k 3 p 3 ). If the phylogeny is a tree, a clique tree has k = 2 and |V | = 2n − 1, so that SM-11 has complexity linear in the number of tips. While PIC can get these estimates in only one traversal of the tree, this formula requires two traversals of the clique tree, but is more general as it applies to any phylogenetic network.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.3.4 ML and REML estimation</head><p>Restricted maximum likelihood (REML) estimation can be framed as integrating out fixed effects <ref type="bibr" coords="39,455.36,680.79,61.16,8.64" target="#b59">[Harville, 1974]</ref>, here µ ρ , to estimate covariance parameters, here the BM variance rate Σ. This model corresponds to placing an improper prior on the root using ℓ(ρ) = +∞, in which case µ ρ is irrelevant. Then (SM-11) remains valid (with vanishing terms for the root) and gives an analytical formula for the REML estimate of Σ.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.4.2 Direct parameter estimation using the marginal distribution</head><p>Going back to model (SM-12), we do not assume that X = (V, U ) is jointly Gaussian and make no assumption about U . The distribution assumption is solely on the residual ϵ. Model SM-12 then amounts to a trait Y β = V − U ⊤ β at the tips (for a given β) evolving under a homogeneous univariate BM model with variance σ 2 . We denote by X the corresponding trait at all network nodes, whose values Y β at tips depends on β.</p><p>We can apply Fisher's formula (6.1) to this model, taking the derivative with respect to β:</p><formula xml:id="formula_85" coords="41,107.17,161.53,433.50,22.13">∇ β ′ log p(V − U ⊤ β ′ ) β ′ =β = v∈V E θ ∇ β ′ log ϕ v (X v |X pa(v) , θ ′ ) β ′ =β V − U ⊤ β (SM-16)</formula><p>In this sum, the only factors ϕ v that depend on β ′ are the factors at the tips. In phylogenies, leaves are typically constrained to have a single parent, although extending our derivation to the case of hybrid leaves would be straightforward.</p><p>For a leaf v with parent pa(v) = {u}, we have:</p><formula xml:id="formula_86" coords="41,72.00,210.81,468.00,27.77">Y β ′ v |X pa(v) ∼ N X u ; σ 2 ℓ(v) , and Y β ′ v = V v − U ⊤ v β ′ , so that ϕ v (Y β ′ v |X pa(v) , β ′ ) = ϕ v (V v |U ⊤ v β ′ + X u , β ′ ).</formula><p>Using the Gaussian derivative formula (SM-9), we get:</p><formula xml:id="formula_87" coords="41,116.23,245.29,371.08,68.49">∇ β ′ log ϕ v (Y β ′ v |X pa(v) , θ ′ ) β ′ =β = ∇ β ′ log ϕ v (V v |U ⊤ v β ′ + X u , θ ′ ) β ′ =β = ∂(X u + U ⊤ v β ′ ) ∂β ′ ⊤ β ′ =β [σ 2 ℓ(v)] −1 V v − X u + U ⊤ v β = U v [σ 2 ℓ(v)] −1 V v − U ⊤ v β − X u ,</formula><p>Using Lemma 3, the expectation of X u conditional on the observed values at the tips, E θ ( X u Y β ), is linear in the data so that by (SM-4):</p><formula xml:id="formula_88" coords="41,71.64,347.17,420.04,30.61">E θ ( X u Y β ) = E θ ( X u Y β ) ⊤ = [J −1 u ] u• (M V u ) ⊤ − [J −1 u ] u• (M U u ) ⊤ β = E V u − (E U u ) ⊤ β, where M V u , E V u and M U u , E U u denote</formula><p>, respectively, the BP quantities of Lemma 3 when applied to the traits V and U separately. Note that M U u can also be obtained by running BP on each of the p rows of U independently, because J u does not depend on the data and M u depends linearly on the data. As V is a trait of dimension 1, M V u is a row vector of size s, the number of nodes in the chosen cluster containing u; and</p><formula xml:id="formula_89" coords="41,72.00,399.33,469.24,24.14">[J −1 u ] u• (M V u ) ⊤ = E V u is a scalar. Also, [J −1 u ] u• (M U u ) ⊤ = (E U u ) ⊤ is a row-matrix of size 1 × p, so that [J −1 u ] u• (M U u ) ⊤ β = (E U u ) ⊤</formula><p>β is also a scalar. We can hence write, for leaf v with parent u:</p><formula xml:id="formula_90" coords="41,129.59,441.35,352.82,13.58">E θ ∇ β ′ [log ϕ v (X v |X u , θ)]| β ′ =β = U v [σ 2 ℓ(v)] −1 V v − U ⊤ v β − (E V u − (E U u ) ⊤ β) .</formula><p>Taking the sum and cancelling the gradient in β, we get:</p><formula xml:id="formula_91" coords="41,167.84,477.62,372.83,33.07">β = leaf v 1 ℓ(v) U v (U v − E U pa(v) ) ⊤ −1 leaf v 1 ℓ(v) U v (V v − E V pa(v) ). (SM-17)</formula><p>Note that the first term of the product involves the inversion of a p × p matrix, and that this formula outputs a vector of size p. To get all the quantities needed in this formula, we just need one BP calibration of the cluster graph with multivariate traits (V, U ) to get the conditional means and variances, which can be done efficiently using only univariate traits thanks to Corollary 5.</p><p>Finally, to get an estimator of the residual variance σ 2 , we can run another BP calibration, taking ε = V − U ⊤ β as the tip trait values, and then use the formulas from the previous section. Using an infinite root variance for this last BP traversal gives us the REML estimate of the variance.</p><p>If the phylogeny is a tree, this algorithm involves p + 2 univariate BP calibrations, each requiring two traversals of the tree, sums of O(n) terms in SM-17 and other formulas, and a p × p matrix inversion, so calculating β and σ2 is linear in the number of tips. Comparatively, the algorithm used in the R package phylolm <ref type="bibr" coords="41,401.07,629.97,78.00,8.64" target="#b65">[Ho and Ané, 2014]</ref> only needs one multivariate traversal of the tree. Our algorithm is more general however, as it applies to any phylogenetic network and to any associated cluster graph.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E Regularizing initial beliefs</head><p>At initialization, each factor is assigned to a cluster whose scope includes all nodes from that factor. Then the initial belief β i of a cluster C i is the product of all factors assigned to it by (4.2). Sepsets are not assigned any factors so their beliefs µ i,j are initialized to 1. This assignment guarantees that the the joint density p θ of the graphical model equals the following quantity at initialization:</p><formula xml:id="formula_92" coords="42,278.93,115.30,57.12,25.85">Ci∈V * β i {Ci,Cj }∈E * µ i,j</formula><p>.</p><p>(SM-18) (SM-18) is called the graph invariant because BP modifies cluster and sepset beliefs without changing the value of this quantity, and hence keeps it equal to p θ <ref type="bibr" coords="42,232.73,176.59,113.78,8.64" target="#b81">[Koller and Friedman, 2009]</ref>. Initialization with (4.2) can lead to degenerate messages, as highlighted in section 7.1. However, other belief assignments are permitted, provided that (SM-18) equals p θ at initialization. Modifying beliefs between BP iterations is also permitted, provided that (SM-18) is unchanged.</p><p>Regularization modifies the belief precisions to make them non-degenerate. To maintain the graph invariant, every modification to a cluster belief is balanced by a modification to an adjacent sepset belief. We describe two basic regularization algorithms below, but many others could also be considered.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm R3 Regularization along variable subtrees</head><p>1: for all variable x do 2:</p><p>T x ← subtree induced by all clusters containing x 3:</p><p>fix ϵ &gt; 0 4:</p><p>for all sepsets and for all but one cluster in T x do In Algorithm R3, each modified belief is multiplied by a regularization factor exp − 1 2 ϵx 2 . The graph invariant is satisfied because T x must be a tree (by the running intersection property), so the same number of clusters and sepsets are modified and the regularization factors cancel out in (SM-18). In Algorithm R4, the same argument applies to modifications on lines 7 and 8, which cancel out in (SM-18) so the graph invariant is maintained. It is also maintained on line 12, which uses BP.</p><p>The choice of the regularization constant ϵ is not specified above, but should be adapted to the magnitude of entries in the affected precision matrices.</p><p>Both algorithms performed comparably well on the join-graph structuring cluster graphs used in Fig. <ref type="figure" coords="42,470.09,664.40,4.90,8.64" target="#fig_7">7</ref> and Fig. <ref type="figure" coords="42,512.14,664.40,8.53,8.64" target="#fig_3">S2</ref>. On the factor graph for the complex network, however, Algorithm R4 was found to work better than R3. Namely, beliefs remained persistently degenerate after initial regularization with R3, such that the estimated conditional means and factored energy could not be computed.</p><p>Both algorithms are illustrated in Figure <ref type="figure" coords="42,234.72,713.51,8.67,8.64" target="#fig_13">S4</ref>. and variance rate 1, edge lengths of 1 in the original network and inheritance probabilities of 0.5. Cluster/sepset precision matrices have rows labelled by variables to show the nodes in scope. Precision matrices show entries before regularization (black) and after one pass through the outermost loop of the algorithm (coloured adjustments). Left: regularization R3 starting with variable x 8 . Right: regularization R4 starting with cluster {8, 10}, assuming that it is the first cluster scheduled to be processed. For R4, we differentiate the effects of lines 3-8 (blue) and lines 9-12 (red). For example, the resulting precision matrix for sepset {x 10 } is [3ε] after summing these effects, where ε = ϵ + o(ϵ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>F Handling deterministic factors</head><p>This section illustrates two approaches to running BP in the presence of a deterministic Gaussian factor that arises because the state at a hybrid node is a linear combination of its parents' states.</p><p>Let X be a univariate continuous trait evolving on the 3-taxon network in Fig. <ref type="figure" coords="43,382.20,388.18,9.30,8.64" target="#fig_3">2a</ref> (reproduced in Fig. <ref type="figure" coords="43,472.33,388.18,13.55,8.64" target="#fig_5">S5a</ref>) under a BM model with ancestral state 0 at the root and variance rate σ 2 . For simplicity, we assume that tree edges have length 1, hybrid edges have length 0, and inheritance probabilities are 1/2. The conditional distribution for each node given its parents is non-deterministic and can be expressed in a canonical form, except for X 5 at the hybrid node. Because of 0-length hybrid edges, we have the deterministic relationship: X 5 = (X 4 + X 6 )/2. After absorbing evidence x 1 , x 2 , x 3 at the tips and fixing x ρ = 0, the factors are:</p><p>ϕ 1 = C(x 4 ; σ −2 , σ −2 x 1 , g 1 ) ϕ 2 = C(x 5 ; σ −2 , σ −2 x 2 , g 2 ) ϕ 3 = C(x 6 ; σ −2 , σ −2 x 3 , g 3 ) ϕ 4 = C(x 4 ; σ −2 , 0, g 4 ) ϕ 6 = C(x 6 ; σ −2 , 0, g 6 ) ϕ 5 = δ(x 5 − (x 4 + x 6 )/2) where g i normalizes ϕ i to a valid probability density and δ(•) denotes a Dirac distribution at 0. U in Fig. <ref type="figure" coords="43,480.70,505.18,9.76,8.64" target="#fig_3">2b</ref> (reproduced in Fig. <ref type="figure" coords="43,101.39,516.09,14.40,8.64" target="#fig_5">S5b</ref>) remains a valid clique tree for this model. We index the cliques in U as C 1 = {x 1 , x 4 }, C 2 = {x 2 , x 5 }, C 3 = {x 3 , x 6 }, C 4 = {x 5 , x 4 , x 6 }, C 5 = {x 4 , x 6 , x ρ }. We set C 5 as the root clique and assume the following factor assignment for U:</p><formula xml:id="formula_93" coords="43,146.51,537.59,225.30,9.65">ϕ 1 → C 1 , ϕ 2 → C 2 , ϕ 3 → C 3 , ϕ 5 → C 4 , {ϕ 4 , ϕ 6 } → C 5 .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>F.1 Substitution</head><p>The substitution approach removes the Dirac factor ϕ 5 by removing x 5 from the model, substituting it by (x 4 + x 6 )/2 where needed. Since ϕ 2 has scope {x 5 }, it is reparametrized as ϕ ′ 2 on scope {x 4 , x 6 }:</p><formula xml:id="formula_94" coords="43,213.85,623.04,184.30,22.31">ϕ ′ 2 = C x 4 x 6 ; 1 4σ 2 1 1 1 1 , x 2 2σ 2 1 1 , g 2 .</formula><p>For the simple univariate BM, it is well known in the admixture graph literature <ref type="bibr" coords="43,388.76,658.97,117.22,8.64" target="#b105">[Pickrell and Pritchard, 2012]</ref> that this substitution corresponds to using a modified network N ′ in which hybrid edges do not all have length 0 (Fig. <ref type="figure" coords="43,520.58,669.88,12.70,8.64" target="#fig_5">S5c</ref>). N ′ is built from the original network N by removing the hybrid node 5 and connecting its parents (nodes 4 and 6) to its child (node 2) with edges of lengths ℓ 4 = ℓ 6 = 2 for example (to ensure that γ 2 4 ℓ 4 + γ 2 2 ℓ 2 equals the length of the original child edge to node 2). A clique tree U ′ for N ′ can be obtained from U by replacing C 2 and C 4 with C ′ 4 = {x 2 , x 4 , x 6 } (Fig. <ref type="figure" coords="43,168.39,713.51,12.79,8.64" target="#fig_5">S5d</ref>). Factor ϕ ′ 2 is assigned to C ′ 4 while the other factor assignments stay the same. Standard BP can be used for the BM model on N ′ because all factors are non-degenerate. After one postorder traversal of U ′ , the message μ4 ′ →5 , final belief β 5 and log-likelihood LL(σ 2 ) = log p σ 2 (x 1 , x 2 , x 3 ) are: We can still recover the conditional distribution of X 5 from β 5 , because β 5 has scope {x 4 , x 6 }. Let (K, h, g) be the parameters of the canonical form of β 5 , given above. After the postorder traversal of U ′ , β 5 contains information from all the tips such that the distribution of (X 4 , X 6 ) conditional on the data (x 1 , x 2 , x 3 ) is N K −1 h, K −1 . Since X 5 = γ ⊤ X 4 X 6 with γ ⊤ = [1/2, 1/2], we get</p><formula xml:id="formula_95" coords="44,85.57,360.79,329.33,22.31">μ4 ′ →5 = ψ 4 ′ μ1→4 ′ μ3→4 ′ = ϕ ′ 2 ϕ 1 ϕ 3 = C x 4 x 6 ; 1 4σ 2 5 1 1 5 , 1 2σ 2 2x 1 + x 2 2x 3 + x 2 ,</formula><formula xml:id="formula_96" coords="44,162.84,549.85,226.49,30.32">X 5 | (x 1 , x 2 , x 3 ) ∼ N (γ ⊤ K −1 h, γ ⊤ K −1 γ) = N 3 i=1</formula><p>x i /5, σ 2 /5 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>F.2 Generalized canonical form</head><p>A more general approach generalizes canonical form operations to include Dirac distributions without modifying the original set of factors and clique tree, as demonstrated in <ref type="bibr" coords="44,307.91,627.13,93.49,8.64" target="#b117">Schoeman et al. [2022]</ref>. Crucially, they derived message passing operations (evidence absorption, marginalization, factor product, etc.) for a generalized canonical form:</p><formula xml:id="formula_97" coords="44,191.53,656.34,228.94,11.03">D(x; Q, R, Λ, h, c, g) := C(Q ⊤ x; Λ, h, g) • δ(R ⊤ x − c)</formula><p>where x is an n-dimensional vector, Λ ⪰ 0 is a (n − k) × (n − k) diagonal matrix, and Q and R are matrices of dimension n × (n − k) and n × k respectively, that are orthonormal and orthogonal to each other, that is:</p><formula xml:id="formula_98" coords="44,72.00,688.77,469.25,23.17">Q ⊤ Q = I n−k , R ⊤ R = I k , and Q ⊤ R = 0.</formula><p>If Q is square (thus invertible) then R is empty and the Dirac δ(•) term is dropped or defined as 1. The same applies to the C(•) term if R is square (and Q is empty). Non-deterministic linear Gaussian factors are represented in generalized canonical form with Q square from the eigendecomposition of K = QΛQ ⊤ . Thus, we can run BP on U, converting beliefs or messages to generalized canonical form as needed.</p><p>Running BP according to a postorder traversal of U, the message μ4→5 involves a degenerate component: To compute μ4→5 , we first convert ϕ 5 and 3 i=1 ϕ i to generalized canonical forms:</p><formula xml:id="formula_99" coords="45,162.30,194.92,31.37,9.65">ϕ 5 = D</formula><p>x 4 x 6</p><p>x 5</p><p>; 1/w 1 1/w 2 1/w 1 −1/w 2 1/w 1 0 , 1/2w 0 1/2w 0 −1/w 0 , Λ 5 = 0 0 0 0 , 0 0 , 0, 0</p><formula xml:id="formula_100" coords="45,148.88,221.22,44.79,30.32">3 i=1 ϕ i = D</formula><p>x 4 x 6 x 5</p><p>; I 3 , −, σ −2 I 3 , σ −2</p><formula xml:id="formula_101" coords="45,312.49,220.42,57.43,31.47">x 1 x 3 x 2 , −, 3 i=1 g i</formula><p>where (w 0 , w 1 , w 2 ) = ( 6/4, √ 3, √ 2) are normalization constants for the respective columns, and the dashes indicate that the δ(•) part is dropped. By <ref type="bibr" coords="45,201.37,273.65,145.27,8.64">Schoeman et al. [2022, Algorithm 3]</ref>, their product evaluates to:</p><formula xml:id="formula_102" coords="45,71.53,291.05,460.22,61.93">ϕ 5 3 i=1 ϕ i = D x 4 x 6 x 5 ; Q = 1/w 1 1/w 2 1/w 1 −1/w 2 1/w 1 0 , R = 1/2w 0 1/2w 0 −1/w 0 , σ −2 I 2 , h = σ −2 (x 1 + x 2 + x 3 )/w 1 (x 1 − x 3 )/w 2 , 0, 3 i=1 g i We partition Q = Q 4,6 Q 5 and R = R 4,6</formula><p>R 5 by separating the first two rows from the last row.</p><p>Then by <ref type="bibr" coords="45,107.11,355.76,145.27,8.64">Schoeman et al. [2022, Algorithm 2]</ref>, integrating out x 5 yields: </p><formula xml:id="formula_103" coords="45,103.99,372.83,98.83,31.47">D x 4 x 6 x 5 ; Q 4,6 Q 5 , R<label>4</label></formula><formula xml:id="formula_104" coords="45,203.79,556.15,184.57,36.53">Q 4→5 = U Z = Z h 4→5 = Z ⊤ G ⊤ h = σ −2 w 2 (x 1 + x 2 + x 3 ) w 2 (x 1 − x 3 )</formula><p>This generalized canonical form can be rewritten as a standard canonical form:</p><formula xml:id="formula_105" coords="45,91.78,619.02,419.18,60.66">μ4→5 = C Q ⊤ 4→5 x 4 x 6 ; Λ 4→5 , h 4→5 , 3 i=1 g i = C x 4 x 6 ; Q 4→5 Λ 4→5 Q ⊤ 4→5 , Q 4→5 h 4→5 , 3 i=1 g i = C x 4 x 6 ; 1 4σ 2 5 1 1 5 , 1 2σ 2 2x 1 + x 2 2x 3 + x 2 ,</formula></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0" coords="2,86.94,91.87,430.87,8.64;2,86.94,108.25,430.87,8.64;2,86.94,124.64,430.87,8.64;2,86.94,141.03,430.87,8.64;2,72.00,166.99,210.79,8.96;2,86.94,183.77,430.87,8.64;2,86.94,200.16,430.87,8.64;2,86.94,216.55,430.87,8.64;2,72.00,242.51,218.17,8.96;2,86.94,259.29,430.87,8.64;2,86.94,275.68,430.87,8.64;2,86.94,292.06,430.87,8.64;2,72.00,318.03,128.43,8.96;2,86.94,334.80,430.87,8.64;2,86.94,351.19,430.87,8.64;2,72.00,377.16,127.35,9.09;2,72.00,403.51,205.24,8.96;2,72.00,429.86,174.14,8.96;2,72.00,456.21,223.58,8.96;2,86.94,472.99,430.87,8.64;2,86.94,489.37,430.87,8.64;2,86.94,505.76,430.87,8.64;2,86.94,522.15,430.87,8.64;2,72.00,548.11,126.75,8.96;2,72.00,574.47,145.00,8.96;2,86.94,591.24,430.87,8.64;2,86.94,607.63,430.87,8.64"><head>4. 1</head><label>1</label><figDesc>Graphical models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.2 Phylogenetic examples of graphical models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3 Belief Propagation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.4 BP for Gaussian models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 Scalable approximate inference with loopy BP 5.1 Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.2 Likelihood approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.3 Scalability versus accuracy: choice of cluster graph complexity . . . . . . . . . . . . . . . . . . . . . 6 Leveraging BP for efficient parameter inference 6.1 BP for fast likelihood computation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.2 BP for fast gradient computation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.3 BP for direct Bayesian parameter inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 Challenges and Extensions 7.1 Degeneracy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.2 Loopy BP is promising for discrete traits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A Recasting SnappNet as BP B Bounding the moralized network's treewidth C Approximation quality with loopy BP D Gradient and parameter estimates under the BM D.1 The homogeneous BM model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . D.2 Belief Propagation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . D.3 Gradient computation and analytical formula for parameter estimates . . . . . . . . . . . . . . . . . . D.4 Analytical formula for phylogenetic regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . E Regularizing initial beliefs F Handling deterministic factors F.1 Substitution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . F.2 Generalized canonical form . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1" coords="7,212.04,357.46,3.97,6.12;7,231.97,346.35,4.64,8.74;7,236.61,344.27,20.16,6.12;7,257.77,346.32,17.19,9.68;7,274.96,342.63,22.19,7.76;7,291.75,346.32,59.19,9.68;7,350.94,344.27,29.75,6.12;7,381.68,346.32,15.82,9.68;7,397.50,342.63,31.77,7.76;7,423.87,347.63,3.37,4.37"><head>0e</head><label></label><figDesc>−sAe Σ e e −sA ⊤ e ds = S e − e −ℓ(e)Ae S e e −ℓ(e)A ⊤ e</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2" coords="9,72.00,387.69,468.00,8.64;9,72.00,398.60,238.25,8.64;9,323.05,403.31,3.98,6.12;9,329.44,398.28,210.56,9.65;9,72.00,410.37,153.19,9.96;9,225.54,408.80,3.97,6.12;9,230.01,410.37,309.99,9.65;9,72.00,421.28,468.00,8.96;9,71.75,432.51,147.76,8.64"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: Example graphical model on a phylogenetic tree with factors defined by the BM. The joint distribution of all variables at all nodes is given by the product of factors: v ϕ v where ϕ v is the distribution of x v conditional on its parent variable x pa(v) : N (x pa(v) , σ 2 ℓ v ) under the BM. (a) Phylogenetic tree T . (b) Clique tree U for the graphical model. Its nodes are clusters of variables in T (ellipses). Each edge is labelled by a sepset (squares): a subset of variables shared by adjacent clusters.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3" coords="9,72.00,655.38,468.00,8.96;9,72.00,666.29,468.00,8.96;9,72.00,677.20,468.17,9.65;9,72.00,688.10,158.13,9.65;9,231.12,686.53,4.08,6.12;9,235.70,688.10,246.16,8.96;9,482.85,686.53,4.08,6.12;9,489.86,688.42,50.14,8.64;9,72.00,699.01,468.00,9.65;9,72.00,709.92,116.42,9.65"><head>Figure 2 :</head><label>2</label><figDesc>Figure2: (a) Phylogenetic network N with hybrid edges shown in blue. N displays two trees, depending on which hybrid edge is retained. One tree, with sister taxa 1 and 2, has probability 0.4. The other tree, with sister taxa 2 and 3, is displayed with probability 0.6. The distribution of the hybrid node x 5 depends on both its parents, and induces a factor cluster {x 4 , x 5 , x 6 } of size 3 in U and U * . (b) Clique tree U for the graphical model. (c) Cluster graph U * (leaf clusters not shown) for the same graphical model in which {x 4 , x 6 , x ρ } in U is replaced by smaller clusters {x 4 , x ρ }, {x 6 , x ρ } and {x ρ } that induce a cycle.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4" coords="15,72.00,524.20,468.00,8.96;15,72.00,535.11,469.75,8.96;15,72.00,546.02,416.55,8.96;15,489.05,544.44,7.07,6.12;15,496.62,546.34,43.39,8.64;15,72.00,556.93,469.74,8.96;15,72.00,568.15,469.74,8.64;15,72.00,579.06,363.83,8.64"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: (a) Admixture graph N from [Lazaridis et al., 2014, Fig. 3] with h = 4 reticulations (hybrid edges are coloured). N has one non-trivial biconnected component (blob) B, induced by all its internal nodes except for the root. B contains all 4 reticulations so N has level ℓ = 4. (b)-(d) Various cluster graphs for the moralized blob B m : (b) clique tree, (c) join-graph structuring with the maximum cluster size set to 3, (d) LTRIP using the set of node families in B. Here sepsets (not shown) are the intersection of their incident clusters, and are small with 1 node only in (c) and (d). Purple boxes and edges: clusters and sepsets that contain node 8. Red text: hybrid families.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5" coords="17,72.00,207.28,443.24,9.65;17,516.33,205.70,7.07,6.12;17,515.24,211.79,3.97,6.12;17,526.45,207.60,13.55,8.64;17,72.00,218.19,310.19,9.65;17,383.27,216.61,7.07,6.12;17,382.19,222.70,3.97,6.12;17,393.67,218.19,146.34,8.96;17,72.00,229.10,304.78,8.96;17,377.86,227.52,7.07,6.12;17,376.78,233.61,3.97,6.12;17,387.92,229.10,108.24,8.96"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Two binary networks with a hybrid ladder and h = ℓ = 2. N 1 satisfies (A2) of Proposition 1 and N m 1 has treewidth t = 3. N 2 does not meet (A2) (see red/purple annotations) and N m 2 has treewidth t = 2. Stacking more hybrid ladders in the same way above a and b increases h and ℓ but leaves N m 2 outerplanar, keeping t = 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6" coords="18,72.00,202.10,468.34,8.64;18,72.00,213.01,468.00,8.64;18,72.00,223.92,469.25,8.64;18,72.00,234.83,469.74,8.64;18,72.00,245.74,469.24,8.64;18,72.00,256.65,468.34,8.64;18,72.00,267.56,469.25,8.70;18,72.00,278.47,469.24,8.70;18,71.74,289.38,468.43,8.70;18,72.00,300.29,468.35,8.64;18,71.64,311.20,109.52,8.64"><head>Figure 6 :</head><label>6</label><figDesc>Figure6: We observe a positive sublinear relationship between a maximum clique size upperbound (from the greedy minfill heuristic) and the number of hybrids (A) or network level (B) on a combined sample of 11 empirical networks and 2509 simulated birth-death-hybridization networks. The empirical networks were sampled from[Maier et al., 2023,  Figs. 3a-c (left), 4a-c (left)] (reported as estimated by<ref type="bibr" coords="18,290.89,234.83,92.82,8.64" target="#b17">Bergström et al. [2020]</ref>,<ref type="bibr" coords="18,390.44,234.83,82.28,8.64" target="#b86">Librado et al. [2021]</ref>,<ref type="bibr" coords="18,479.46,234.83,62.28,8.64;18,72.00,245.74,25.40,8.64" target="#b55">Hajdinjak et al. [2021]</ref>,<ref type="bibr" coords="18,104.13,245.74,78.33,8.64" target="#b88">Lipson et al. [2020]</ref>,<ref type="bibr" coords="18,189.20,245.74,73.58,8.64" target="#b139">Wang et al. [2021]</ref>,<ref type="bibr" coords="18,269.51,245.74,75.90,8.64" target="#b121">Sikora et al. [2019]</ref>),[Lazaridis et al., 2014, Fig. 3],[Nielsen et al.,  2023, Fig. 3 (left)],[Sun et al., 2023, Fig. 4c],[Müller et al., 2022, Fig. 1a],[Neureiter et al., 2022, Fig. 5a]; fit by these authors using ADMIXTOOLS<ref type="bibr" coords="18,206.10,267.56,86.67,8.64" target="#b104">Patterson et al. [2012]</ref>,Maier et al. [2023], admixturegraph Leppälä et al. [2017], OrientAGraph Molloy et al. [2021], contacTrees Neureiter et al. [2022], Recombination Müller et al. [2022],AdmixtureBayes<ref type="bibr" coords="18,148.25,289.38,83.52,8.64" target="#b101">Nielsen et al. [2023]</ref>. The simulated networks were obtained by subsampling 10 networks per parameter scenario simulated by<ref type="bibr" coords="18,204.01,300.29,102.90,8.64" target="#b74">Justison and Heath [2024]</ref>, then filtering out networks of treewidth 1 (trees, possibly with parallel hybrid edges).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7" coords="19,72.00,429.42,468.00,9.65;19,72.00,440.33,430.98,8.96;19,503.97,438.75,4.08,6.12;19,511.04,440.65,28.95,8.64;19,72.00,451.55,468.00,8.64;19,71.67,462.46,330.15,8.64;19,402.14,460.57,4.08,6.12;19,406.72,462.14,133.45,8.96;19,72.00,473.05,209.98,8.96;19,282.97,471.48,4.08,6.12;19,287.55,473.37,253.12,8.64;19,72.00,483.96,448.53,8.96;19,521.52,482.39,4.08,6.12;19,526.10,484.28,13.90,8.64;19,72.00,495.19,468.00,8.64;19,72.00,506.10,100.51,8.64"><head>Figure 7 :</head><label>7</label><figDesc>Figure7: Accuracy of loopy BP. Approximation of the conditional distribution of the root state X ρ (left and center) and log-likelihood (right) using a greedy minimum-fill clique tree U and a join-graph structuring cluster graph U * for two networks of varying complexity<ref type="bibr" coords="19,199.41,451.55,75.14,8.64" target="#b98">Müller et al. [2022]</ref>,<ref type="bibr" coords="19,281.12,451.55,77.33,8.64" target="#b88">Lipson et al. [2020]</ref> as measured by their number of tips (n), level (ℓ), number of hybrids (h), maximum clique size (k), and maximum cluster size (k * ). For U, estimates are exact after one iteration and shown as horizontal red lines. For U * , estimates are shown over 20 (first row), 50 or 200 (second row) iterations. Each iteration consists of two passes through each spanning tree in a minimal set that jointly covers U * . In each plot, the two curves correspond to two different regularizations of initial beliefs (SM section E, dotted: algorithm R1, solid: algorithm R2).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8" coords="31,72.00,563.67,468.00,8.96;31,72.00,574.58,468.00,9.65;31,72.00,585.48,468.00,9.65;31,72.00,596.39,468.35,9.65;31,72.00,607.62,31.82,8.64"><head>Figure</head><label></label><figDesc>Figure S1: (a) Phylogenetic network N with hybrid edges in blue. (b) Graph G for the graphical model associated with N . G is a DAG with two roots (1 and 2) and two leaves (1 and 2). (c) Clique tree U for G, with clusters C j in grey and sepsets S i,j in orange. To reduce clutter and simplify notations in this figure, n e and r e are both abbreviated as e and are distinguished by colours (n's in black, r's in red). Similarly, n e and r e are both denoted as e and distinguished by colours.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10" coords="33,72.00,633.56,462.43,8.96;33,535.42,631.98,4.08,6.12;33,72.00,644.79,468.00,8.64;33,71.75,655.70,469.49,8.64;33,72.00,666.29,468.35,8.96;33,72.00,677.20,468.16,8.96;33,72.00,688.10,352.25,8.96;33,425.24,686.53,4.08,6.12;33,432.31,688.42,107.69,8.64;33,72.00,699.01,467.99,8.96;33,72.00,710.24,316.67,8.64"><head></head><label></label><figDesc>FigureS2: Comparing the accuracy of loopy BP between different cluster graphs: built from join-graph structuring U * as in Fig.7(black), or a factor graph (purple). For both, initial beliefs are regularized using algorithm R4. The true values, obtained using a clique tree, are shown in red. The plots in the first row are for the simpler phylogenetic network, and the plots in the other rows are for the complex phylogeny. The last row shows the difference ∆ between the loopy BP estimate and the true value, displayed on the log-modulus scale using the transformation sign(∆) log(1 + |∆|). For the simpler phylogenetic network, convergence speed and accuracy are similar between U * and the factor graph, which is unsurprising given their similarly small cluster sizes (≤ 3). For the complex network, the factor graph did not reach calibration as its iterates diverged for the conditional mean and factored energy.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11" coords="34,306.00,128.57,235.66,8.64;34,306.00,139.48,234.17,8.64;34,306.00,150.07,32.12,8.96;34,339.11,148.50,4.08,6.12;34,346.44,150.07,193.73,8.96;34,306.00,161.30,235.74,8.64;34,305.69,172.21,235.96,8.64;34,306.00,183.12,234.00,8.64;34,306.00,194.03,235.65,8.64;34,306.00,204.94,234.00,8.64;34,306.00,215.85,21.86,8.64"><head>Figure S3 :</head><label>S3</label><figDesc>FigureS3: Boxplots (with means as points) showing the distribution of cluster sizes in the join-graph structuring cluster graph U * and in the clique tree U from Fig.7. The factor graph has clusters of size between 1 and 3 (not displayed). The time for 100 iterations (defined in Fig.7) was benchmarked over 20 replicates on a MacBook Pro M2 2022, and divided by the number of messages per 100 iterations to obtain an estimate of the mean time per belief update (vertical axis).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12" coords="42,76.98,332.47,6.98,7.77;42,118.82,331.50,306.08,8.96;42,71.64,390.87,176.66,9.03;42,76.98,406.28,187.00,9.96;42,76.98,417.19,289.23,9.65;42,76.98,428.02,109.24,8.96;42,76.98,439.97,6.98,7.77;42,103.88,438.93,110.18,9.72;42,76.98,450.88,6.98,7.77;42,118.82,449.84,101.25,9.03;42,76.98,461.79,6.98,7.77;42,133.77,460.82,35.32,8.96;42,76.98,472.70,6.98,7.77;42,133.77,471.73,188.51,9.65;42,76.98,483.61,6.98,7.77;42,133.77,482.64,353.64,9.65;42,76.98,494.52,6.98,7.77;42,133.77,493.55,86.42,8.96;42,72.50,507.36,11.46,7.77;42,103.88,506.33,110.88,9.72;42,72.50,518.27,11.46,7.77;42,118.82,517.23,102.08,9.03;42,72.50,529.18,11.46,7.77;42,133.77,528.21,184.13,9.65;42,72.50,540.09,11.46,7.77;42,133.77,539.12,87.24,8.96"><head></head><label></label><figDesc>the diagonal entry of its belief's precision matrix corresponding to x Algorithm R4 Regularization on a schedule 1: Choose an ordering of clusters: C 1 , . . . , C |V| 2: For each cluster C i and each neighbor C j of C i , set i → j as unvisited 3: for all i = 1, . . . , |V| do 4:for all neighbor C j of C i do ϵI to the precision matrix of the sepset S i,j 8: add ϵ to the diagonal entry of C i 's precision matrix corresponding to each variable in S i,j 9: mark j → i as visited 10:for all neighbor C k of C i do 11: if i → k is unvisited then 12:propagate belief from C i to C k by Algorithm 2 13: mark i → k as visited</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13" coords="43,72.00,229.89,468.00,8.64;43,72.00,240.79,467.99,8.64;43,72.00,251.70,468.00,8.64;43,72.00,262.61,469.39,8.64;43,72.00,273.20,468.00,9.65;43,72.00,284.43,468.17,8.64;43,72.00,295.02,445.90,9.65"><head>Figure S4 :</head><label>S4</label><figDesc>FigureS4: Applying algorithms R3 and R4 on the cluster graph fromFig. 4(d), for a univariate BM model with mean 0 and variance rate 1, edge lengths of 1 in the original network and inheritance probabilities of 0.5. Cluster/sepset precision matrices have rows labelled by variables to show the nodes in scope. Precision matrices show entries before regularization (black) and after one pass through the outermost loop of the algorithm (coloured adjustments). Left: regularization R3 starting with variable x 8 . Right: regularization R4 starting with cluster {8, 10}, assuming that it is the first cluster scheduled to be processed. For R4, we differentiate the effects of lines 3-8 (blue) and lines 9-12 (red). For example, the resulting precision matrix for sepset {x 10 } is [3ε] after summing these effects, where ε = ϵ + o(ϵ).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14" coords="44,72.00,260.42,356.94,8.96;44,430.03,258.84,2.30,6.12;44,435.52,260.73,104.47,8.64;44,72.00,271.33,437.58,8.96;44,510.67,269.75,2.30,6.12;44,516.29,271.64,23.71,8.64;44,72.00,282.23,67.75,8.96;44,140.84,280.66,2.30,6.12;44,143.63,282.23,222.41,8.96;44,367.14,280.66,2.30,6.12;44,372.72,282.23,112.94,8.96;44,486.65,280.66,2.30,6.12;44,492.24,282.23,22.64,8.96;44,515.97,280.66,2.30,6.12;44,521.55,282.55,18.62,8.64;44,72.00,293.46,52.85,8.64"><head>Figure</head><label></label><figDesc>Figure S5: (a) Network N from Fig. 2a. (b) Clique tree U from Fig. 2b. (c) Network N ′ obtained by removing the hybrid node 5 from N in (a). The BM model on N leads to the same probability model for the nodes in N ′ as the BM model on N ′ , given a valid assignment of hybrid edge lengths in N ′ (see text). (d) Clique tree U ′ for N ′ after moralization.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15" coords="44,421.76,357.12,3.97,6.12;44,417.30,381.33,12.91,6.12;44,432.61,367.53,7.57,9.65;44,99.76,404.69,138.53,9.65;44,239.95,391.07,8.72,6.38;44,239.95,409.01,8.72,6.38;44,253.92,398.93,9.67,9.65;44,253.92,409.84,9.67,9.65;44,271.00,404.66,25.31,8.77;44,305.54,397.95,4.98,8.74;44,300.28,410.69,15.00,9.57;44,323.90,398.93,19.92,8.74;44,323.90,409.84,19.92,8.74;44,350.74,404.69,22.34,8.74;44,382.31,397.95,4.98,8.74;44,377.05,410.69,15.00,9.57;44,400.66,398.93,36.11,9.65;44,400.66,409.84,36.11,9.65;44,444.19,404.69,21.71,8.74;44,480.78,394.28,3.97,6.12;44,468.68,418.72,28.18,6.12;44,498.51,404.69,7.57,9.65;44,506.58,391.07,8.72,6.38;44,506.58,409.01,8.72,6.38;44,79.14,447.53,22.02,8.74;44,101.52,445.46,3.97,6.12;44,105.99,447.53,80.10,9.65;44,200.96,437.12,3.97,6.12;44,188.85,461.56,28.18,6.12;44,218.69,447.53,18.03,9.65;44,238.94,430.93,8.72,6.38;44,238.94,448.46,8.72,6.38;44,238.94,454.84,21.45,6.38;44,265.50,447.53,10.66,8.74;44,291.97,440.79,4.98,8.74;44,286.71,453.53,15.00,9.58;44,310.33,441.77,19.92,8.74;44,310.33,452.68,19.92,8.74;44,342.84,437.59,10.20,6.12;44,359.07,447.53,7.75,8.74;44,381.03,440.79,4.98,8.74;44,375.77,453.53,15.00,9.58;44,399.38,441.77,36.12,9.65;44,399.38,452.68,36.12,9.65;44,458.38,458.35,3.39,4.35;44,454.32,463.00,11.02,5.82;44,471.75,452.60,19.92,8.74;44,471.75,463.50,19.92,8.74;44,502.74,450.82,8.79,4.37;44,512.52,430.93,8.72,6.38;44,512.52,448.46,8.72,6.38;44,512.52,454.84,8.72,6.38;44,522.90,447.53,9.96,8.74"><head></head><label></label><figDesc>ψ 5 μ4 ′ →5 = ϕ 4 ϕ 6 μ4 ′ →5 = C</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17" coords="45,202.82,381.82,6.87,6.12;45,193.86,389.16,12.66,9.68;45,217.11,384.05,10.12,8.74;45,227.59,381.97,10.20,6.12;45,238.28,384.02,31.91,9.68;45,277.06,373.63,3.97,6.12;45,272.59,397.84,12.91,6.12;45,287.90,384.05,53.93,9.65;45,356.92,378.28,9.67,9.65;45,356.92,389.19,9.67,9.65;45,374.00,384.02,111.97,9.68;45,492.84,373.63,3.97,6.12;45,488.37,397.84,12.91,6.12;45,503.68,384.05,7.57,9.65;45,71.64,412.63,416.48,8.64;45,219.72,429.67,72.67,9.68;45,220.38,451.37,71.48,9.68;45,291.86,449.33,6.12,6.12;45,298.47,451.37,17.00,9.68;45,315.47,449.33,6.23,6.12;45,324.96,451.40,7.75,8.74;45,340.74,445.64,35.44,9.65;45,356.21,456.55,4.98,8.74;45,220.00,479.27,34.65,8.77;45,254.64,477.23,6.23,6.12;45,254.64,483.80,10.31,6.12;45,267.66,479.27,27.11,8.77;45,294.81,477.23,6.23,6.12;45,294.77,483.80,10.31,6.12;45,305.58,479.30,23.50,8.74;45,337.10,473.54,78.55,9.65;45,343.47,484.44,21.07,9.65;45,383.85,484.44,28.82,9.65;45,180.91,507.16,40.50,9.68;45,222.11,505.12,6.23,6.12;45,231.60,507.19,43.15,8.96;45,274.75,505.12,6.23,6.12;45,283.13,507.19,9.57,8.74;45,293.06,505.12,10.20,6.12;45,303.75,507.16,61.01,9.68;45,380.22,500.45,4.98,8.74;45,374.96,513.19,15.00,9.57;45,398.57,501.43,19.92,8.74;45,398.57,512.34,19.92,8.74;45,181.99,535.06,57.35,8.99;45,247.37,529.33,56.47,9.65;45,247.37,540.24,60.34,9.65;45,317.62,535.06,51.80,9.68;45,378.65,528.35,4.98,8.74;45,373.39,541.09,15.00,9.57;45,397.00,529.33,19.92,8.74;45,397.00,540.24,19.92,8.74"><head></head><label></label><figDesc>notations from<ref type="bibr" coords="45,202.83,412.63,92.41,8.64" target="#b117">Schoeman et al. [2022]</ref> for intermediate quantities in their Algorithm 3:U = I 2 , W = [1] F = (W (R 5 W ) + Q 5 ) ⊤ = −w 0 /w 1 0 G = (Q ⊤ 4,6 − F R ⊤ 4,6 )U = 3/(2w 1 ) 3/(2w 1 ) 1/w 2 −1/w 2 ZΛ 4→5 Z ⊤ = SVD(G ⊤ (σ −2 I 2 ) G)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" coords="6,72.00,227.04,468.00,30.46"><head></head><label></label><figDesc>To identify selection and adaptation on a network, PolyGraph<ref type="bibr" coords="6,413.33,227.04,81.28,8.64" target="#b108">Racimo et al. [2018]</ref> and GRoSS Refoyo-Martínez et al.[2019]  assume a similar model and use the full covariance matrix. In summary, BP has yet to be used for continuous trait evolution on networks.</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" coords="18,71.74,256.65,469.51,52.27"><head></head><label></label><figDesc>]; fit by these authors using ADMIXTOOLS<ref type="bibr" coords="18,206.10,267.56,86.67,8.64" target="#b104">Patterson et al. [2012]</ref>,Maier et al. [2023], admixturegraph Leppälä et al. [2017], OrientAGraph Molloy et al. [2021], contacTrees Neureiter et al. [2022], Recombination Müller et al. [2022], AdmixtureBayes Nielsen et al. [2023]. The simulated networks were obtained by subsampling 10 networks per parameter scenario simulated by</figDesc><table /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3" xml:id="foot_0">i=1g i which agrees with μ4 ′ →5 from the substitution approach in F.1. Since the remaining operations to compute β 5 = ψ 5 μ4→5 and LL(σ 2 ) = β 5 dx</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4" xml:id="foot_1">dx 6 involve non-deterministic canonical forms, it is clear that they both evaluate to the same quantity as when using the substitution approach above.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>This work was supported in part by the National Science Foundation (DMS 2023239 to C.A.) and by the University of Wisconsin-Madison Office of the Vice Chancellor for Research and Graduate Education with funding from the Wisconsin Alumni Research Foundation. C.A. visited P.B. at the University of Montpellier thanks to support from the I-SITE MUSE through the Key Initiative "Data and Life Sciences".</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Material</head><p>Technical derivations are available in the Supplementary Material (SM). Code to reproduce Figures <ref type="figure" coords="22,464.99,700.71,19.14,8.64">4a, 6</ref> and 7 is available at https://github.com/bstkj/graphicalmodels_for_phylogenetics_code. A julia package for Gaussian BP on phylogenetic networks is available at https://github.com/cecileane/PhyloGaussianBeliefProp. jl.</p><p>For maximum likelihood (ML) estimation of µ ρ , considered as the state X ρ at the root node ρ, we need to consider the case ℓ(ρ) = 0 to fix X ρ = µ ρ . Under ℓ(ρ) = 0, (SM-10) cannot be calculated because X ρ = µ ρ was absorbed as evidence and ρ removed from scope. Instead, we note that under an improper root with infinite variance, the posterior density of the root trait conditional on all the tips is proportional to the likelihood p</p><p>because p(X ρ ) ≡ 1 under an improper prior on X ρ . Therefore, maximizing the likelihood p( Y | X ρ ) in the root parameter X ρ = µ ρ amounts to maximizing the density p( X ρ | Y ) in X ρ . This density is Gaussian with expectation E ρ by (SM-4) so its maximum is attained at μρ</p><p>In summary, the ML estimate of µ ρ is still given by (SM-10), but calculated by running BP under an improper prior at the root.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.4 Analytical formula for phylogenetic regression</head><p>In the previous section, we derived analytical formulas (SM-10) and (SM-11) for estimating the parameters of a homogeneous multivariate BM on a phylogenetic network, using the output of only one BP calibration thanks to Corollary 4.</p><p>Instead of fitting a multivariate process, it is often of interest to look at the distribution of one particular trait conditional on all others. This phylogenetic regression setting is for instance used on a network in <ref type="bibr" coords="40,417.50,264.31,84.11,8.64" target="#b15">Bastide et al. [2018b]</ref>. Writing V the (univariate) trait of interest measured at the n tips of a network, and U the p × n matrix of regressors, we are interested in the model:</p><p>(SM-12) with β a vector of p coefficients, and ϵ a vector of residuals with expectation 0 and a variance-covariance matrix that is given by a univariate BM on the network with variance rate σ 2 , and a root fixed to 0. The v th column U •v corresponds to the predictors at leaf v and will be denoted as U v .</p><p>In this setting, explicit maximum likelihood estimators for β and σ are available, but they involve the inverse of an n × n matrix, with O(n 3 ) complexity. Our goal is to get these estimators in linear time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.4.1 Parameter estimation using the joint distribution</head><p>To build on section D.3, we first look at the joint distribution of the reponse and predictors V and U . Setting the intercept aside, we slightly rewrite model SM-12 (with a slight change of notation for U and p) to:</p><p>with α a scalar, 1 the vector of ones, β a vector of p coefficients, and ϵ a vector of residuals with expectation 0 and a variance-covariance matrix given by a univariate BM on the network with variance rate σ 2 , and a root fixed to 0.</p><p>Assuming that the joint trait X = (V, U ), of dimension p + 1, is jointly Gaussian and evolving on the network with variance rate</p><p>, we obtain the regression model above with</p><p>This is because a joint BM evolution for X implies that the evolutionary changes in V and U along each branch e, (∆V ) e and (∆U ) e , are jointly Gaussian N (0, ℓ(e)Σ X ) and independent of previous evolutionary changes. By classical Gaussian conditioning, this means that (∆V ) e = (∆U ) ⊤ e β + (∆ϵ) e where (∆ϵ) e ∼ N (0, ℓ(e)σ 2 ) and independent of (∆U ) e . At a hybrid node, the merging rule holds for both V and U with the same inheritance weights, so by induction on the nodes (in preorder) we get that V u = α + U ⊤ u β + ϵ u at every node u in the network, with α = V ρ − U ⊤ ρ β, and with ϵ following a BM process with variance rate σ 2 starting at ϵ ρ = 0. Therefore SM-13 holds at the tips.</p><p>Consequently, we can apply formulas (SM-10) and (SM-11) to get maximum likelihood (or REML) estimates μX and ΣX of the joint expectation and variance rate matrix of X. We can then plug in these estimates in SM-14 to get:</p><p>where μV and μU are, respectively, the scalar and vector of size p extracted from μX for traits V and U , and, similarly, ΣV U , ΣUV , ΣV V and ΣUU are the sub-matrices of dimension 1 × p, p × 1, 1 × 1 and p × p extracted from ΣX . As calculating μX and ΣX via (SM-10) and (SM-11) has complexity O(|V |(k 3 + p 3 )) where |V | is the number of nodes in the network and k is the maximum cluster size, obtaining α, β and σ2 with SM-15 has that same complexity, which can be much smaller than O(n 3 ). If the phylogeny is a tree, this complexity depends linearly on n.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct coords="23,76.94,193.93,463.06,8.64;23,81.96,204.66,351.37,8.82" xml:id="b0">
	<analytic>
		<title level="a" type="main">Multivariate Phylogenetic Comparative Methods: Evaluations, Comparisons, and Recommendations</title>
		<author>
			<persName><forename type="first">Dean</forename><forename type="middle">C</forename><surname>Adams</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Michael</forename><forename type="middle">L</forename><surname>Collyer</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syx055</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="14" to="31" />
			<date type="published" when="2017-07-13">2017</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,220.77,468.00,8.82;23,81.79,231.68,458.21,8.88;23,81.96,243.17,337.73,8.30" xml:id="b1">
	<analytic>
		<title level="a" type="main">Scalable belief propagation via relaxed scheduling</title>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Aksenov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Alistarh</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">H</forename><surname>Korhonen</surname></persName>
		</author>
		<ptr target="https://proceedings.neurips.cc/paper_files/paper/2020/file/fdb2c3bab9d0701c4a050a4d8d782c7f-Paper.pdf" />
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems</title>
				<imprint>
			<date type="published" when="2020">2020</date>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="22361" to="22372" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,258.70,469.25,8.82;23,81.96,269.79,460.65,8.70;23,81.44,281.10,451.80,8.30;23,81.96,292.00,123.29,8.30" xml:id="b2">
	<monogr>
		<title level="m" type="main">Estimating Phylogenetic Networks from Concatenated Sequence Alignments</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Allen-Savietta</surname></persName>
		</author>
		<ptr target="https://ezproxy.library.wisc.edu/login?url=https://www.proquest.com/dissertations-theses/estimating-phylogenetic-networks-concatenated/docview/2476856270/se-2" />
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
		<respStmt>
			<orgName>University of Wisconsin-Madison</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">PhD thesis</note>
</biblStruct>

<biblStruct coords="23,72.00,307.72,468.00,8.64;23,81.96,318.45,405.72,8.82" xml:id="b3">
	<analytic>
		<title level="a" type="main">NANUQ: a method for inferring species networks from gene trees under the coalescent model</title>
		<author>
			<persName><forename type="first">Elizabeth</forename><forename type="middle">S</forename><surname>Allman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hector</forename><surname>Baños</surname></persName>
		</author>
		<author>
			<persName><forename type="first">John</forename><forename type="middle">A</forename><surname>Rhodes</surname></persName>
			<idno type="ORCID">0000-0001-9921-1091</idno>
		</author>
		<idno type="DOI">10.1186/s13015-019-0159-2</idno>
	</analytic>
	<monogr>
		<title level="j">Algorithms for Molecular Biology</title>
		<title level="j" type="abbrev">Algorithms Mol Biol</title>
		<idno type="ISSNe">1748-7188</idno>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">24</biblScope>
			<date type="published" when="2019-12">2019</date>
			<publisher>Springer Science and Business Media LLC</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,334.74,468.00,8.64;23,81.96,345.47,223.55,8.82" xml:id="b4">
	<monogr>
		<title level="m" type="main">Identifiability of level-1 species networks from gene tree quartets. arXiv</title>
		<author>
			<persName coords=""><forename type="first">E</forename><forename type="middle">S</forename><surname>Allman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Baños</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Garrote-Lopez</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Rhodes</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.2401.06290</idno>
		<imprint>
			<biblScope unit="page">2024</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,361.76,469.39,8.64;23,81.96,372.49,425.70,8.82" xml:id="b5">
	<analytic>
		<title level="a" type="main">Anomalous networks under the multispecies coalescent: theory and prevalence</title>
		<author>
			<persName><forename type="first">Cécile</forename><surname>Ané</surname></persName>
			<idno type="ORCID">0000-0002-4702-8217</idno>
		</author>
		<author>
			<persName><forename type="first">John</forename><surname>Fogg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Elizabeth</forename><forename type="middle">S</forename><surname>Allman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hector</forename><surname>Baños</surname></persName>
		</author>
		<author>
			<persName><forename type="first">John</forename><forename type="middle">A</forename><surname>Rhodes</surname></persName>
		</author>
		<idno type="DOI">10.1007/s00285-024-02050-7</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Mathematical Biology</title>
		<title level="j" type="abbrev">J. Math. Biol.</title>
		<idno type="ISSN">0303-6812</idno>
		<idno type="ISSNe">1432-1416</idno>
		<imprint>
			<biblScope unit="volume">88</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">29</biblScope>
			<date type="published" when="2024-02-19">2024</date>
			<publisher>Springer Science and Business Media LLC</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,388.60,468.00,8.82;23,81.36,399.50,293.02,8.82" xml:id="b6">
	<analytic>
		<title level="a" type="main">Complexity of Finding Embeddings in a &lt;i&gt;k&lt;/i&gt;-Tree</title>
		<author>
			<persName><forename type="first">Stefan</forename><surname>Arnborg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Derek</forename><forename type="middle">G</forename><surname>Corneil</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Andrzej</forename><surname>Proskurowski</surname></persName>
		</author>
		<idno type="DOI">10.1137/0608024</idno>
	</analytic>
	<monogr>
		<title level="j">SIAM Journal on Algebraic Discrete Methods</title>
		<title level="j" type="abbrev">SIAM. J. on Algebraic and Discrete Methods</title>
		<idno type="ISSN">0196-5212</idno>
		<idno type="ISSNe">2168-345X</idno>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="277" to="284" />
			<date type="published" when="1987-04">1987</date>
			<publisher>Society for Industrial &amp; Applied Mathematics (SIAM)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,415.62,469.38,8.82;23,81.96,426.70,206.76,8.64" xml:id="b7">
	<analytic>
		<title level="a" type="main">Hemiplasy: A New Term in the Lexicon of Phylogenetics</title>
		<author>
			<persName><forename type="first">John</forename><forename type="middle">C</forename><surname>Avise</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Terence</forename><forename type="middle">J</forename><surname>Robinson</surname></persName>
		</author>
		<idno type="DOI">10.1080/10635150802164587</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="503" to="507" />
			<date type="published" when="2008-06-01">2008</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,442.63,469.38,8.82;23,81.61,453.72,202.16,8.64" xml:id="b8">
	<analytic>
		<title level="a" type="main">Identifying Species Network Features from Gene Tree Quartets Under the Coalescent Model</title>
		<author>
			<persName coords=""><forename type="first">Hector</forename><surname>Baños</surname></persName>
		</author>
		<idno type="DOI">10.1007/s11538-018-0485-4</idno>
	</analytic>
	<monogr>
		<title level="j">Bulletin of Mathematical Biology</title>
		<title level="j" type="abbrev">Bull Math Biol</title>
		<idno type="ISSN">0092-8240</idno>
		<idno type="ISSNe">1522-9602</idno>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="494" to="534" />
			<date type="published" when="2019">2019</date>
			<publisher>Springer Science and Business Media LLC</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,469.65,468.56,8.82;23,81.96,480.74,346.36,8.70" xml:id="b9">
	<analytic>
		<title level="a" type="main">Bayesian Reasoning and Machine Learning</title>
		<author>
			<persName coords=""><forename type="first">David</forename><surname>Barber</surname></persName>
		</author>
		<idno type="DOI">10.1017/cbo9780511804779</idno>
		<ptr target="http://www.cs.ucl.ac.uk/staff/d.barber/brml/" />
	</analytic>
	<monogr>
		<title level="m">Bayesian Reasoning and Machine Learning</title>
				<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="2012-06-05">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,496.85,468.17,8.64;23,81.96,507.58,459.42,8.82;23,81.22,518.67,108.49,8.64" xml:id="b10">
	<analytic>
		<title level="a" type="main">A phylogenetic comparative method for studying multivariate adaptation</title>
		<author>
			<persName><forename type="first">Krzysztof</forename><surname>Bartoszek</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jason</forename><surname>Pienaar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Petter</forename><surname>Mostad</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Staffan</forename><surname>Andersson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Thomas</forename><forename type="middle">F</forename><surname>Hansen</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jtbi.2012.08.005</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Theoretical Biology</title>
		<title level="j" type="abbrev">Journal of Theoretical Biology</title>
		<idno type="ISSN">0022-5193</idno>
		<imprint>
			<biblScope unit="volume">314</biblScope>
			<biblScope unit="page" from="204" to="215" />
			<date type="published" when="2012-12">2012</date>
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,534.78,468.00,8.64;23,81.96,545.51,425.77,8.82" xml:id="b11">
	<analytic>
		<title level="a" type="main">Using the Ornstein–Uhlenbeck process to model the evolution of interacting populations</title>
		<author>
			<persName><forename type="first">Krzysztof</forename><surname>Bartoszek</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Sylvain</forename><surname>Glémin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ingemar</forename><surname>Kaj</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Martin</forename><surname>Lascoux</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jtbi.2017.06.011</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Theoretical Biology</title>
		<title level="j" type="abbrev">Journal of Theoretical Biology</title>
		<idno type="ISSN">0022-5193</idno>
		<imprint>
			<biblScope unit="volume">429</biblScope>
			<biblScope unit="page" from="35" to="45" />
			<date type="published" when="2017-09">2017</date>
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,561.80,468.00,8.64;23,81.96,572.71,458.04,8.64;23,81.96,583.44,331.55,8.82" xml:id="b12">
	<analytic>
		<title level="a" type="main">Model Selection Performance in Phylogenetic Comparative Methods Under Multivariate Ornstein–Uhlenbeck Models of Trait Evolution</title>
		<author>
			<persName><forename type="first">Krzysztof</forename><surname>Bartoszek</surname></persName>
			<idno type="ORCID">0000-0002-5816-4345</idno>
		</author>
		<author>
			<persName><forename type="first">Jesualdo</forename><surname>Fuentes-González</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Venelin</forename><surname>Mitov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jason</forename><surname>Pienaar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marcin</forename><surname>Piwczyński</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Radosław</forename><surname>Puchałka</surname></persName>
			<idno type="ORCID">0000-0002-4764-0705</idno>
		</author>
		<author>
			<persName><forename type="first">Krzysztof</forename><surname>Spalik</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kjetil</forename><forename type="middle">Lysne</forename><surname>Voje</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syac079</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">72</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="275" to="293" />
			<date type="published" when="2023">2023</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,599.73,469.74,8.64;23,81.60,610.46,459.64,8.82;23,81.71,621.55,459.33,8.70;23,81.96,632.85,75.71,8.30" xml:id="b13">
	<analytic>
		<title level="a" type="main">Analytical advances alleviate model misspecification in non-Brownian multivariate comparative methods</title>
		<author>
			<persName><forename type="first">Krzysztof</forename><surname>Bartoszek</surname></persName>
			<idno type="ORCID">0000-0002-5816-4345</idno>
		</author>
		<author>
			<persName><forename type="first">Jesualdo</forename><surname>Fuentes-González</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Venelin</forename><surname>Mitov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jason</forename><surname>Pienaar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marcin</forename><surname>Piwczyński</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Radosław</forename><surname>Puchałka</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Krzysztof</forename><surname>Spalik</surname></persName>
			<idno type="ORCID">0000-0001-9603-6793</idno>
		</author>
		<author>
			<persName><forename type="first">Kjetil</forename><forename type="middle">Lysne</forename><surname>Voje</surname></persName>
			<idno type="ORCID">0000-0003-2556-3080</idno>
		</author>
		<idno type="DOI">10.1093/evolut/qpad185</idno>
		<ptr target="https://doi.org/10.1093/evolut/qpad185" />
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<idno type="ISSNe">1558-5646</idno>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="389" to="400" />
			<date type="published" when="2024-03">Mar. 2024</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,648.57,469.74,8.64;23,81.71,659.30,381.27,8.82" xml:id="b14">
	<analytic>
		<title level="a" type="main">Inference of Adaptive Shifts for Multivariate Correlated Traits</title>
		<author>
			<persName><forename type="first">Paul</forename><surname>Bastide</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Cécile</forename><surname>Ané</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stéphane</forename><surname>Robin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mahendra</forename><surname>Mariadassou</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syy005</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="662" to="680" />
			<date type="published" when="2018-07">July 2018a</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,675.59,468.00,8.64;23,81.96,686.32,457.76,8.82" xml:id="b15">
	<analytic>
		<title level="a" type="main">Phylogenetic Comparative Methods on Phylogenetic Networks with Reticulations</title>
		<author>
			<persName><forename type="first">Paul</forename><surname>Bastide</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Claudia</forename><surname>Solís-Lemus</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ricardo</forename><surname>Kriebel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>William Sparks</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Cécile</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syy033</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="800" to="820" />
			<date type="published" when="2018-06-15">2018b</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="23,72.00,702.61,468.00,8.64;23,81.96,713.34,452.12,8.82" xml:id="b16">
	<analytic>
		<title level="a" type="main">Efficient Bayesian inference of general Gaussian models on large phylogenetic trees</title>
		<author>
			<persName><forename type="first">Paul</forename><surname>Bastide</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lam</forename><forename type="middle">Si Tung</forename><surname>Ho</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Guy</forename><surname>Baele</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Philippe</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marc</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1214/20-aoas1419</idno>
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Statistics</title>
		<title level="j" type="abbrev">Ann. Appl. Stat.</title>
		<idno type="ISSN">1932-6157</idno>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="971" to="997" />
			<date type="published" when="2021-06-01">2021</date>
			<publisher>Institute of Mathematical Statistics</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,75.48,469.25,8.64;24,81.96,86.21,459.43,8.82;24,81.22,97.30,103.20,8.64" xml:id="b17">
	<analytic>
		<title level="a" type="main">Origins and genetic legacy of prehistoric dogs</title>
		<author>
			<persName><forename type="first">Anders</forename><surname>Bergström</surname></persName>
			<idno type="ORCID">0000-0002-4096-9268</idno>
		</author>
		<author>
			<persName><forename type="first">Laurent</forename><surname>Frantz</surname></persName>
			<idno type="ORCID">0000-0001-8030-3885</idno>
		</author>
		<author>
			<persName><forename type="first">Ryan</forename><surname>Schmidt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Erik</forename><surname>Ersmark</surname></persName>
			<idno type="ORCID">0000-0003-4186-7498</idno>
		</author>
		<author>
			<persName><forename type="first">Ophelie</forename><surname>Lebrasseur</surname></persName>
			<idno type="ORCID">0000-0003-0687-8538</idno>
		</author>
		<author>
			<persName><forename type="first">Linus</forename><surname>Girdland-Flink</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Audrey</forename><forename type="middle">T</forename><surname>Lin</surname></persName>
			<idno type="ORCID">0000-0003-2505-1480</idno>
		</author>
		<author>
			<persName><forename type="first">Jan</forename><surname>Storå</surname></persName>
			<idno type="ORCID">0000-0001-6319-7857</idno>
		</author>
		<author>
			<persName><forename type="first">Karl-Göran</forename><surname>Sjögren</surname></persName>
			<idno type="ORCID">0000-0003-1791-3175</idno>
		</author>
		<author>
			<persName><forename type="first">David</forename><surname>Anthony</surname></persName>
			<idno type="ORCID">0000-0001-9122-0313</idno>
		</author>
		<author>
			<persName><forename type="first">Ekaterina</forename><surname>Antipina</surname></persName>
			<idno type="ORCID">0000-0002-3003-942X</idno>
		</author>
		<author>
			<persName><forename type="first">Sarieh</forename><surname>Amiri</surname></persName>
			<idno type="ORCID">0000-0002-6835-373X</idno>
		</author>
		<author>
			<persName><forename type="first">Guy</forename><surname>Bar-Oz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Vladimir</forename><forename type="middle">I</forename><surname>Bazaliiskii</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jelena</forename><surname>Bulatović</surname></persName>
			<idno type="ORCID">0000-0002-0672-067X</idno>
		</author>
		<author>
			<persName><forename type="first">Dorcas</forename><surname>Brown</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alberto</forename><surname>Carmagnini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tom</forename><surname>Davy</surname></persName>
			<idno type="ORCID">0000-0002-9466-5497</idno>
		</author>
		<author>
			<persName><forename type="first">Sergey</forename><surname>Fedorov</surname></persName>
			<idno type="ORCID">0000-0001-8179-740X</idno>
		</author>
		<author>
			<persName><forename type="first">Ivana</forename><surname>Fiore</surname></persName>
			<idno type="ORCID">0000-0001-5721-0760</idno>
		</author>
		<author>
			<persName><forename type="first">Deirdre</forename><surname>Fulton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mietje</forename><surname>Germonpré</surname></persName>
			<idno type="ORCID">0000-0001-8865-0937</idno>
		</author>
		<author>
			<persName><forename type="first">James</forename><surname>Haile</surname></persName>
			<idno type="ORCID">0000-0002-8521-8337</idno>
		</author>
		<author>
			<persName><forename type="first">Evan</forename><forename type="middle">K</forename><surname>Irving-Pease</surname></persName>
			<idno type="ORCID">0000-0003-1940-2192</idno>
		</author>
		<author>
			<persName><forename type="first">Alexandra</forename><surname>Jamieson</surname></persName>
			<idno type="ORCID">0000-0003-0979-5762</idno>
		</author>
		<author>
			<persName><forename type="first">Luc</forename><surname>Janssens</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Irina</forename><surname>Kirillova</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Liora</forename><forename type="middle">Kolska</forename><surname>Horwitz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Julka</forename><surname>Kuzmanovic-Cvetković</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yaroslav</forename><surname>Kuzmin</surname></persName>
			<idno type="ORCID">0000-0002-4512-2269</idno>
		</author>
		<author>
			<persName><forename type="first">Robert</forename><forename type="middle">J</forename><surname>Losey</surname></persName>
			<idno type="ORCID">0000-0003-3615-8160</idno>
		</author>
		<author>
			<persName><forename type="first">Daria</forename><forename type="middle">Ložnjak</forename><surname>Dizdar</surname></persName>
			<idno type="ORCID">0000-0002-5769-2269</idno>
		</author>
		<author>
			<persName><forename type="first">Marjan</forename><surname>Mashkour</surname></persName>
			<idno type="ORCID">0000-0003-3630-9459</idno>
		</author>
		<author>
			<persName><forename type="first">Mario</forename><surname>Novak</surname></persName>
			<idno type="ORCID">0000-0002-4567-8742</idno>
		</author>
		<author>
			<persName><forename type="first">Vedat</forename><surname>Onar</surname></persName>
			<idno type="ORCID">0000-0002-8359-243X</idno>
		</author>
		<author>
			<persName><forename type="first">David</forename><surname>Orton</surname></persName>
			<idno type="ORCID">0000-0003-4069-8004</idno>
		</author>
		<author>
			<persName><forename type="first">Maja</forename><surname>Pasarić</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Miljana</forename><surname>Radivojević</surname></persName>
			<idno type="ORCID">0000-0001-7329-305X</idno>
		</author>
		<author>
			<persName><forename type="first">Dragana</forename><surname>Rajković</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Benjamin</forename><surname>Roberts</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hannah</forename><surname>Ryan</surname></persName>
			<idno type="ORCID">0000-0002-4320-4594</idno>
		</author>
		<author>
			<persName><forename type="first">Mikhail</forename><surname>Sablin</surname></persName>
			<idno type="ORCID">0000-0002-2773-7454</idno>
		</author>
		<author>
			<persName><forename type="first">Fedor</forename><surname>Shidlovskiy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ivana</forename><surname>Stojanović</surname></persName>
			<idno type="ORCID">0000-0001-5271-680X</idno>
		</author>
		<author>
			<persName><forename type="first">Antonio</forename><surname>Tagliacozzo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Katerina</forename><surname>Trantalidou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Inga</forename><surname>Ullén</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Aritza</forename><surname>Villaluenga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Paula</forename><surname>Wapnish</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Keith</forename><surname>Dobney</surname></persName>
			<idno type="ORCID">0000-0001-9036-4681</idno>
		</author>
		<author>
			<persName><forename type="first">Anders</forename><surname>Götherström</surname></persName>
			<idno type="ORCID">0000-0001-6307-8188</idno>
		</author>
		<author>
			<persName><forename type="first">Anna</forename><surname>Linderholm</surname></persName>
			<idno type="ORCID">0000-0002-1613-9926</idno>
		</author>
		<author>
			<persName><forename type="first">Love</forename><surname>Dalén</surname></persName>
			<idno type="ORCID">0000-0001-8270-7613</idno>
		</author>
		<author>
			<persName><forename type="first">Ron</forename><surname>Pinhasi</surname></persName>
			<idno type="ORCID">0000-0003-1629-8131</idno>
		</author>
		<author>
			<persName><forename type="first">Greger</forename><surname>Larson</surname></persName>
			<idno type="ORCID">0000-0002-4092-0392</idno>
		</author>
		<author>
			<persName><forename type="first">Pontus</forename><surname>Skoglund</surname></persName>
			<idno type="ORCID">0000-0002-3021-5913</idno>
		</author>
		<idno type="DOI">10.1126/science.aba9572</idno>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<title level="j" type="abbrev">Science</title>
		<idno type="ISSN">0036-8075</idno>
		<idno type="ISSNe">1095-9203</idno>
		<imprint>
			<biblScope unit="volume">370</biblScope>
			<biblScope unit="issue">6516</biblScope>
			<biblScope unit="page" from="557" to="564" />
			<date type="published" when="2020-10-30">2020</date>
			<publisher>American Association for the Advancement of Science (AAAS)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,112.95,468.00,8.82;24,81.96,123.86,458.03,8.59;24,81.79,134.77,459.59,8.82;24,81.22,145.86,136.19,8.64" xml:id="b18">
	<analytic>
		<title level="a" type="main">Scanning phylogenetic networks is np-hard</title>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Berry</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Scornavacca</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Weller</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-030-38919-2\42</idno>
	</analytic>
	<monogr>
		<title level="m">SOFSEM 2020: Theory and Practice of Computer Science: 46th International Conference on Current Trends in Theory and Practice of Informatics, SOFSEM 2020</title>
				<meeting><address><addrLine>Limassol, Cyprus</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2020">January 20-24, 2020. 2020</date>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="519" to="530" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,161.52,469.24,8.82;24,81.96,172.61,181.30,8.64" xml:id="b19">
	<analytic>
		<title level="a" type="main">Julia: A Fresh Approach to Numerical Computing</title>
		<author>
			<persName><forename type="first">Jeff</forename><surname>Bezanson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alan</forename><surname>Edelman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stefan</forename><surname>Karpinski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Viral</forename><forename type="middle">B</forename><surname>Shah</surname></persName>
		</author>
		<idno type="DOI">10.1137/141000671</idno>
	</analytic>
	<monogr>
		<title level="j">SIAM Review</title>
		<title level="j" type="abbrev">SIAM Rev.</title>
		<idno type="ISSN">0036-1445</idno>
		<idno type="ISSNe">1095-7200</idno>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="65" to="98" />
			<date type="published" when="2017-01">2017</date>
			<publisher>Society for Industrial &amp; Applied Mathematics (SIAM)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,188.26,469.74,8.82;24,81.96,199.35,71.95,8.64" xml:id="b20">
	<analytic>
		<title level="a" type="main">On triangulating &lt;mml:math xmlns:mml=&quot;http://www.w3.org/1998/Math/MathML&quot; altimg=&quot;si11.gif&quot; display=&quot;inline&quot; overflow=&quot;scroll&quot;&gt;&lt;mml:mi&gt;k&lt;/mml:mi&gt;&lt;/mml:math&gt;-outerplanar graphs</title>
		<author>
			<persName coords=""><forename type="first">Therese</forename><surname>Biedl</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.dam.2014.10.017</idno>
	</analytic>
	<monogr>
		<title level="j">Discrete Applied Mathematics</title>
		<title level="j" type="abbrev">Discrete Applied Mathematics</title>
		<idno type="ISSN">0166-218X</idno>
		<imprint>
			<biblScope unit="volume">181</biblScope>
			<biblScope unit="page" from="275" to="279" />
			<date type="published" when="2015-01">2015</date>
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,215.01,468.00,8.82;24,81.96,225.92,280.68,8.82" xml:id="b21">
	<analytic>
		<title level="a" type="main">An introduction to chordal graphs and clique trees</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">R</forename><surname>Blair</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Peyton</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-1-4613-8369-7\1</idno>
	</analytic>
	<monogr>
		<title level="m">Graph theory and sparse matrix computation</title>
				<imprint>
			<date type="published" when="1993">1993</date>
			<biblScope unit="page" from="1" to="29" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,241.94,468.00,8.64;24,81.96,252.67,392.36,8.82" xml:id="b22">
	<analytic>
		<title level="a" type="main">TESTING FOR PHYLOGENETIC SIGNAL IN COMPARATIVE DATA: BEHAVIORAL TRAITS ARE MORE LABILE</title>
		<author>
			<persName><forename type="first">Simon</forename><forename type="middle">P</forename><surname>Blomberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Theodore</forename><surname>Garland</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Anthony</forename><forename type="middle">R</forename><surname>Ives</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.0014-3820.2003.tb00285.x</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<title level="j" type="abbrev">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<idno type="ISSNe">1558-5646</idno>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="717" to="745" />
			<date type="published" when="2003-04">2003</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,268.50,469.38,8.82;24,81.22,279.59,279.97,8.64" xml:id="b23">
	<analytic>
		<title level="a" type="main">A partial k-arboretum of graphs with bounded treewidth</title>
		<author>
			<persName coords=""><forename type="first">Hans</forename><forename type="middle">L</forename><surname>Bodlaender</surname></persName>
		</author>
		<idno type="DOI">10.1016/s0304-3975(97)00228-4</idno>
	</analytic>
	<monogr>
		<title level="j">Theoretical Computer Science</title>
		<title level="j" type="abbrev">Theoretical Computer Science</title>
		<idno type="ISSN">0304-3975</idno>
		<imprint>
			<biblScope unit="volume">209</biblScope>
			<biblScope unit="issue">1-2</biblScope>
			<biblScope unit="page" from="1" to="45" />
			<date type="published" when="1998-12">1998</date>
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,295.25,469.39,8.82;24,81.96,306.34,186.84,8.64" xml:id="b24">
	<analytic>
		<title level="a" type="main">Treewidth computations I. Upper bounds</title>
		<author>
			<persName><forename type="first">Hans</forename><forename type="middle">L</forename><surname>Bodlaender</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Arie</forename><forename type="middle">M C A</forename><surname>Koster</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.ic.2009.03.008</idno>
	</analytic>
	<monogr>
		<title level="j">Information and Computation</title>
		<title level="j" type="abbrev">Information and Computation</title>
		<idno type="ISSN">0890-5401</idno>
		<imprint>
			<biblScope unit="volume">208</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="259" to="275" />
			<date type="published" when="2010-03">2010</date>
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,322.00,468.00,8.82;24,81.65,332.91,315.90,8.82" xml:id="b25">
	<analytic>
		<title level="a" type="main">Generalized hidden Markov models for phylogenetic comparative datasets</title>
		<author>
			<persName><forename type="first">James</forename><forename type="middle">D</forename><surname>Boyko</surname></persName>
			<idno type="ORCID">0000-0003-0952-169X</idno>
		</author>
		<author>
			<persName><forename type="first">Jeremy</forename><forename type="middle">M</forename><surname>Beaulieu</surname></persName>
		</author>
		<idno type="DOI">10.1111/2041-210x.13534</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<title level="j" type="abbrev">Methods Ecol Evol</title>
		<idno type="ISSN">2041-210X</idno>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="468" to="478" />
			<date type="published" when="2021">2021</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,348.92,467.99,8.64;24,81.96,359.65,323.91,8.82" xml:id="b26">
	<analytic>
		<title level="a" type="main">A novel method for jointly modeling the evolution of discrete and continuous traits</title>
		<author>
			<persName><forename type="first">James</forename><forename type="middle">D</forename><surname>Boyko</surname></persName>
			<idno type="ORCID">0000-0003-0952-169X</idno>
		</author>
		<author>
			<persName><forename type="first">Brian</forename><forename type="middle">C</forename><surname>O’meara</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jeremy</forename><forename type="middle">M</forename><surname>Beaulieu</surname></persName>
		</author>
		<idno type="DOI">10.1093/evolut/qpad002</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<idno type="ISSNe">1558-5646</idno>
		<imprint>
			<biblScope unit="volume">77</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="836" to="851" />
			<date type="published" when="2023-01-03">2023</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,375.67,468.00,8.64;24,81.96,386.40,459.42,8.82;24,81.22,397.49,194.90,8.64" xml:id="b27">
	<analytic>
		<title level="a" type="main">Inferring Species Trees Directly from Biallelic Genetic Markers: Bypassing Gene Trees in a Full Coalescent Analysis</title>
		<author>
			<persName><forename type="first">David</forename><surname>Bryant</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Remco</forename><surname>Bouckaert</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Noah</forename><forename type="middle">A</forename><surname>Rosenberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Arindam</forename><surname>Roychoudhury</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/mss086</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<idno type="ISSN">0737-4038</idno>
		<idno type="ISSNe">1537-1719</idno>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1917" to="1932" />
			<date type="published" when="2012-03-14">2012</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,413.14,468.00,8.82;24,81.63,424.23,193.48,8.64" xml:id="b28">
	<analytic>
		<title level="a" type="main">Estimating Correlated Rates of Trait Evolution with Uncertainty</title>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">S</forename><surname>Caetano</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">J</forename><surname>Harmon</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syy067</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="412" to="429" />
			<date type="published" when="2019">2019</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,439.89,468.36,8.82;24,81.39,450.98,340.63,8.64" xml:id="b29">
	<analytic>
		<title level="a" type="main">Inference in Hidden Markov Models</title>
		<author>
			<persName><forename type="first">Olivier</forename><surname>Cappé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Eric</forename><surname>Moulines</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tobias</forename><surname>Rydén</surname></persName>
		</author>
		<idno type="DOI">10.1007/0-387-28982-8</idno>
	</analytic>
	<monogr>
		<title level="s">Springer Series in Statistics</title>
		<idno type="ISSN">0172-7397</idno>
		<imprint>
			<date type="published" when="2005">2005</date>
			<publisher>Springer New York</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,466.82,468.00,8.64;24,81.96,477.55,458.04,8.82;24,81.96,488.63,238.88,8.64" xml:id="b30">
	<analytic>
		<title level="a" type="main">Snakes and ladders: A treewidth story</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Chaplick</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Kelk</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Meuwese</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Mihalák</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Stamoulis</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-031-43380-1\14</idno>
	</analytic>
	<monogr>
		<title level="m">Graph-Theoretic Concepts in Computer Science</title>
				<editor>
			<persName><forename type="first">D</forename><surname>Paulusma</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">B</forename><surname>Ries</surname></persName>
		</editor>
		<imprint>
			<date type="published" when="2023">2023</date>
			<biblScope unit="page" from="187" to="200" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,504.29,468.00,8.82;24,81.96,515.20,377.48,8.82" xml:id="b31">
	<analytic>
		<title level="a" type="main">Accelerated body size evolution during cold climatic periods in the Cenozoic</title>
		<author>
			<persName><forename type="first">Julien</forename><surname>Clavel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hélène</forename><surname>Morlon</surname></persName>
		</author>
		<idno type="DOI">10.1073/pnas.1606868114</idno>
	</analytic>
	<monogr>
		<title level="j">Proceedings of the National Academy of Sciences</title>
		<title level="j" type="abbrev">Proc. Natl. Acad. Sci. U.S.A.</title>
		<idno type="ISSN">0027-8424</idno>
		<idno type="ISSNe">1091-6490</idno>
		<imprint>
			<biblScope unit="volume">114</biblScope>
			<biblScope unit="issue">16</biblScope>
			<biblScope unit="page" from="4183" to="4188" />
			<date type="published" when="2017-04-03">2017</date>
			<publisher>Proceedings of the National Academy of Sciences</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,531.22,468.00,8.64;24,81.96,541.95,454.52,8.82" xml:id="b32">
	<analytic>
		<title level="a" type="main">mv&lt;scp&gt;morph&lt;/scp&gt;: an &lt;scp&gt;r&lt;/scp&gt; package for fitting multivariate evolutionary models to morphometric data</title>
		<author>
			<persName><forename type="first">Julien</forename><surname>Clavel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gilles</forename><surname>Escarguel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gildas</forename><surname>Merceron</surname></persName>
		</author>
		<idno type="DOI">10.1111/2041-210x.12420</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<title level="j" type="abbrev">Methods Ecol Evol</title>
		<idno type="ISSN">2041-210X</idno>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1311" to="1319" />
			<date type="published" when="2015-07-14">2015</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,557.79,468.00,8.82;24,81.96,568.87,230.83,8.64" xml:id="b33">
	<monogr>
		<title level="m" type="main">Introduction to Algorithms, Third Edition</title>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">H</forename><surname>Cormen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">E</forename><surname>Leiserson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">L</forename><surname>Rivest</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Stein</surname></persName>
		</author>
		<idno type="DOI">10.5555/1614191</idno>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Mit Press</publisher>
		</imprint>
	</monogr>
	<note>3rd edition</note>
</biblStruct>

<biblStruct coords="24,72.00,584.71,468.00,8.64;24,81.96,595.44,459.78,8.82;24,81.96,606.53,458.82,8.70" xml:id="b34">
	<analytic>
		<title level="a" type="main">Assessing phenotypic correlation through the multivariate phylogenetic latent liability model</title>
		<author>
			<persName><forename type="first">Gabriela</forename><forename type="middle">B</forename><surname>Cybis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Janet</forename><forename type="middle">S</forename><surname>Sinsheimer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Trevor</forename><surname>Bedford</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alison</forename><forename type="middle">E</forename><surname>Mather</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Philippe</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marc</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1214/15-aoas821</idno>
		<ptr target="http://projecteuclid.org/euclid.aoas/1437397120" />
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Statistics</title>
		<title level="j" type="abbrev">Ann. Appl. Stat.</title>
		<idno type="ISSN">1932-6157</idno>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="969" to="991" />
			<date type="published" when="2015-06-01">2015</date>
			<publisher>Institute of Mathematical Statistics</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,622.37,468.00,8.64;24,81.96,633.10,426.95,8.82" xml:id="b35">
	<analytic>
		<title level="a" type="main">Maximum likelihood pandemic-scale phylogenetics</title>
		<author>
			<persName coords=""><forename type="first">N</forename><forename type="middle">De</forename><surname>Maio</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Kalaghatgi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Turakhia</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Corbett-Detig</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">Q</forename><surname>Minh</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Goldman</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41588-023-01368-0</idno>
	</analytic>
	<monogr>
		<title level="j">Nature Genetics</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="746" to="752" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,649.11,468.00,8.64;24,81.96,659.84,372.57,8.82" xml:id="b36">
	<analytic>
		<title level="a" type="main">Estimating the Effect of Competition on Trait Evolution Using Maximum Likelihood Inference</title>
		<author>
			<persName><forename type="first">Jonathan</forename><surname>Drury</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Julien</forename><surname>Clavel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marc</forename><surname>Manceau</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hélène</forename><surname>Morlon</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syw020</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<title level="j" type="abbrev">Syst Biol</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="700" to="710" />
			<date type="published" when="2016-03-09">2016</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,675.86,467.99,8.64;24,81.96,686.59,380.39,8.82" xml:id="b37">
	<analytic>
		<title level="a" type="main">Linking micro and macroevolution in the presence of migration</title>
		<author>
			<persName><forename type="first">Pablo</forename><surname>Duchen</surname></persName>
			<idno type="ORCID">0000-0002-9318-5002</idno>
		</author>
		<author>
			<persName><forename type="first">Sophie</forename><surname>Hautphenne</surname></persName>
			<idno type="ORCID">0000-0002-8361-1901</idno>
		</author>
		<author>
			<persName><forename type="first">Laurent</forename><surname>Lehmann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Nicolas</forename><surname>Salamin</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jtbi.2019.110087</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Theoretical Biology</title>
		<title level="j" type="abbrev">Journal of Theoretical Biology</title>
		<idno type="ISSN">0022-5193</idno>
		<imprint>
			<biblScope unit="volume">486</biblScope>
			<biblScope unit="page">110087</biblScope>
			<date type="published" when="2020-02">2020</date>
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="24,72.00,702.43,468.00,8.82;24,81.63,713.51,176.32,8.64" xml:id="b38">
	<analytic>
		<title level="a" type="main">Phylogenetic Analysis of Gene Expression</title>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">W</forename><surname>Dunn</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">X</forename><surname>Luo</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Wu</surname></persName>
		</author>
		<idno type="DOI">10.1093/icb/ict068</idno>
	</analytic>
	<monogr>
		<title level="j">Integrative and Comparative Biology</title>
		<title level="j" type="abbrev">Integrative and Comparative Biology</title>
		<idno type="ISSN">1540-7063</idno>
		<idno type="ISSNe">1557-7023</idno>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="847" to="856" />
			<date type="published" when="2013-06-07">2013</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,75.48,468.00,8.64;25,81.96,86.21,459.28,8.82;25,81.96,97.30,103.49,8.64" xml:id="b39">
	<analytic>
		<title level="a" type="main">Residual belief propagation: informed scheduling for asynchronous message passing</title>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Elidan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">I</forename><surname>Mcgraw</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Koller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence</title>
				<meeting>the Twenty-Second Conference on Uncertainty in Artificial Intelligence</meeting>
		<imprint>
			<date type="published" when="2006">2006</date>
			<biblScope unit="page" from="165" to="173" />
		</imprint>
	</monogr>
	<note>ISBN 0974903922</note>
</biblStruct>

<biblStruct coords="25,72.00,112.65,468.00,8.82;25,81.96,123.56,133.83,8.82" xml:id="b40">
	<analytic>
		<title level="a" type="main">Maximum Likelihood and Minimum-Steps Methods for Estimating Evolutionary Trees from Data on Discrete Characters</title>
		<author>
			<persName coords=""><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.2307/2412304</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Zoology</title>
		<title level="j" type="abbrev">Systematic Zoology</title>
		<idno type="ISSN">0039-7989</idno>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">240</biblScope>
			<date type="published" when="1973-09">1973</date>
			<publisher>JSTOR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,139.10,468.00,8.82;25,81.65,150.01,242.19,8.82" xml:id="b41">
	<analytic>
		<title level="a" type="main">Evolutionary trees from DNA sequences: A maximum likelihood approach</title>
		<author>
			<persName coords=""><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1007/bf01734359</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Molecular Evolution</title>
		<title level="j" type="abbrev">J Mol Evol</title>
		<idno type="ISSN">0022-2844</idno>
		<idno type="ISSNe">1432-1432</idno>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="368" to="376" />
			<date type="published" when="1981-11">1981</date>
			<publisher>Springer Science and Business Media LLC</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,165.55,410.32,8.82" xml:id="b42">
	<analytic>
		<title level="a" type="main">Phylogenies and the Comparative Method</title>
		<author>
			<persName coords=""><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1086/284325</idno>
	</analytic>
	<monogr>
		<title level="j">The American Naturalist</title>
		<title level="j" type="abbrev">The American Naturalist</title>
		<idno type="ISSN">0003-0147</idno>
		<idno type="ISSNe">1537-5323</idno>
		<imprint>
			<biblScope unit="volume">125</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="15" />
			<date type="published" when="1985-01">1985</date>
			<publisher>University of Chicago Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,181.09,467.99,8.82;25,81.96,192.00,458.59,8.82;25,81.96,203.08,64.76,8.64" xml:id="b43">
	<analytic>
		<title level="a" type="main">Optimizing exact genetic linkage computations</title>
		<author>
			<persName><forename type="first">Maáyan</forename><surname>Fishelson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Dan</forename><surname>Geiger</surname></persName>
		</author>
		<idno type="DOI">10.1145/640075.640089</idno>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the seventh annual international conference on Research in computational molecular biology</title>
				<meeting>the seventh annual international conference on Research in computational molecular biology</meeting>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2003-04-10">2003</date>
			<biblScope unit="page" from="114" to="121" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,218.44,469.25,8.82;25,81.77,229.53,162.21,8.64" xml:id="b44">
	<analytic>
		<title level="a" type="main">Relaxed Random Walks at Scale</title>
		<author>
			<persName><forename type="first">Alexander</forename><forename type="middle">A</forename><surname>Fisher</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Xiang</forename><surname>Ji</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Zhenyu</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Philippe</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marc</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syaa056</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="258" to="267" />
			<date type="published" when="2021-07">July 2021</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,244.89,468.00,8.82;25,81.65,255.80,303.56,8.82" xml:id="b45">
	<analytic>
		<title level="a" type="main">Diversitree: comparative phylogenetic analyses of diversification in R</title>
		<author>
			<persName coords=""><forename type="first">Richard</forename><forename type="middle">G</forename><surname>Fitzjohn</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2041-210x.2012.00234.x</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<title level="j" type="abbrev">Methods Ecol Evol</title>
		<idno type="ISSN">2041-210X</idno>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="1084" to="1092" />
			<date type="published" when="2012-08-06">2012</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,271.52,467.99,8.64;25,81.96,282.25,271.45,8.82" xml:id="b46">
	<analytic>
		<title level="a" type="main">Evaluating probabilistic programming and fast variational Bayesian inference in phylogenetics</title>
		<author>
			<persName><forename type="first">Mathieu</forename><surname>Fourment</surname></persName>
			<idno type="ORCID">0000-0001-8153-9822</idno>
		</author>
		<author>
			<persName><forename type="first">Aaron</forename><forename type="middle">E</forename><surname>Darling</surname></persName>
			<idno type="ORCID">0000-0003-2397-7925</idno>
		</author>
		<idno type="DOI">10.7717/peerj.8272</idno>
	</analytic>
	<monogr>
		<title level="j">PeerJ</title>
		<idno type="ISSNe">2167-8359</idno>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">e8272</biblScope>
			<date type="published" when="2019-12-18">Dec. 2019</date>
			<publisher>PeerJ</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,297.96,468.00,8.64;25,81.96,308.69,459.28,8.82;25,81.77,319.78,438.27,8.70" xml:id="b47">
	<analytic>
		<title level="a" type="main">Automatic Differentiation is no Panacea for Phylogenetic Gradient Computation</title>
		<author>
			<persName><forename type="first">Mathieu</forename><surname>Fourment</surname></persName>
			<idno type="ORCID">0000-0001-8153-9822</idno>
		</author>
		<author>
			<persName><forename type="first">Christiaan</forename><forename type="middle">J</forename><surname>Swanepoel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jared</forename><forename type="middle">G</forename><surname>Galloway</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Xiang</forename><surname>Ji</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Karthik</forename><surname>Gangavarapu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marc</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
			<idno type="ORCID">0000-0001-9818-479X</idno>
		</author>
		<author>
			<persName><forename type="first">Frederick</forename><forename type="middle">A</forename><surname>Matsen Iv</surname></persName>
			<idno type="ORCID">0000-0003-0607-6025</idno>
		</author>
		<idno type="DOI">10.1093/gbe/evad099</idno>
		<ptr target="https://doi.org/10.1093/gbe/evad099" />
	</analytic>
	<monogr>
		<title level="j">Genome Biology and Evolution</title>
		<idno type="ISSN">1759-6653</idno>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page">99</biblScope>
			<date type="published" when="2023-06-01">June 2023</date>
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,335.14,469.38,8.82;25,81.96,346.23,230.50,8.64" xml:id="b48">
	<analytic>
		<title level="a" type="main">Fast likelihood calculations for comparative analyses</title>
		<author>
			<persName coords=""><forename type="first">Robert</forename><forename type="middle">P</forename><surname>Freckleton</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2041-210x.2012.00220.x</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<title level="j" type="abbrev">Methods Ecol Evol</title>
		<idno type="ISSN">2041-210X</idno>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="940" to="947" />
			<date type="published" when="2012-07-11">2012</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,361.59,468.00,8.82;25,81.63,372.50,381.58,8.82" xml:id="b49">
	<analytic>
		<title level="a" type="main">The structure of level-k phylogenetic networks</title>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Gambette</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Berry</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Paul</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-642-02441-2\26</idno>
	</analytic>
	<monogr>
		<title level="m">Annual Symposium on Combinatorial Pattern Matching</title>
				<imprint>
			<date type="published" when="2009">2009</date>
			<biblScope unit="page" from="289" to="300" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,388.22,467.99,8.64;25,81.96,398.95,458.03,8.82;25,81.22,410.03,459.83,8.70;25,81.70,421.34,81.44,8.30" xml:id="b50">
	<analytic>
		<title level="a" type="main">f-Statistics estimation and admixture graph construction with Pool-Seq or allele count data using the R package poolfstat</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Gautier</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Vitalis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Flori</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Estoup</surname></persName>
		</author>
		<idno type="DOI">10.1111/1755-0998.13557</idno>
		<ptr target="https://onlinelibrary.wiley.com/doi/abs/10.1111/1755-0998.13557" />
	</analytic>
	<monogr>
		<title level="j">Molecular Ecology Resources</title>
		<idno type="ISSN">1755-0998</idno>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1394" to="1416" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,436.48,468.00,8.64;25,81.96,447.21,459.78,8.82;25,81.22,458.30,27.40,8.64" xml:id="b51">
	<analytic>
		<title level="a" type="main">Rphylopars: fast multivariate phylogenetic comparative methods for missing data and within-species variation</title>
		<author>
			<persName coords=""><forename type="first">E</forename><forename type="middle">W</forename><surname>Goolsby</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Bruggeman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.1111/2041-210X.12612</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="22" to="27" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,76.55,473.66,464.83,8.82;25,81.22,484.75,97.97,8.64" xml:id="b52">
	<analytic>
		<title level="a" type="main">Ancestral inference in population genetics</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Griffiths</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Tavaré</surname></persName>
		</author>
		<idno type="DOI">10.1214/ss/1177010378</idno>
	</analytic>
	<monogr>
		<title level="j">Statistical science</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="307" to="319" />
			<date type="published" when="1994">1994</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,500.29,468.00,8.64;25,81.96,511.02,459.42,8.82;25,81.22,522.10,122.70,8.64" xml:id="b53">
	<analytic>
		<title level="a" type="main">Distinguishing level-1 phylogenetic networks on the basis of data generated by Markov processes</title>
		<author>
			<persName coords=""><forename type="first">E</forename><surname>Gross</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Van Iersel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Janssen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Jones</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Long</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Murakami</surname></persName>
		</author>
		<idno type="DOI">10.1007/s00285-021-01653-8</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Mathematical Biology</title>
		<imprint>
			<biblScope unit="volume">83</biblScope>
			<biblScope unit="page">2021</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,537.64,468.00,8.64;25,81.96,548.37,411.04,8.82" xml:id="b54">
	<analytic>
		<title level="a" type="main">A decomposition theory for phylogenetic networks and incompatible characters</title>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Gusfield</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Bansal</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Bafna</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><forename type="middle">S</forename><surname>Song</surname></persName>
		</author>
		<idno type="DOI">10.1089/cmb.2006.0137</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Computational Biology</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="1247" to="1272" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,564.09,469.74,8.64;25,81.96,574.82,459.42,8.82;25,81.22,585.91,122.70,8.64" xml:id="b55">
	<analytic>
		<title level="a" type="main">Initial upper palaeolithic humans in europe had recent neanderthal ancestry</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Hajdinjak</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Mafessoni</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Skov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Vernot</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Hübner</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Q</forename><surname>Fu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">E</forename><surname>Essel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Nagel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Nickel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Richter</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41586-021-03335-3</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">592</biblScope>
			<biblScope unit="issue">7853</biblScope>
			<biblScope unit="page" from="253" to="257" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,601.27,469.25,8.82;25,81.96,612.35,154.74,8.64" xml:id="b56">
	<analytic>
		<title level="a" type="main">Graph bisection with pareto optimization</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Hamann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Strasser</surname></persName>
		</author>
		<idno type="DOI">10.1145/3173045</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Experimental Algorithmics (JEA)</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="1" to="34" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,627.71,469.39,8.82;25,81.22,638.80,151.60,8.64" xml:id="b57">
	<analytic>
		<title level="a" type="main">Stabilizing selection and the comparative analysis of adaptation</title>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">F</forename><surname>Hansen</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.1558-5646.1997.tb01457.x</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="1341" to="1351" />
			<date type="published" when="1997">1997</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,654.34,469.25,8.64;25,81.96,665.25,459.28,8.64;25,81.96,676.16,458.04,8.64;25,81.96,686.89,329.00,8.82" xml:id="b58">
	<analytic>
		<title level="a" type="main">Early burst of body size and shape evolution are rare in comparatice data</title>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">J</forename><surname>Harmon</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">B</forename><surname>Losos</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">J</forename><surname>Davies</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">G</forename><surname>Gillespie</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">L</forename><surname>Gittleman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><forename type="middle">B</forename><surname>Jennings</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><forename type="middle">H</forename><surname>Kozak</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Mcpeek</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Moreno-Roark</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">J</forename><surname>Near</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Purvis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">E</forename><surname>Ricklefs</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Schluter</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Schulte</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">I</forename><forename type="middle">I</forename></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">O</forename><surname>Seehausen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">L</forename><surname>Sidlauskas</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">O</forename><surname>Torres-Carvajal</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">T</forename><surname>Weir</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">Ø</forename><surname>Mooers</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.1558-5646.2010.01025.x</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="2385" to="2396" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="25,72.00,702.43,469.25,8.82;25,81.22,713.51,147.55,8.64" xml:id="b59">
	<analytic>
		<title level="a" type="main">Bayesian inference for variance components using only error contrasts</title>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">A</forename><surname>Harville</surname></persName>
		</author>
		<idno type="DOI">10.1093/biomet/61.2.383</idno>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="383" to="385" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,75.48,468.00,8.64;26,81.96,86.21,459.42,8.82;26,81.96,97.30,226.13,8.64" xml:id="b60">
	<analytic>
		<title level="a" type="main">Inferring phenotypic trait evolution on large trees with many incomplete measurements</title>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Hassler</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">R</forename><surname>Tolkoff</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><forename type="middle">L</forename><surname>Allen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">S T</forename><surname>Ho</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1080/01621459.2020.1799812</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">117</biblScope>
			<biblScope unit="issue">538</biblScope>
			<biblScope unit="page" from="678" to="692" />
			<date type="published" when="2022">2022a</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,113.38,469.74,8.64;26,81.96,124.11,458.04,8.82;26,81.96,135.02,300.79,8.82" xml:id="b61">
	<analytic>
		<title level="a" type="main">Principled, practical, flexible, fast: A new approach to phylogenetic factor analysis</title>
		<author>
			<persName coords=""><forename type="first">G</forename><forename type="middle">W</forename><surname>Hassler</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Gallone</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Aristide</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><forename type="middle">L</forename><surname>Allen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">R</forename><surname>Tolkoff</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">J</forename><surname>Holbrook</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Baele</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1111/2041-210X.13920</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="2181" to="2197" />
			<date type="published" when="2022">2022b</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,151.28,468.00,8.64;26,81.96,162.01,458.59,8.82;26,81.96,173.10,139.87,8.64" xml:id="b62">
	<analytic>
		<title level="a" type="main">Data integration in Bayesian phylogenetics</title>
		<author>
			<persName coords=""><forename type="first">G</forename><forename type="middle">W</forename><surname>Hassler</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">F</forename><surname>Magee</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Baele</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">X</forename><surname>Ji</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Fourment</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1146/annurev-statistics-033021-112532</idno>
	</analytic>
	<monogr>
		<title level="j">Annual Review of Statistics and Its Application</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="353" to="377" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,189.00,468.00,8.82;26,81.36,199.91,248.71,8.82" xml:id="b63">
	<monogr>
		<title level="m" type="main">Dots on a screen: The past, present, and future of morphometrics in the study of nonavian dinosaurs. The Anatomical Record</title>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">P</forename><surname>Hedrick</surname></persName>
		</author>
		<idno type="DOI">10.1002/ar.25183</idno>
		<imprint>
			<date type="published" when="2023">2023</date>
			<biblScope unit="page" from="1" to="22" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,216.00,468.00,8.82;26,81.65,226.91,459.39,8.88;26,81.96,238.39,327.27,8.30" xml:id="b64">
	<analytic>
		<title level="a" type="main">Approximate Expectation Maximization</title>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Heskes</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">O</forename><surname>Zoeter</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Wiegerinck</surname></persName>
		</author>
		<ptr target="https://proceedings.neurips.cc/paper_files/paper/2003/hash/8208974663db80265e9bfe7b222dcb18-Abstract.html" />
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems</title>
				<imprint>
			<publisher>MIT Press</publisher>
			<date type="published" when="2003">2003</date>
			<biblScope unit="volume">16</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,253.90,468.00,8.82;26,81.65,264.81,239.32,8.82" xml:id="b65">
	<analytic>
		<title level="a" type="main">A linear-time algorithm for Gaussian and non-Gaussian trait evolution models</title>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">S T</forename><surname>Ho</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syu005</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="397" to="408" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,281.07,468.00,8.64;26,81.96,291.80,413.85,8.82" xml:id="b66">
	<analytic>
		<title level="a" type="main">Probabilistic graphical model representation in phylogenetics</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Höhna</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">A</forename><surname>Heath</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Boussau</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">J</forename><surname>Landis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Ronquist</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">P</forename><surname>Huelsenbeck</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syu039</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic biology</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="753" to="771" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,308.06,469.74,8.64;26,81.96,318.97,459.78,8.64;26,81.71,329.70,285.53,8.82" xml:id="b67">
	<analytic>
		<title level="a" type="main">Revbayes: Bayesian phylogenetic inference using graphical models and an interactive model-specification language</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Höhna</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">J</forename><surname>Landis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">A</forename><surname>Heath</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Boussau</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Lartillot</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">R</forename><surname>Moore</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">P</forename><surname>Huelsenbeck</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Ronquist</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syw021</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic biology</title>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="726" to="736" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,345.79,469.25,8.82;26,81.96,356.87,321.32,8.64" xml:id="b68">
	<analytic>
		<title level="a" type="main">Computing galled networks from real data</title>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">H</forename><surname>Huson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Rupp</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Berry</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Gambette</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Paul</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btp217</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<idno type="ISSN">1367-4803</idno>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="85" to="93" />
			<date type="published" when="2009-05">05 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,372.78,468.00,8.82;26,81.96,383.87,286.89,8.64" xml:id="b69">
	<monogr>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">H</forename><surname>Huson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Rupp</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Scornavacca</surname></persName>
		</author>
		<idno type="DOI">10.1017/CBO9780511974076</idno>
		<title level="m">Phylogenetic Networks: Concepts, Algorithms and Applications</title>
				<meeting><address><addrLine>Cambridge</addrLine></address></meeting>
		<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,399.95,468.00,8.64;26,81.96,410.68,416.41,8.82" xml:id="b70">
	<analytic>
		<title level="a" type="main">Ongoing recombination in SARS-CoV-2 revealed through genealogical reconstruction</title>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Ignatieva</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Hein</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><forename type="middle">A</forename><surname>Jenkins</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msac028</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">28</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,426.94,469.74,8.64;26,81.63,437.67,248.45,8.82" xml:id="b71">
	<analytic>
		<title level="a" type="main">The global diversity of birds in space and time</title>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Jetz</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><forename type="middle">H</forename><surname>Thomas</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">B</forename><surname>Joy</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Hartmann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">O</forename><surname>Mooers</surname></persName>
		</author>
		<idno type="DOI">10.1038/nature11631</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">491</biblScope>
			<biblScope unit="issue">7424</biblScope>
			<biblScope unit="page" from="444" to="448" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,453.76,462.28,8.82;26,72.00,469.84,469.38,8.82;26,81.22,480.93,246.61,8.64" xml:id="b72">
	<analytic>
		<title level="a" type="main">On the matrix condition of phylogenetic tree</title>
		<author>
			<persName coords=""><forename type="first">D.-C</forename><surname>Jhwueng</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">C</forename><surname>O'meara</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">; D.-C</forename><surname>Jhwueng</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">C</forename><surname>O'meara</surname></persName>
		</author>
		<idno type="DOI">10.1101/023986</idno>
		<idno>doi: 10.1177/1176934320901721</idno>
	</analytic>
	<monogr>
		<title level="j">Evolutionary Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page">1176934320901721</biblScope>
			<date type="published" when="2015">2015. 2020</date>
		</imprint>
	</monogr>
	<note>bioRxiv</note>
</biblStruct>

<biblStruct coords="26,72.00,497.01,468.36,8.64;26,81.96,507.74,458.54,8.82;26,81.63,518.83,239.99,8.64" xml:id="b73">
	<analytic>
		<title level="a" type="main">Gradients do grow on trees: A linear-time o(n)-dimensional gradient for statistical phylogenetics</title>
		<author>
			<persName coords=""><forename type="first">X</forename><surname>Ji</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Holbrook</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Nishimura</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Baele</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Rambaut</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msaa130</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="3047" to="3060" />
			<date type="published" when="2020-05">May 2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,534.91,469.65,8.64;26,81.96,545.64,459.78,8.82" xml:id="b74">
	<analytic>
		<title level="a" type="main">Exploring the distribution of phylogenetic networks generated under a birth-deathhybridization process</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Justison</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">A</forename><surname>Heath</surname></persName>
		</author>
		<idno type="DOI">10.18061/bssb.v2i3.9285</idno>
	</analytic>
	<monogr>
		<title level="j">Bulletin of the Society of Systematic Biologists</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1" to="22" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,561.91,469.74,8.64;26,81.54,572.64,372.91,8.82" xml:id="b75">
	<analytic>
		<title level="a" type="main">Siphynetwork: An R package for simulating phylogenetic networks</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Justison</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Solis-Lemus</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">A</forename><surname>Heath</surname></persName>
		</author>
		<idno type="DOI">10.1111/2041-210X.14116</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="1687" to="1698" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,588.90,468.00,8.64;26,81.96,599.63,459.78,8.82;26,81.22,610.72,37.36,8.64" xml:id="b76">
	<analytic>
		<title level="a" type="main">Efficient computation of the joint sample frequency spectra for multiple populations</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Kamm</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Terhorst</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><forename type="middle">S</forename><surname>Song</surname></persName>
		</author>
		<idno type="DOI">10.1080/10618600.2016.1159212</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Computational and Graphical Statistics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="182" to="194" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,75.15,626.80,464.85,8.64;26,81.60,637.53,458.95,8.82;26,81.96,648.62,102.12,8.64" xml:id="b77">
	<analytic>
		<title level="a" type="main">Efficiently inferring the demographic history of many populations with allele count data</title>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Kamm</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Terhorst</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Durbin</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><forename type="middle">S</forename><surname>Song</surname></persName>
		</author>
		<idno type="DOI">10.1080/01621459.2019.1635482</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">115</biblScope>
			<biblScope unit="issue">531</biblScope>
			<biblScope unit="page" from="1472" to="1487" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,664.70,468.00,8.64;26,81.96,675.43,458.04,8.82;26,81.65,686.34,238.76,8.82" xml:id="b78">
	<analytic>
		<title level="a" type="main">Reticulate evolution helps explain apparent homoplasy in floral biology and pollination in baobabs (Adansonia; Bombacoideae; Malvaceae)</title>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Karimi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">E</forename><surname>Grover</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">P</forename><surname>Gallagher</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">F</forename><surname>Wendel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">A</forename><surname>Baum</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syz073</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="462" to="478" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="26,72.00,702.43,469.39,8.82;26,81.22,713.51,72.51,8.64" xml:id="b79">
	<analytic>
		<title level="a" type="main">On the genealogy of large populations</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">F C</forename><surname>Kingman</surname></persName>
		</author>
		<idno type="DOI">10.2307/3213548</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Applied Probability</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="27" to="43" />
			<date type="published" when="1982">1982</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,75.30,468.00,8.82;27,81.68,86.21,460.06,8.59;27,81.71,97.12,436.31,8.82" xml:id="b80">
	<analytic>
		<title level="a" type="main">Message scheduling methods for belief propagation</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Knoll</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Rath</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Tschiatschek</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Pernkopf</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-3-319-23525-7\18</idno>
	</analytic>
	<monogr>
		<title level="m">Machine Learning and Knowledge Discovery in Databases: European Conference, ECML PKDD 2015</title>
				<meeting><address><addrLine>Porto, Portugal</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2015">September 7-11, 2015. 2015</date>
			<biblScope unit="page" from="295" to="310" />
		</imprint>
	</monogr>
	<note>Proceedings, Part II 15</note>
</biblStruct>

<biblStruct coords="27,72.00,113.20,468.00,8.82;27,81.96,124.29,67.25,8.64" xml:id="b81">
	<monogr>
		<title level="m" type="main">Probabilistic graphical models: principles and techniques</title>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Koller</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Friedman</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>MIT Press</publisher>
		</imprint>
	</monogr>
	<note>ISBN 9780262013192</note>
</biblStruct>

<biblStruct coords="27,72.00,140.37,468.00,8.64;27,81.96,151.10,241.24,8.82" xml:id="b82">
	<analytic>
		<title level="a" type="main">Inference of phylogenetic networks from sequence data using composite likelihood</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Kong</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">L</forename><surname>Swofford</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">S</forename><surname>Kubatko</surname></persName>
		</author>
		<idno type="DOI">10.1101/2022.11.14.516468</idno>
	</analytic>
	<monogr>
		<title level="j">bioRxiv</title>
		<imprint>
			<biblScope unit="page">2022</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,167.19,469.39,8.82;27,81.61,178.27,281.75,8.64" xml:id="b83">
	<analytic>
		<title level="a" type="main">A phylogenetic Kalman filter for ancestral trait reconstruction using molecular data</title>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Lartillot</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btt707</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<idno type="ISSN">1367-4803</idno>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="488" to="496" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,194.36,469.25,8.64;27,81.96,205.09,459.28,8.82;27,81.96,216.18,216.16,8.64" xml:id="b84">
	<analytic>
		<title level="a" type="main">Ancient human genomes suggest three ancestral populations for present-day europeans</title>
		<author>
			<persName coords=""><forename type="first">I</forename><surname>Lazaridis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Patterson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Mittnik</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Renaud</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Mallick</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Kirsanow</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><forename type="middle">H</forename><surname>Sudmant</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">G</forename><surname>Schraiber</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Castellano</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Lipson</surname></persName>
		</author>
		<idno type="DOI">10.1038/nature13673</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">513</biblScope>
			<biblScope unit="issue">7518</biblScope>
			<biblScope unit="page" from="409" to="413" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,232.26,469.74,8.64;27,81.65,242.99,314.14,8.82" xml:id="b85">
	<analytic>
		<title level="a" type="main">admixturegraph: an r package for admixture graph manipulation and fitting</title>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Leppälä</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><forename type="middle">V</forename><surname>Nielsen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Mailund</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btx048</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1738" to="1740" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,259.25,469.25,8.64;27,81.60,269.98,459.78,8.82;27,81.96,281.07,207.14,8.64" xml:id="b86">
	<analytic>
		<title level="a" type="main">The origins and spread of domestic horses from the western eurasian steppes</title>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Librado</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Khan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Fages</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Kusliy</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Suchan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Tonasso-Calvière</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Schiavinato</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Alioglu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Fromentier</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Perdereau</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41586-021-04018-9</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">598</biblScope>
			<biblScope unit="issue">7882</biblScope>
			<biblScope unit="page" from="634" to="640" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,296.97,469.39,8.82;27,81.22,308.06,203.11,8.64" xml:id="b87">
	<analytic>
		<title level="a" type="main">Applying f4-statistics and admixture graphs: Theory and examples</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Lipson</surname></persName>
		</author>
		<idno type="DOI">10.1111/1755-0998.13230</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Ecology Resources</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="1658" to="1667" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,324.15,469.24,8.64;27,81.77,334.88,459.61,8.82;27,81.96,345.96,202.16,8.64" xml:id="b88">
	<analytic>
		<title level="a" type="main">Ancient west african foragers in the context of african population history</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Lipson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">I</forename><surname>Ribot</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Mallick</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Rohland</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">I</forename><surname>Olalde</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Adamski</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Broomandkhoshbacht</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">M</forename><surname>Lawson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>López</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Oppenheimer</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41586-020-1929-1</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">577</biblScope>
			<biblScope unit="issue">7792</biblScope>
			<biblScope unit="page" from="665" to="670" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,362.05,468.00,8.64;27,81.96,372.78,458.60,8.82;27,81.96,383.87,34.03,8.64" xml:id="b89">
	<analytic>
		<title level="a" type="main">NetRAX: accurate and fast maximum likelihood phylogenetic network inference</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Lutteropp</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Scornavacca</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">M</forename><surname>Kozlov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Morel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Stamatakis</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btac396</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="issue">15</biblScope>
			<biblScope unit="page" from="3725" to="3733" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,399.77,469.24,8.82;27,81.22,410.86,240.80,8.64" xml:id="b90">
	<analytic>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">R</forename><surname>Magnus</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Neudecker</surname></persName>
		</author>
		<idno type="DOI">10.1017/S0266466600011476</idno>
	</analytic>
	<monogr>
		<title level="m">Symmetry, 0-1 matrices and Jacobians: A review</title>
				<imprint>
			<date type="published" when="1986">1986</date>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="157" to="190" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,426.94,468.00,8.64;27,81.96,437.67,341.52,8.82" xml:id="b91">
	<monogr>
		<title level="m" type="main">On the limits of fitting complex models of population history to f-statistics</title>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Maier</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Flegontov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">O</forename><surname>Flegontova</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">U</forename><surname>Isildak</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Changmai</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Reich</surname></persName>
		</author>
		<idno type="DOI">10.7554/elife.85492</idno>
		<imprint>
			<publisher>Elife</publisher>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">2023</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,453.94,469.74,8.64;27,81.41,464.67,258.65,8.82" xml:id="b92">
	<analytic>
		<title level="a" type="main">Walk-sums and belief propagation in gaussian graphical models</title>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">M</forename><surname>Malioutov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">K</forename><surname>Johnson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">S</forename><surname>Willsky</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="2031" to="2064" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,480.93,468.00,8.64;27,81.96,491.66,397.84,8.82" xml:id="b93">
	<analytic>
		<title level="a" type="main">A unifying comparative phylogenetic framework including traits coevolving across interacting lineages</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Manceau</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Lambert</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Morlon</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syw115</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="551" to="568" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,507.74,468.00,8.82;27,81.65,518.65,211.49,8.82" xml:id="b94">
	<analytic>
		<title level="a" type="main">Join-graph propagation algorithms</title>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Mateescu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Kask</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Gogate</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Dechter</surname></persName>
		</author>
		<idno type="DOI">10.1613/jair.2842</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Artificial Intelligence Research</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="279" to="328" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,534.91,468.00,8.64;27,81.96,545.64,458.04,8.82;27,81.96,556.73,176.04,8.64" xml:id="b95">
	<analytic>
		<title level="a" type="main">Automatic generation of evolutionary hypotheses using mixed Gaussian phylogenetic models</title>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Mitov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Bartoszek</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Stadler</surname></persName>
		</author>
		<idno type="DOI">10.1073/pnas.1813823116</idno>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the National Academy of Sciences</title>
				<meeting>the National Academy of Sciences</meeting>
		<imprint>
			<date type="published" when="2019">201813823. Aug. 2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,572.82,468.00,8.64;27,81.96,583.55,408.78,8.82" xml:id="b96">
	<analytic>
		<title level="a" type="main">Fast likelihood calculation for multivariate Gaussian phylogenetic models with shifts</title>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Mitov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Bartoszek</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Asimomitis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Stadler</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.tpb.2019.11.005</idno>
	</analytic>
	<monogr>
		<title level="j">Theoretical Population Biology</title>
		<imprint>
			<biblScope unit="volume">131</biblScope>
			<biblScope unit="page" from="66" to="78" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,599.81,468.00,8.64;27,81.96,610.54,444.63,8.82" xml:id="b97">
	<analytic>
		<title level="a" type="main">Advancing admixture graph estimation via maximum likelihood network orientation</title>
		<author>
			<persName coords=""><forename type="first">E</forename><forename type="middle">K</forename><surname>Molloy</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Durvasula</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Sankararaman</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btab267</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">Supplement 1</biblScope>
			<biblScope unit="page" from="142" to="150" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,626.80,469.75,8.64;27,81.63,637.53,316.63,8.82" xml:id="b98">
	<analytic>
		<title level="a" type="main">A bayesian approach to infer recombination patterns in coronaviruses</title>
		<author>
			<persName coords=""><forename type="first">N</forename><forename type="middle">F</forename><surname>Müller</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><forename type="middle">E</forename><surname>Kistler</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Bedford</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41467-022-31749-8</idno>
	</analytic>
	<monogr>
		<title level="j">Nature communications</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">4186</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,653.79,468.00,8.64;27,81.96,664.52,458.04,8.82;27,81.63,675.43,267.47,8.82" xml:id="b99">
	<analytic>
		<title level="a" type="main">Detecting contact in language trees: a Bayesian phylogenetic model with horizontal transfer</title>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Neureiter</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Ranacher</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Efrat-Kowalsky</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><forename type="middle">A</forename><surname>Kaiping</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Weibel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Widmer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">R</forename><surname>Bouckaert</surname></persName>
		</author>
		<idno type="DOI">10.1057/s41599-022-01211-7</idno>
	</analytic>
	<monogr>
		<title level="j">Humanities and Social Sciences Communications</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">2022</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="27,72.00,691.70,468.00,8.64;27,81.96,702.43,459.42,8.82;27,81.22,713.51,101.60,8.64" xml:id="b100">
	<analytic>
		<title level="a" type="main">IQ-TREE: A fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</title>
		<author>
			<persName coords=""><forename type="first">L.-T</forename><surname>Nguyen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><forename type="middle">A</forename><surname>Schmidt</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Von</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><forename type="middle">Q</forename><surname>Haeseler</surname></persName>
		</author>
		<author>
			<persName coords=""><surname>Minh</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msu300</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="268" to="274" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,75.48,468.00,8.64;28,81.96,86.21,459.78,8.82;28,81.22,97.30,37.36,8.64" xml:id="b101">
	<analytic>
		<title level="a" type="main">Bayesian inference of admixture graphs on native american and arctic populations</title>
		<author>
			<persName coords=""><forename type="first">S</forename><forename type="middle">V</forename><surname>Nielsen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">H</forename><surname>Vaughn</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Leppälä</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">J</forename><surname>Landis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Mailund</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Nielsen</surname></persName>
		</author>
		<idno type="DOI">10.1371/journal.pgen.1010410</idno>
	</analytic>
	<monogr>
		<title level="j">PLOS Genetics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="1" to="22" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,112.04,468.00,8.64;28,81.96,122.77,453.35,8.82" xml:id="b102">
	<analytic>
		<title level="a" type="main">TriLoNet: Piecing together small networks to reconstruct reticulate evolutionary histories</title>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Oldman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Van Iersel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Moulton</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msw068</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="2151" to="2162" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,137.51,468.00,8.82;28,81.65,148.42,266.99,8.82" xml:id="b103">
	<analytic>
		<title level="a" type="main">Bayesian estimation of ancestral character states on phylogenies</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Pagel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Meade</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Barker</surname></persName>
		</author>
		<idno type="DOI">10.1080/10635150490522232</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="673" to="684" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,163.34,468.00,8.64;28,81.96,174.07,399.52,8.82" xml:id="b104">
	<analytic>
		<title level="a" type="main">Ancient admixture in human history</title>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Patterson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Moorjani</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Luo</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Mallick</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Rohland</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Zhan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Genschoreck</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Webster</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Reich</surname></persName>
		</author>
		<idno type="DOI">10.1534/genetics.112.145037</idno>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">192</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1065" to="1093" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,188.99,469.74,8.64;28,81.65,199.72,285.06,8.82" xml:id="b105">
	<analytic>
		<title level="a" type="main">Inference of population splits and mixtures from genome-wide allele frequency data</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">K</forename><surname>Pickrell</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">K</forename><surname>Pritchard</surname></persName>
		</author>
		<idno type="DOI">10.1371/journal.pgen.1002967</idno>
	</analytic>
	<monogr>
		<title level="j">PLOS Genetics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1" to="17" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,214.64,469.74,8.64;28,81.96,225.54,458.04,8.64;28,81.96,236.27,459.78,8.82;28,81.96,247.36,126.79,8.64" xml:id="b106">
	<analytic>
		<title level="a" type="main">Unifying the spatial epidemiology and molecular evolution of emerging epidemics</title>
		<author>
			<persName coords=""><forename type="first">O</forename><forename type="middle">G</forename><surname>Pybus</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><forename type="middle">J</forename><surname>Bernardin</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Rambaut</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><forename type="middle">W</forename><surname>Crawford</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">R</forename><surname>Gray</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Arinaminpathy</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><forename type="middle">L</forename><surname>Stramer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">P</forename><surname>Busch</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">E</forename><forename type="middle">L</forename><surname>Delwart</surname></persName>
		</author>
		<idno type="DOI">10.1073/pnas.1206598109</idno>
	</analytic>
	<monogr>
		<title level="j">Proceedings of the National Academy of Sciences</title>
		<idno type="ISSN">0027-8424</idno>
		<imprint>
			<biblScope unit="volume">109</biblScope>
			<biblScope unit="issue">37</biblScope>
			<biblScope unit="page" from="15066" to="15071" />
			<date type="published" when="2012-09">Sept. 2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,262.10,468.00,8.64;28,81.96,272.83,459.42,8.82;28,81.22,283.92,192.37,8.64" xml:id="b107">
	<analytic>
		<title level="a" type="main">On the inference of complex phylogenetic networks by Markov Chain Monte-Carlo</title>
		<author>
			<persName coords=""><forename type="first">C.-E</forename><surname>Rabier</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Berry</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Stoltz</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">D</forename><surname>Santos</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J.-C</forename><surname>Glaszmann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Pardi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Scornavacca</surname></persName>
		</author>
		<idno type="DOI">10.1371/journal.pcbi.1008380</idno>
	</analytic>
	<monogr>
		<title level="j">PLOS Computational Biology</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="1" to="39" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,298.48,469.39,8.82;28,81.22,309.57,214.50,8.64" xml:id="b108">
	<analytic>
		<title level="a" type="main">Detecting polygenic adaptation in admixture graphs</title>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Racimo</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">J</forename><surname>Berg</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">K</forename><surname>Pickrell</surname></persName>
		</author>
		<idno type="DOI">10.1534/genetics.117.300489</idno>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">208</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1565" to="1584" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,324.31,469.24,8.64;28,81.65,335.04,458.34,8.82;28,81.65,345.95,460.96,8.88;28,81.44,357.44,232.63,8.30" xml:id="b109">
	<analytic>
		<title level="a" type="main">Black Box Variational Inference</title>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Ranganath</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Gerrish</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Blei</surname></persName>
		</author>
		<ptr target="https://proceedings.mlr.press/v33/ranganath14.html" />
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Seventeenth International Conference on Artificial Intelligence and Statistics</title>
				<editor>
			<persName><forename type="first">S</forename><surname>Kaski</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">J</forename><surname>Corander</surname></persName>
		</editor>
		<meeting>the Seventeenth International Conference on Artificial Intelligence and Statistics<address><addrLine>Reykjavik, Iceland</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2014-04">Apr. 2014</date>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="814" to="822" />
		</imprint>
	</monogr>
	<note>of Proceedings of Machine Learning Research</note>
</biblStruct>

<biblStruct coords="28,72.00,371.78,468.36,8.64;28,81.96,382.51,402.92,8.82" xml:id="b110">
	<analytic>
		<title level="a" type="main">Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</title>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Rannala</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Yang</surname></persName>
		</author>
		<idno type="DOI">10.1093/genetics/164.4.1645</idno>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">164</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1645" to="1656" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,396.47,468.00,10.81;28,81.96,409.37,459.42,8.82;28,81.22,420.46,95.20,8.64" xml:id="b111">
	<analytic>
		<title level="a" type="main">Identifying loci under positive selection in complex population histories</title>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Refoyo-Martínez</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">R</forename><surname>Da Fonseca</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Halldórsdóttir</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">E</forename><surname>Árnason</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Mailund</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Racimo</surname></persName>
		</author>
		<idno type="DOI">10.1101/gr.246777.118</idno>
	</analytic>
	<monogr>
		<title level="j">Genome Research</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="1506" to="1520" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,435.02,468.00,8.82;28,81.65,445.93,293.60,8.82" xml:id="b112">
	<analytic>
		<title level="a" type="main">phytools: An R package for phylogenetic comparative biology (and other things)</title>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">J</forename><surname>Revell</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2041-210X.2011.00169.x</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="217" to="223" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,460.67,469.74,8.82;28,81.96,471.76,132.81,8.64" xml:id="b113">
	<monogr>
		<title level="m" type="main">Identifying circular orders for blobs in phylogenetic networks</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Rhodes</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Baños</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.2402.11693</idno>
		<imprint>
			<biblScope unit="page">2024</biblScope>
		</imprint>
	</monogr>
	<note type="report_type">arXiv</note>
</biblStruct>

<biblStruct coords="28,72.00,486.32,469.38,8.82;28,81.22,497.41,220.60,8.64" xml:id="b114">
	<analytic>
		<title level="a" type="main">MrBayes 3: Bayesian phylogenetic inference under mixed models</title>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Ronquist</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Huelsenbeck</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btg180</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="1572" to="1574" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,512.15,468.00,8.64;28,81.60,522.88,427.87,8.82" xml:id="b115">
	<analytic>
		<title level="a" type="main">A graph-theoretic study of the numerical solution of sparse positive definite systems of linear equations</title>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">J</forename><surname>Rose</surname></persName>
		</author>
		<idno type="DOI">10.1016/B978-1-4832-3187-7.50018-0</idno>
	</analytic>
	<monogr>
		<title level="m">Graph theory and computing</title>
				<imprint>
			<publisher>Elsevier</publisher>
			<date type="published" when="1972">1972</date>
			<biblScope unit="page" from="183" to="217" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,537.80,467.99,8.64;28,81.65,548.53,415.76,8.82" xml:id="b116">
	<analytic>
		<title level="a" type="main">Optimization with EM and Expectation-Conjugate-Gradient</title>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Salakhutdinov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Roweis</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Ghahramani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 20th International Conference on Machine Learning (ICML-03)</title>
				<meeting>the 20th International Conference on Machine Learning (ICML-03)</meeting>
		<imprint>
			<publisher>AAAI Press</publisher>
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,563.45,469.74,8.64;28,81.79,574.18,409.19,8.82" xml:id="b117">
	<analytic>
		<title level="a" type="main">Degenerate gaussian factors for probabilistic inference</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">C</forename><surname>Schoeman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">E</forename><surname>Van Daalen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Du Preez</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.ijar.2022.01.008</idno>
	</analytic>
	<monogr>
		<title level="j">International Journal of Approximate Reasoning</title>
		<imprint>
			<biblScope unit="volume">143</biblScope>
			<biblScope unit="page" from="159" to="191" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,588.92,468.00,8.82;28,81.96,599.83,291.17,8.82" xml:id="b118">
	<analytic>
		<title level="a" type="main">Treewidth-based algorithms for the small parsimony problem on networks</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Scornavacca</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Weller</surname></persName>
		</author>
		<idno type="DOI">10.1186/s13015-022-00216-w</idno>
	</analytic>
	<monogr>
		<title level="j">Algorithms for Molecular Biology</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page">2022</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,614.57,468.00,8.82;28,81.54,625.48,318.56,8.82" xml:id="b119">
	<analytic>
		<title level="a" type="main">When is a phylogenetic network simply an amalgamation of two trees?</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Semple</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Simpson</surname></persName>
		</author>
		<idno type="DOI">10.1007/s11538-018-0463-x</idno>
	</analytic>
	<monogr>
		<title level="j">Bulletin of Mathematical Biology</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page" from="2338" to="2348" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,640.22,469.24,8.82;28,81.71,651.31,159.71,8.64" xml:id="b120">
	<analytic>
		<title level="a" type="main">Cross-species analysis of single-cell transcriptomic data</title>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">E R</forename><surname>Shafer</surname></persName>
		</author>
		<idno type="DOI">10.3389/fcell.2019.00175</idno>
	</analytic>
	<monogr>
		<title level="j">Frontiers in Cell and Developmental Biology</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">2019</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,666.05,469.24,8.64;28,81.96,676.78,458.04,8.82;28,81.63,687.86,230.93,8.64" xml:id="b121">
	<analytic>
		<title level="a" type="main">The population history of northeastern siberia since the pleistocene</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Sikora</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><forename type="middle">V</forename><surname>Pitulko</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><forename type="middle">C</forename><surname>Sousa</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">E</forename><surname>Allentoft</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Vinner</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Rasmussen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Margaryan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>De Barros Damgaard</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>De La Fuente</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Renaud</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41586-019-1279-z</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">570</biblScope>
			<biblScope unit="issue">7760</biblScope>
			<biblScope unit="page" from="182" to="188" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="28,72.00,702.61,467.99,8.64;28,81.96,713.34,367.23,8.82" xml:id="b122">
	<analytic>
		<title level="a" type="main">Inferring phylogenetic networks with maximum pseudolikelihood under incomplete lineage sorting</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Solís-Lemus</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.1371/journal.pgen.1005896</idno>
	</analytic>
	<monogr>
		<title level="j">PLoS Genetics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">e1005896</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,75.30,468.00,8.82;29,81.65,86.21,269.06,8.82" xml:id="b123">
	<analytic>
		<title level="a" type="main">PhyloNetworks: A package for phylogenetic networks</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Solís-Lemus</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Bastide</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msx235</idno>
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="3292" to="3298" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,101.75,469.24,8.82;29,81.22,112.83,199.73,8.64" xml:id="b124">
	<analytic>
		<title level="a" type="main">General theory for stochastic admixture graphs and f-statistics</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Soraggi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Wiuf</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.tpb.2018.12.002</idno>
	</analytic>
	<monogr>
		<title level="j">Theoretical Population Biology</title>
		<imprint>
			<biblScope unit="volume">125</biblScope>
			<biblScope unit="page" from="56" to="66" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,128.19,469.65,8.82;29,81.96,139.10,261.00,8.82" xml:id="b125">
	<analytic>
		<title level="a" type="main">RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</title>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Stamatakis</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btu033</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="1312" to="1313" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,154.82,467.99,8.64;29,81.96,165.55,361.36,8.82" xml:id="b126">
	<analytic>
		<title level="a" type="main">Bayesian inference of species trees using diffusion models</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Stoltz</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Baeumer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Bouckaert</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Fox</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Hiscott</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Bryant</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syaa051</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<imprint>
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="145" to="161" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,181.09,469.74,8.82;29,81.96,192.18,187.05,8.70" xml:id="b127">
	<monogr>
		<title level="m" type="main">Computing tree decompositions with flowcutter: PACE 2017 submission</title>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Strasser</surname></persName>
		</author>
		<idno>CoRR, abs/1709.08949</idno>
		<ptr target="http://arxiv.org/abs/1709.08949" />
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,207.53,467.99,8.82;29,81.54,218.44,460.19,8.82;29,81.96,229.53,37.36,8.64;29,72.00,245.07,469.74,8.64;29,81.60,255.80,459.64,8.82;29,81.96,266.89,167.29,8.64" xml:id="b128">
	<analytic>
		<title level="a" type="main">Ancient dna reveals genetic admixture in china during tiger evolution</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Streicher</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Du Preez</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">;</forename><forename type="middle">X</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y.-C</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">P</forename><surname>Tiunov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">O</forename><surname>Gimranov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Zhuang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Han</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">A</forename><surname>Driscoll</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Pang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Pan</surname></persName>
		</author>
		<idno type="DOI">10.1145/3132711.3132717</idno>
		<idno>doi: 10.1038/s41559-023-02185-8</idno>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the ACM Multimedia 2017 Workshop on South African Academic Participation</title>
				<meeting>the ACM Multimedia 2017 Workshop on South African Academic Participation</meeting>
		<imprint>
			<date type="published" when="2017">2017. 2023</date>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="1914" to="1929" />
		</imprint>
	</monogr>
	<note>Graph coloring: Comparing cluster graphs to factor graphs</note>
</biblStruct>

<biblStruct coords="29,72.00,282.25,468.00,8.82;29,81.63,293.16,375.30,8.82" xml:id="b129">
	<analytic>
		<title level="a" type="main">Improved dynamic schedules for belief propagation</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Sutton</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Mccallum</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Twenty-Third Conference on Uncertainty in Artificial Intelligence</title>
				<meeting>the Twenty-Third Conference on Uncertainty in Artificial Intelligence</meeting>
		<imprint>
			<date type="published" when="2007">2007</date>
			<biblScope unit="page" from="376" to="383" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,308.87,468.00,8.64;29,81.96,319.60,459.78,8.82;29,81.96,330.69,187.05,8.70" xml:id="b130">
	<monogr>
		<title level="m" type="main">TreeFlow: probabilistic programming and automatic differentiation for phylogenetics</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Swanepoel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Fourment</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">X</forename><surname>Ji</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Nasif</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><forename type="middle">A</forename><surname>Matsen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">I</forename><forename type="middle">V</forename></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Drummond</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.2211.05220</idno>
		<ptr target="http://arxiv.org/abs/2211.05220" />
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv e-print</note>
</biblStruct>

<biblStruct coords="29,72.00,346.05,468.00,8.82;29,81.65,356.96,322.25,8.82" xml:id="b131">
	<analytic>
		<title level="a" type="main">Line-of-descent and genealogical processes, and their applications in population genetics models</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Tavaré</surname></persName>
		</author>
		<idno type="DOI">10.1016/0040-5809(84)90027-3</idno>
	</analytic>
	<monogr>
		<title level="j">Theoretical Population Biology</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="119" to="164" />
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,372.68,468.00,8.64;29,81.96,383.41,459.78,8.82" xml:id="b132">
	<analytic>
		<title level="a" type="main">Accounting for within-species variation in continuous trait evolution on a phylogenetic network</title>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Teo</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">P</forename><surname>Rose</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Bastide</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.18061/bssb.v2i3.8977</idno>
	</analytic>
	<monogr>
		<title level="j">Bulletin of the Society of Systematic Biologists</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1" to="29" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,399.12,468.00,8.64;29,81.96,409.86,459.29,8.82;29,81.96,420.94,121.40,8.64" xml:id="b133">
	<analytic>
		<title level="a" type="main">A fast and simple R package for phylogenetic inference and trait imputation using phylogenetic structural equation models</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">T</forename><surname>Thorson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Van Der Bijl</surname></persName>
		</author>
		<idno type="DOI">10.1111/jeb.14234</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Evolutionary Biology</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="1357" to="1364" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,436.48,469.25,8.64;29,81.96,447.39,458.04,8.64;29,81.96,458.12,459.78,8.82;29,81.96,469.21,129.50,8.64" xml:id="b134">
	<analytic>
		<title level="a" type="main">Identifying direct and indirect associations among traits by merging phylogenetic comparative methods and structural equation models</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">T</forename><surname>Thorson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">A</forename><surname>Maureaud</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Frelat</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Mérigot</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">S</forename><surname>Bigman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><forename type="middle">T</forename><surname>Friedman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">L D</forename><surname>Palomares</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">L</forename><surname>Pinsky</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><forename type="middle">A</forename><surname>Price</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Wainwright</surname></persName>
		</author>
		<idno type="DOI">10.1111/2041-210X.14076</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="1259" to="1275" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,484.57,469.24,8.82;29,81.96,495.66,298.91,8.64" xml:id="b135">
	<analytic>
		<title level="a" type="main">Phylogenetic Factor Analysis</title>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">R</forename><surname>Tolkoff</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">E</forename><surname>Alfaro</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Baele</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/syx066</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="384" to="399" />
			<date type="published" when="2018-08">Aug. 2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,511.19,468.00,8.64;29,81.96,521.92,446.32,8.82" xml:id="b136">
	<analytic>
		<title level="a" type="main">Inferring the mammal tree: Species-level sets of phylogenies for questions in ecology, evolution, and conservation</title>
		<author>
			<persName coords=""><forename type="first">N</forename><forename type="middle">S</forename><surname>Upham</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">A</forename><surname>Esselstyn</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Jetz</surname></persName>
		</author>
		<idno type="DOI">10.1371/journal.pbio.3000494</idno>
	</analytic>
	<monogr>
		<title level="j">PLOS Biology</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="1" to="44" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,537.64,468.17,8.64;29,81.96,548.37,458.59,8.82;29,81.96,559.46,30.17,8.64" xml:id="b137">
	<analytic>
		<title level="a" type="main">Phylogenetic networks do not need to be complex: using fewer reticulations to represent conflicting clusters</title>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Van Iersel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Kelk</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Rupp</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Huson</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btq202</idno>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="124" to="131" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,575.00,468.00,8.64;29,81.96,585.73,459.42,8.82;29,81.22,596.82,107.19,8.64" xml:id="b138">
	<analytic>
		<title level="a" type="main">Tree-based reparameterization framework for analysis of sum-product and related algorithms</title>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">J</forename><surname>Wainwright</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><forename type="middle">S</forename><surname>Jaakkola</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">S</forename><surname>Willsky</surname></persName>
		</author>
		<idno type="DOI">10.1109/TIT.2003.810642</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on information theory</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="1120" to="1146" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,612.35,469.24,8.64;29,81.60,623.08,459.64,8.82;29,81.96,634.17,167.29,8.64" xml:id="b139">
	<analytic>
		<title level="a" type="main">Genomic insights into the formation of human populations in east asia</title>
		<author>
			<persName coords=""><forename type="first">C.-C</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H.-Y</forename><surname>Yeh</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">N</forename><surname>Popov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H.-Q</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Matsumura</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Sirak</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">O</forename><surname>Cheronet</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Kovalev</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Rohland</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">M</forename><surname>Kim</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41586-021-03336-2</idno>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">591</biblScope>
			<biblScope unit="issue">7850</biblScope>
			<biblScope unit="page" from="413" to="419" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,649.71,469.74,8.64;29,81.36,660.44,246.79,8.82" xml:id="b140">
	<monogr>
		<title level="m" type="main">Correctness of belief propagation in gaussian graphical models of arbitrary topology. Advances in neural information processing systems</title>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Weiss</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Freeman</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1999">1999</date>
			<biblScope unit="volume">12</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,675.98,468.00,8.82;29,81.96,686.89,310.53,8.82" xml:id="b141">
	<analytic>
		<title level="a" type="main">Identifiability of local and global features of phylogenetic networks from average distances</title>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
		<idno type="DOI">10.1007/s00285-022-01847-8</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Mathematical Biology</title>
		<imprint>
			<biblScope unit="volume">86</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">2023</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="29,72.00,702.61,468.00,8.64;29,81.96,713.34,444.97,8.82" xml:id="b142">
	<analytic>
		<title level="a" type="main">Constructing free-energy approximations and generalized belief propagation algorithms</title>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">S</forename><surname>Yedidia</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><forename type="middle">T</forename><surname>Freeman</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Weiss</surname></persName>
		</author>
		<idno type="DOI">10.1109/TIT.2005.850085</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on information theory</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="2282" to="2312" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="30,72.00,75.30,469.38,8.82;30,81.96,86.39,198.79,8.64" xml:id="b143">
	<analytic>
		<title level="a" type="main">A maximum pseudo-likelihood approach for phylogenetic networks</title>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Nakhleh</surname></persName>
		</author>
		<idno type="DOI">10.1186/1471-2164-16-S10-S10</idno>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page">S10</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="30,72.00,101.28,468.00,8.64;30,81.96,112.01,458.04,8.82;30,81.36,122.92,293.32,8.82" xml:id="b144">
	<analytic>
		<title level="a" type="main">Large-scale inference of correlation among mixed-type biological traits with phylogenetic multivariate probit models</title>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Nishimura</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Bastide</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">X</forename><surname>Ji</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">P</forename><surname>Payne</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Goulder</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1214/20-aoas1394</idno>
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Statistics</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="230" to="251" />
			<date type="published" when="2021-03">Mar. 2021</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
